{"version":3,"sources":["webpack:///./node_modules/@signalwire/js/dist/esm/common/src/util/constants/index.js","webpack:///./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack:///./node_modules/core-js/modules/es.regexp.to-string.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/util/storage/index.js","webpack:///./node_modules/loglevel/lib/loglevel.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/util/logger.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/util/helpers.js","webpack:///./node_modules/core-js/internals/regexp-get-flags.js","webpack:///./node_modules/regenerator-runtime/runtime.js","webpack:///./node_modules/@signalwire/js/node_modules/uuid/dist/esm-browser/rng.js","webpack:///./node_modules/@signalwire/js/node_modules/uuid/dist/esm-browser/bytesToUuid.js","webpack:///./node_modules/@signalwire/js/node_modules/uuid/dist/esm-browser/v4.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/services/Handler.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/services/Connection.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/messages/BaseMessage.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/messages/blade/Connect.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/messages/blade/Execute.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/messages/blade/Subscription.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/messages/blade/Reauthenticate.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/messages/blade/Ping.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/services/Setup.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/messages/verto/BaseRequest.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/messages/verto/Result.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/webrtc/constants.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/messages/Verto.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/util/webrtc/index.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/webrtc/helpers.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/webrtc/Peer.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/webrtc/LayoutHandler.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/webrtc/BaseCall.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/webrtc/Call.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/webrtc/VertoHandler.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/services/BroadcastHandler.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/BaseSession.js","webpack:///./node_modules/@signalwire/js/dist/esm/common/src/BrowserSession.js","webpack:///./node_modules/@signalwire/js/dist/esm/js/src/SignalWire.js","webpack:///./node_modules/@signalwire/js/dist/esm/js/index.js","webpack:///./node_modules/core-js/modules/es.array.join.js","webpack:///./node_modules/core-js/modules/es.array.includes.js"],"names":["STORAGE_PREFIX","ADD","REMOVE","SESSION_ID","SwEvent","BladeMethod","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","PROPER_FUNCTION_NAME","PROPER","redefine","anObject","$toString","fails","getRegExpFlags","TO_STRING","RegExpPrototype","RegExp","prototype","n$ToString","NOT_GENERIC","call","source","flags","INCORRECT_NAME","name","R","pattern","unsafe","__awaiter","thisArg","_arguments","P","generator","adopt","fulfilled","step","next","e","rejected","result","_inNode","window","process","_get","storageType","res","getItem","_set","JSON","stringify","setItem","_remove","removeItem","localStorage","sessionStorage","root","definition","define","amd","module","exports","log","noop","undefinedType","isIE","navigator","test","userAgent","logMethods","bindMethod","obj","methodName","method","bind","Function","traceForIE","console","trace","realMethod","replaceLoggingMethods","level","loggerName","i","length","methodFactory","debug","enableLoggingWhenConsoleArrives","defaultMethodFactory","Logger","defaultLevel","factory","currentLevel","storageKey","persistLevelIfPossible","levelNum","levelName","toUpperCase","ignore","document","cookie","encodeURIComponent","getPersistedLevel","storedLevel","location","indexOf","exec","slice","levels","clearPersistedLevel","getLevel","setLevel","persist","SILENT","setDefaultLevel","resetLevel","enableAll","TRACE","disableAll","initialLevel","defaultLogger","_loggersByName","getLogger","TypeError","logger","_log","noConflict","getLoggers","datetime","Date","toISOString","replace","originalFactory","logLevel","rawMethod","messages","push","objEmpty","Object","keys","mutateStorageKey","mutateLiveArrayData","data","participantId","participantNumber","participantName","codec","mediaJson","participantData","media","parse","warn","Number","safeParseJson","isDefined","variable","isFunction","findElementByType","tag","getElementById","HTMLMediaElement","PROTOCOL_PATTERN","checkWebSocketHost","host","protocol","destructResponse","response","nodeId","nestedResult","node_id","code","vertoResult","randomInt","min","max","Math","floor","random","hasOwn","isPrototypeOf","regExpFlags","runtime","Op","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","defineProperty","enumerable","configurable","writable","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","create","context","Context","_invoke","makeInvokeMethod","tryCatch","type","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","AsyncIterator","PromiseImpl","invoke","record","__await","unwrapped","previousPromise","enqueue","callInvokeWithMethodAndArg","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","displayName","isGeneratorFunction","genFun","ctor","constructor","mark","setPrototypeOf","__proto__","awrap","async","iter","object","reverse","pop","skipTempReset","prev","charAt","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","globalThis","getRandomValues","crypto","msCrypto","rnds8","Uint8Array","rng","byteToHex","toString","substr","bytesToUuid","buf","offset","bth","join","v4","options","Array","rnds","ii","GLOBAL","queue","isQueued","eventName","uniqueId","register","callback","registerOnce","cb","deRegister","targetRef","len","splice","trigger","globalPropagation","_propagate","deRegisterAll","WebSocketClass","WebSocket","WS_STATE","CONNECTING","OPEN","CLOSING","CLOSED","TIMEOUT_MS","session","_wsClient","_host","_timers","upDur","downDur","readyState","connecting","connected","closing","closed","onopen","event","SocketOpen","uuid","onclose","SocketClose","onerror","SocketError","onmessage","msg","_unsetTimer","id","SocketMessage","_handleStringResponse","request","send","bladeObj","promise","_setTimer","_beginClose","close","clearTimeout","setTimeout","timeoutErrorCode","message","parseInt","substring","SpeedTest","params","assign","jsonrpc","major","minor","revision","agent","setAgentName","authentication","sessionid","super","version","buildRequest","tmp","auto_create","downstream","project","jwt_token","SETUP_PROTOCOL","SETUP_METHOD","SETUP_CHANNEL","signature","relayProtocol","split","prevProtocol","be","execute","subscribe","channels","__rest","s","t","p","getOwnPropertySymbols","propertyIsEnumerable","tmpMap","destinationNumber","remoteCallerName","remoteCallerNumber","callerName","callerNumber","_a","dialogParams","remoteSdp","localStream","remoteStream","onNotification","camId","micId","speakerId","PeerType","Direction","VertoMethod","NOTIFICATION_TYPE","generic","Display","Attach","conferenceUpdate","callUpdate","vertoClientReady","userMediaError","refreshToken","DEFAULT_CALL_OPTIONS","audio","video","useStereo","attach","screenShare","userVariables","State","Role","ConferenceAction","DeviceType","Invite","Answer","Bye","Modify","Info","Broadcast","Subscribe","Unsubscribe","RTCPeerConnection","config","getUserMedia","constraints","mediaDevices","getDisplayMedia","enumerateDevices","getSupportedConstraints","streamIsValid","stream","MediaStream","attachMediaStream","element","getAttribute","setAttribute","srcObject","detachMediaStream","muteMediaElement","muted","setMediaElementSinkId","deviceId","setSinkId","sdpToJsonHack","sdp","stopStream","getTracks","_constraintsByKind","kind","AudioIn","Video","getDevices","fullList","devices","catch","filter","d","valid","every","label","found","groupId","includes","resolutionList","scanResolutions","supported","exact","videoTrack","getVideoTracks","width","height","success","applyConstraints","resolution","getMediaConstraints","micLabel","assureDeviceId","camLabel","deviceLabel","removeUnsupportedConstraints","map","checkDeviceIdConstraints","sdpStereoHack","endOfLine","sdpLines","opusIndex","findIndex","getCodecPayloadType","line","match","opusPayload","fmtpLineIndex","_isAudioLine","_isVideoLine","sdpMediaOrderHack","answer","localOffer","offerLines","offerAudioIndex","offerVideoIndex","answerLines","answerAudioIndex","answerVideoIndex","audioLines","videoLines","beginLines","checkSubscribeResponse","channel","subscribed","alreadySubscribed","destructSubscribeResponse","unauthorized","unsubscribed","notSubscribed","k","enableAudioTracks","_updateMediaStreamTracks","disableAudioTracks","toggleAudioTracks","enableVideoTracks","disableVideoTracks","toggleVideoTracks","enabled","tracks","getAudioTracks","track","sdpBitrateHack","start","lines","onSdpReadyTwice","_negotiating","_constraints","offerToReceiveAudio","offerToReceiveVideo","_sdpReady","_init","_isOffer","_createOffer","_createAnswer","instance","_config","onsignalingstatechange","signalingState","onnegotiationneeded","startNegotiation","_retrieveLocalStream","MediaError","localElement","addTrack","addStream","createOffer","_setLocalDescription","_isAnswer","sessionDescr","Offer","setRemoteDescription","createAnswer","sessionDescription","googleMaxBitrate","googleMinBitrate","googleStartBitrate","setLocalDescription","localDescription","iceServers","sdpSemantics","bundlePolicy","MCULayoutEventHandler","eventData","contentType","canvasType","callID","canvasInfo","currentLayerIdx","memberID","calls","_clearCanvasInfo","notification","action","LayerInfo","Notification","LayoutInfo","opts","New","prevState","role","Participant","extension","_state","_prevState","gotAnswer","gotEarly","_lastSerno","_targetNodeId","_iceTimeout","_iceDone","_checkConferenceSerno","serno","check","speaker","remoteElement","mediaConstraints","_onMediaError","what","direction","Outbound","peer","_registerPeerEvents","Inbound","cause","causeCode","setState","Hangup","_close","Destroy","bye","sessid","_execute","destination","replaceCallID","_handleChangeHoldStateSuccess","_handleChangeHoldStateError","dtmf","to","body","from","login","sender","getSenders","find","newStream","audioTrack","replaceTrack","toLowerCase","_dispatchNotification","Purge","hangup","Active","_finalize","Early","_onRemoteSdp","Media","display_name","display_number","displayNumber","display_direction","displayDirection","Event","packet","initialPvtData","wireSerno","laName","hashKey","callId","String","arrIndex","index","chatID","chatChannel","infoChannel","modChannel","conferenceMemberID","_dispatchConferenceUpdate","Join","conferenceName","_subscribeConferenceChat","_subscribeConferenceInfo","Moderator","_subscribeConferenceModerator","participants","Bootstrap","Add","Delete","Clear","_existsSubscription","subscriptions","handler","fromDisplay","messageText","messageType","ChatMessage","messageId","eventSerno","vertoSubscribe","_addChannel","defineProperties","sendChatMessage","vertoBroadcast","application","_modCommand","command","_confControl","_videoRequired","responseData","LayoutList","layouts","ModCmdResponse","listVideoLayouts","playMedia","file","stopMedia","deaf","undeaf","startRecord","stopRecord","snapshot","setVideoLayout","layout","canvasID","kick","muteMic","muteVideo","presenter","videoFloor","banner","text","encodeURI","volumeDown","volumeUp","gainDown","gainUp","transfer","exten","holdState","Held","_onIceSdp","_requestAnotherLocalDescription","tmpParams","Requesting","Answering","Trying","onicecandidate","candidate","addEventListener","streams","targetNodeId","_statsInterval","displayStream","invite","_stats","clearInterval","setInterval","stats","getStats","statsOutput","invalidReport","invalidStat","report","statName","eventChannel","eventType","_handlePvtEvent","pvtData","handleMessage","_ack","_buildCall","callee_id_number","caller_id_name","caller_id_number","callee_id_name","Punt","disconnect","Ringing","autoRecoverCalls","Recovering","firstValue","_handleSessionEvent","ClientReady","laChannel","callIds","me","pr","_liveArrayBootstrap","liveArray","_retrieveCallId","handleConferenceUpdate","Leave","vertoUnsubscribe","unsubscribedChannels","c","LogoInfo","logo","logoURL","broadcastParams","event_type","calling","notificationHandler","tasking","messaging","KEEPALIVE_INTERVAL","expiresAt","contexts","connection","_jwtAuth","_doKeepAlive","_autoReconnect","_idle","_executeQueue","validateOptions","_onSocketOpen","_onSocketCloseOrError","_onSocketMessage","_handleLoginError","_checkTokenExpiration","_attachListeners","now","_closeConnection","connect","sendRawText","token","Boolean","bs","failed_channels","subscribe_channels","_removeSubscription","_addSubscription","_reconnectTimeout","_detachListeners","expired","br","authorization","expires_at","isAlive","tokenKey","bc","nodeid","master_nodeid","Setup","_emptyExecuteQueues","_pong","_keepAlive","Ready","sub","reconnectDelay","BroadcastHandler","Disconnect","on","off","executeRaw","_keepAliveTimeout","diff","_iceServers","_localElement","_remoteElement","_devices","_audioConstraints","_videoConstraints","_speaker","_super","get","bytes","speedTestResult","upKps","downKps","toFixed","loops","dots","repeat","AudioOut","cache","videoinput","audioinput","audiooutput","settings","servers","urls","VERSION","$","uncurryThis","IndexedObject","toIndexedObject","arrayMethodIsStrict","un$Join","ES3_STRINGS","STRICT_METHOD","target","proto","forced","separator","$includes","addToUnscopables","el"],"mappings":"gHAAA,4MAAO,MAAMA,EAAiB,eACjBC,EAAM,MACNC,EAAS,SACTC,EAAa,SACnB,IAAIC,EAcAC,GAbX,SAAWD,GACPA,EAAQ,cAAgB,yBACxBA,EAAQ,eAAiB,0BACzBA,EAAQ,eAAiB,0BACzBA,EAAQ,iBAAmB,4BAC3BA,EAAQ,aAAe,gCACvBA,EAAQ,SAAW,mBACnBA,EAAQ,SAAW,mBACnBA,EAAQ,gBAAkB,0BAC1BA,EAAQ,YAAc,sBACtBA,EAAQ,SAAW,mBACnBA,EAAQ,cAAgB,6BAX5B,CAYGA,IAAYA,EAAU,KAEzB,SAAWC,GACPA,EAAY,aAAe,kBAC3BA,EAAY,cAAgB,mBAFhC,CAGGA,IAAgBA,EAAc,M,gFCtBjC,SAASC,EAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQC,EAAKC,GACpE,IACE,IAAIC,EAAOP,EAAIK,GAAKC,GAChBE,EAAQD,EAAKC,MACjB,MAAOC,GAEP,YADAP,EAAOO,GAILF,EAAKG,KACPT,EAAQO,GAERG,QAAQV,QAAQO,GAAOI,KAAKT,EAAOC,GAIxB,SAASS,EAAkBC,GACxC,OAAO,WACL,IAAIC,EAAOC,KACPC,EAAOC,UACX,OAAO,IAAIP,SAAQ,SAAUV,EAASC,GACpC,IAAIF,EAAMc,EAAGK,MAAMJ,EAAME,GAEzB,SAASd,EAAMK,GACbT,EAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQ,OAAQI,GAGlE,SAASJ,EAAOgB,GACdrB,EAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQ,QAASgB,GAGnEjB,OAAMkB,S,oCC9BZ,IAAIC,EAAuB,EAAQ,QAA8BC,OAC7DC,EAAW,EAAQ,QACnBC,EAAW,EAAQ,QACnBC,EAAY,EAAQ,QACpBC,EAAQ,EAAQ,QAChBC,EAAiB,EAAQ,QAEzBC,EAAY,WACZC,EAAkBC,OAAOC,UACzBC,EAAaH,EAAgBD,GAE7BK,EAAcP,GAAM,WAAc,MAAuD,QAAhDM,EAAWE,KAAK,CAAEC,OAAQ,IAAKC,MAAO,SAE/EC,EAAiBhB,GAAwBW,EAAWM,MAAQV,GAI5DK,GAAeI,IACjBd,EAASO,OAAOC,UAAWH,GAAW,WACpC,IAAIW,EAAIf,EAAST,MACbyB,EAAUf,EAAUc,EAAEJ,QACtBC,EAAQX,EAAUE,EAAeY,IACrC,MAAO,IAAMC,EAAU,IAAMJ,IAC5B,CAAEK,QAAQ,K,qCCxBf,gGAAIC,EAAwC,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMxC,GAAS,OAAOA,aAAiBsC,EAAItC,EAAQ,IAAIsC,GAAE,SAAU7C,GAAWA,EAAQO,MAC/F,OAAO,IAAKsC,IAAMA,EAAInC,WAAU,SAAUV,EAASC,GAC/C,SAAS+C,EAAUzC,GAAS,IAAM0C,EAAKH,EAAUI,KAAK3C,IAAW,MAAO4C,GAAKlD,EAAOkD,IACpF,SAASC,EAAS7C,GAAS,IAAM0C,EAAKH,EAAU,SAASvC,IAAW,MAAO4C,GAAKlD,EAAOkD,IACvF,SAASF,EAAKI,GAAUA,EAAO5C,KAAOT,EAAQqD,EAAO9C,OAASwC,EAAMM,EAAO9C,OAAOI,KAAKqC,EAAWI,GAClGH,GAAMH,EAAYA,EAAU5B,MAAMyB,EAASC,GAAc,KAAKM,YAItE,MAAMI,EAAU,IAAwB,qBAAXC,QAA6C,qBAAZC,EACxDC,EAAO,CAACC,EAAatD,IAAQsC,OAAU,OAAQ,OAAQ,GAAQ,YACjE,GAAIY,IACA,OAAO,KACX,MAAMK,EAAMJ,OAAOG,GAAaE,QAAQ,eAAiBxD,IACzD,OAAO,eAAcuD,MAEnBE,EAAO,CAACH,EAAatD,EAAKG,IAAUmC,OAAU,OAAQ,OAAQ,GAAQ,YACxE,GAAIY,IACA,OAAO,KACU,kBAAV/C,IACPA,EAAQuD,KAAKC,UAAUxD,IAE3BgD,OAAOG,GAAaM,QAAQ,eAAiB5D,GAAMG,MAEjD0D,EAAU,CAACP,EAAatD,IAAQsC,OAAU,OAAQ,OAAQ,GAAQ,YACpE,OAAIY,IACO,KACJC,OAAOG,GAAaQ,WAAW,eAAiB9D,OAE9C+D,EAAe,CACxBP,QAAUxD,GAAQqD,EAAK,eAAgBrD,GACvC4D,QAAS,CAAC5D,EAAKG,IAAUsD,EAAK,eAAgBzD,EAAKG,GACnD2D,WAAa9D,GAAQ6D,EAAQ,eAAgB7D,IAEpCgE,EAAiB,CAC1BR,QAAUxD,GAAQqD,EAAK,iBAAkBrD,GACzC4D,QAAS,CAAC5D,EAAKG,IAAUsD,EAAK,iBAAkBzD,EAAKG,GACrD2D,WAAa9D,GAAQ6D,EAAQ,iBAAkB7D,M,8CChClD,SAAUiE,EAAMC,GACb,aACsB,oBAAXC,QAAyBA,OAAOC,IACvCD,OAAOD,GAC8BG,EAAOC,QAC5CD,EAAOC,QAAUJ,IAEjBD,EAAKM,IAAML,KAPnB,CASEvD,MAAM,WACJ,aAGA,IAAI6D,EAAO,aACPC,EAAgB,YAChBC,SAAevB,SAAWsB,UAA0BtB,OAAOwB,YAAcF,GACzE,kBAAkBG,KAAKzB,OAAOwB,UAAUE,WAGxCC,EAAa,CACb,QACA,QACA,OACA,OACA,SAIJ,SAASC,EAAWC,EAAKC,GACrB,IAAIC,EAASF,EAAIC,GACjB,GAA2B,oBAAhBC,EAAOC,KACd,OAAOD,EAAOC,KAAKH,GAEnB,IACI,OAAOI,SAASzD,UAAUwD,KAAKrD,KAAKoD,EAAQF,GAC9C,MAAOjC,GAEL,OAAO,WACH,OAAOqC,SAASzD,UAAUb,MAAMA,MAAMoE,EAAQ,CAACF,EAAKnE,cAOpE,SAASwE,IACDC,QAAQf,MACJe,QAAQf,IAAIzD,MACZwE,QAAQf,IAAIzD,MAAMwE,QAASzE,WAG3BuE,SAASzD,UAAUb,MAAMA,MAAMwE,QAAQf,IAAK,CAACe,QAASzE,aAG1DyE,QAAQC,OAAOD,QAAQC,QAK/B,SAASC,EAAWP,GAKhB,MAJmB,UAAfA,IACAA,EAAa,cAGNK,UAAYb,IAEG,UAAfQ,GAA0BP,EAC1BW,OACwBrE,IAAxBsE,QAAQL,GACRF,EAAWO,QAASL,QACJjE,IAAhBsE,QAAQf,IACRQ,EAAWO,QAAS,OAEpBd,GAMf,SAASiB,EAAsBC,EAAOC,GAElC,IAAK,IAAIC,EAAI,EAAGA,EAAId,EAAWe,OAAQD,IAAK,CACxC,IAAIX,EAAaH,EAAWc,GAC5BjF,KAAKsE,GAAeW,EAAIF,EACpBlB,EACA7D,KAAKmF,cAAcb,EAAYS,EAAOC,GAI9ChF,KAAK4D,IAAM5D,KAAKoF,MAKpB,SAASC,EAAgCf,EAAYS,EAAOC,GACxD,OAAO,kBACQL,UAAYb,IACnBgB,EAAsB3D,KAAKnB,KAAM+E,EAAOC,GACxChF,KAAKsE,GAAYnE,MAAMH,KAAME,aAOzC,SAASoF,EAAqBhB,EAAYS,EAAOC,GAE7C,OAAOH,EAAWP,IACXe,EAAgClF,MAAMH,KAAME,WAGvD,SAASqF,EAAOhE,EAAMiE,EAAcC,GAClC,IACIC,EADA3F,EAAOC,KAEXwF,EAA+B,MAAhBA,EAAuB,OAASA,EAE/C,IAAIG,EAAa,WAOjB,SAASC,EAAuBC,GAC5B,IAAIC,GAAa3B,EAAW0B,IAAa,UAAUE,cAEnD,UAAWvD,SAAWsB,GAAkB6B,EAAxC,CAGA,IAEI,YADAnD,OAAOY,aAAauC,GAAcG,GAEpC,MAAOE,IAGT,IACIxD,OAAOyD,SAASC,OACdC,mBAAmBR,GAAc,IAAMG,EAAY,IACvD,MAAOE,MAGb,SAASI,IACL,IAAIC,EAEJ,UAAW7D,SAAWsB,GAAkB6B,EAAxC,CAEA,IACIU,EAAc7D,OAAOY,aAAauC,GACpC,MAAOK,IAGT,UAAWK,IAAgBvC,EACvB,IACI,IAAIoC,EAAS1D,OAAOyD,SAASC,OACzBI,EAAWJ,EAAOK,QAClBJ,mBAAmBR,GAAc,MACnB,IAAdW,IACAD,EAAc,WAAWG,KAAKN,EAAOO,MAAMH,IAAW,IAE5D,MAAON,IAQb,YAJiC3F,IAA7BN,EAAK2G,OAAOL,KACZA,OAAchG,GAGXgG,GAGX,SAASM,IACL,UAAWnE,SAAWsB,GAAkB6B,EAAxC,CAGA,IAEI,YADAnD,OAAOY,aAAaD,WAAWwC,GAEjC,MAAOK,IAGT,IACIxD,OAAOyD,SAASC,OACdC,mBAAmBR,GAAc,2CACrC,MAAOK,MAlEO,kBAATzE,EACToE,GAAc,IAAMpE,EACK,kBAATA,IAChBoE,OAAatF,GAwEfN,EAAKwB,KAAOA,EAEZxB,EAAK2G,OAAS,CAAE,MAAS,EAAG,MAAS,EAAG,KAAQ,EAAG,KAAQ,EACvD,MAAS,EAAG,OAAU,GAE1B3G,EAAKoF,cAAgBM,GAAWH,EAEhCvF,EAAK6G,SAAW,WACZ,OAAOlB,GAGX3F,EAAK8G,SAAW,SAAU9B,EAAO+B,GAI7B,GAHqB,kBAAV/B,QAA2D1E,IAArCN,EAAK2G,OAAO3B,EAAMgB,iBAC/ChB,EAAQhF,EAAK2G,OAAO3B,EAAMgB,kBAET,kBAAVhB,GAAsBA,GAAS,GAAKA,GAAShF,EAAK2G,OAAOK,QAUhE,KAAM,6CAA+ChC,EAJrD,GALAW,EAAeX,GACC,IAAZ+B,GACAlB,EAAuBb,GAE3BD,EAAsB3D,KAAKpB,EAAMgF,EAAOxD,UAC7BoD,UAAYb,GAAiBiB,EAAQhF,EAAK2G,OAAOK,OACxD,MAAO,oCAOnBhH,EAAKiH,gBAAkB,SAAUjC,GAC7BS,EAAeT,EACVqB,KACDrG,EAAK8G,SAAS9B,GAAO,IAI7BhF,EAAKkH,WAAa,WACdlH,EAAK8G,SAASrB,GAAc,GAC5BmB,KAGJ5G,EAAKmH,UAAY,SAASJ,GACtB/G,EAAK8G,SAAS9G,EAAK2G,OAAOS,MAAOL,IAGrC/G,EAAKqH,WAAa,SAASN,GACvB/G,EAAK8G,SAAS9G,EAAK2G,OAAOK,OAAQD,IAItC,IAAIO,EAAejB,IACC,MAAhBiB,IACAA,EAAe7B,GAEnBzF,EAAK8G,SAASQ,GAAc,GAS9B,IAAIC,EAAgB,IAAI/B,EAEpBgC,EAAiB,GACrBD,EAAcE,UAAY,SAAmBjG,GACzC,GAAqB,kBAATA,GAAqC,kBAATA,GAA+B,KAATA,EAC5D,MAAM,IAAIkG,UAAU,kDAGtB,IAAIC,EAASH,EAAehG,GAK5B,OAJKmG,IACHA,EAASH,EAAehG,GAAQ,IAAIgE,EAClChE,EAAM+F,EAAcV,WAAYU,EAAcnC,gBAE3CuC,GAIX,IAAIC,SAAenF,SAAWsB,EAAiBtB,OAAOoB,SAAMvD,EAiB5D,OAhBAiH,EAAcM,WAAa,WAMvB,cALWpF,SAAWsB,GACftB,OAAOoB,MAAQ0D,IAClB9E,OAAOoB,IAAM+D,GAGVL,GAGXA,EAAcO,WAAa,WACvB,OAAON,GAIXD,EAAc,WAAaA,EAEpBA,M,kCCvSX,yBACA,MAAMQ,EAAW,KAAM,IAAIC,MAAOC,cAAcC,QAAQ,IAAK,KAAKA,QAAQ,IAAK,IACzEP,EAAS,IAAIF,UAAU,cACvBU,EAAkBR,EAAOvC,cAC/BuC,EAAOvC,cAAgB,CAACb,EAAY6D,EAAUnD,KAC1C,MAAMoD,EAAYF,EAAgB5D,EAAY6D,EAAUnD,GACxD,OAAO,WACH,MAAMqD,EAAW,CAACP,IAAY,KAC9B,IAAK,IAAI7C,EAAI,EAAGA,EAAI/E,UAAUgF,OAAQD,IAClCoD,EAASC,KAAKpI,UAAU+E,IAE5BmD,EAAUjI,WAAME,EAAWgI,KAGnCX,EAAOb,SAASa,EAAOd,YACR,U,oCCff,gXAEO,MACM2B,EAAYlE,GAAoC,IAA5BmE,OAAOC,KAAKpE,GAAKa,OACrCwD,EAAoBrJ,GAAQ,GAAG,SAAiBA,IAChDsJ,EAAuBC,IAChC,MAAOC,EAAeC,EAAmBC,EAAiBC,EAAOC,EAAWC,GAAmBN,EAC/F,IAAIO,EAAQ,GACZ,IACIA,EAAQpG,KAAKqG,MAAMH,EAAUhB,QAAQ,OAAQ,QAEjD,MAAOxI,GACH,OAAO4J,KAAK,sCAAuCJ,GAEvD,MAAO,CAAEJ,cAAeS,OAAOT,GAAgBC,oBAAmBC,kBAAiBC,QAAOG,QAAOD,oBAExFK,EAAiB/J,IAC1B,GAAqB,kBAAVA,EACP,OAAOA,EAEX,IACI,OAAOuD,KAAKqG,MAAM5J,GAEtB,MAAOC,GACH,OAAOD,IAGFgK,EAAaC,GAAiC,qBAAbA,EACjCC,EAAcD,GAAaA,aAAoBhF,UAAgC,oBAAbgF,EAClEE,EAAqBC,GACN,kBAAb3D,UAA2B,mBAAoBA,SAGvC,kBAAR2D,EACA3D,SAAS4D,eAAeD,IAAQ,KAEnB,oBAARA,EACLA,IAEFA,aAAeE,iBACbF,EAEJ,KAXI,KAaTG,EAAmB,iBACZC,EAAsBC,IAC/B,MAAMC,EAAWH,EAAiB9F,KAAKgG,GAAQ,GAAK,SACpD,MAAO,GAAGC,IAAWD,KAEZE,EAAmB,CAACC,EAAUC,EAAS,QAChD,MAAM,OAAE/H,EAAS,GAAE,MAAE7C,GAAU2K,EAC/B,GAAI3K,EACA,MAAO,CAAEA,SAEb,MAAQ6C,OAAQgI,EAAe,MAAShI,EACxC,GAAqB,OAAjBgI,EAIA,OAHe,OAAXD,IACA/H,EAAOiI,QAAUF,GAEd,CAAE/H,UAEb,MAAM,KAAEkI,EAAO,KAAI,QAAED,EAAU,KAAMjI,OAAQmI,EAAc,MAASH,EACpE,OAAIE,GAAiB,QAATA,EACD,CAAE/K,MAAO6K,GAEhBG,EACON,EAAiBM,EAAaF,GAElC,CAAEjI,OAAQgI,IAERI,EAAY,CAACC,EAAKC,IACpBC,KAAKC,MAAMD,KAAKE,UAAYH,EAAMD,EAAM,GAAKA,I,uBCvExD,IAAIxJ,EAAO,EAAQ,QACf6J,EAAS,EAAQ,QACjBC,EAAgB,EAAQ,QACxBC,EAAc,EAAQ,QAEtBpK,EAAkBC,OAAOC,UAE7B0C,EAAOC,QAAU,SAAUnC,GACzB,IAAIH,EAAQG,EAAEH,MACd,YAAiBhB,IAAVgB,GAAyB,UAAWP,GAAqBkK,EAAOxJ,EAAG,WAAYyJ,EAAcnK,EAAiBU,GAC1FH,EAAvBF,EAAK+J,EAAa1J,K,uBCHxB,IAAI2J,EAAW,SAAUxH,GACvB,aAEA,IAEItD,EAFA+K,EAAK5C,OAAOxH,UACZgK,EAASI,EAAGC,eAEZC,EAA4B,oBAAXC,OAAwBA,OAAS,GAClDC,EAAiBF,EAAQG,UAAY,aACrCC,EAAsBJ,EAAQK,eAAiB,kBAC/CC,EAAoBN,EAAQO,aAAe,gBAE/C,SAASrI,EAAOa,EAAKhF,EAAKG,GAOxB,OANAgJ,OAAOsD,eAAezH,EAAKhF,EAAK,CAC9BG,MAAOA,EACPuM,YAAY,EACZC,cAAc,EACdC,UAAU,IAEL5H,EAAIhF,GAEb,IAEEmE,EAAO,GAAI,IACX,MAAOpD,GACPoD,EAAS,SAASa,EAAKhF,EAAKG,GAC1B,OAAO6E,EAAIhF,GAAOG,GAItB,SAAS0M,EAAKC,EAASC,EAASrM,EAAMsM,GAEpC,IAAIC,EAAiBF,GAAWA,EAAQpL,qBAAqBuL,EAAYH,EAAUG,EAC/ExK,EAAYyG,OAAOgE,OAAOF,EAAetL,WACzCyL,EAAU,IAAIC,EAAQL,GAAe,IAMzC,OAFAtK,EAAU4K,QAAUC,EAAiBT,EAASpM,EAAM0M,GAE7C1K,EAcT,SAAS8K,EAAS/M,EAAIuE,EAAK/E,GACzB,IACE,MAAO,CAAEwN,KAAM,SAAUxN,IAAKQ,EAAGqB,KAAKkD,EAAK/E,IAC3C,MAAOc,GACP,MAAO,CAAE0M,KAAM,QAASxN,IAAKc,IAhBjCuD,EAAQuI,KAAOA,EAoBf,IAAIa,EAAyB,iBACzBC,EAAyB,iBACzBC,EAAoB,YACpBC,EAAoB,YAIpBC,EAAmB,GAMvB,SAASZ,KACT,SAASa,KACT,SAASC,KAIT,IAAIC,EAAoB,GACxB9J,EAAO8J,EAAmB9B,GAAgB,WACxC,OAAOxL,QAGT,IAAIuN,EAAW/E,OAAOgF,eAClBC,EAA0BF,GAAYA,EAASA,EAASG,EAAO,MAC/DD,GACAA,IAA4BrC,GAC5BJ,EAAO7J,KAAKsM,EAAyBjC,KAGvC8B,EAAoBG,GAGtB,IAAIE,EAAKN,EAA2BrM,UAClCuL,EAAUvL,UAAYwH,OAAOgE,OAAOc,GAYtC,SAASM,EAAsB5M,GAC7B,CAAC,OAAQ,QAAS,UAAU6M,SAAQ,SAAStJ,GAC3Cf,EAAOxC,EAAWuD,GAAQ,SAASjF,GACjC,OAAOU,KAAK2M,QAAQpI,EAAQjF,SAkClC,SAASwO,EAAc/L,EAAWgM,GAChC,SAASC,EAAOzJ,EAAQjF,EAAKL,EAASC,GACpC,IAAI+O,EAASpB,EAAS9K,EAAUwC,GAASxC,EAAWzC,GACpD,GAAoB,UAAhB2O,EAAOnB,KAEJ,CACL,IAAIxK,EAAS2L,EAAO3O,IAChBE,EAAQ8C,EAAO9C,MACnB,OAAIA,GACiB,kBAAVA,GACPwL,EAAO7J,KAAK3B,EAAO,WACduO,EAAY9O,QAAQO,EAAM0O,SAAStO,MAAK,SAASJ,GACtDwO,EAAO,OAAQxO,EAAOP,EAASC,MAC9B,SAASkB,GACV4N,EAAO,QAAS5N,EAAKnB,EAASC,MAI3B6O,EAAY9O,QAAQO,GAAOI,MAAK,SAASuO,GAI9C7L,EAAO9C,MAAQ2O,EACflP,EAAQqD,MACP,SAAS7C,GAGV,OAAOuO,EAAO,QAASvO,EAAOR,EAASC,MAvBzCA,EAAO+O,EAAO3O,KA4BlB,IAAI8O,EAEJ,SAASC,EAAQ9J,EAAQjF,GACvB,SAASgP,IACP,OAAO,IAAIP,GAAY,SAAS9O,EAASC,GACvC8O,EAAOzJ,EAAQjF,EAAKL,EAASC,MAIjC,OAAOkP,EAaLA,EAAkBA,EAAgBxO,KAChC0O,EAGAA,GACEA,IAKRtO,KAAK2M,QAAU0B,EA2BjB,SAASzB,EAAiBT,EAASpM,EAAM0M,GACvC,IAAI8B,EAAQxB,EAEZ,OAAO,SAAgBxI,EAAQjF,GAC7B,GAAIiP,IAAUtB,EACZ,MAAM,IAAIuB,MAAM,gCAGlB,GAAID,IAAUrB,EAAmB,CAC/B,GAAe,UAAX3I,EACF,MAAMjF,EAKR,OAAOmP,IAGThC,EAAQlI,OAASA,EACjBkI,EAAQnN,IAAMA,EAEd,MAAO,EAAM,CACX,IAAIoP,EAAWjC,EAAQiC,SACvB,GAAIA,EAAU,CACZ,IAAIC,EAAiBC,EAAoBF,EAAUjC,GACnD,GAAIkC,EAAgB,CAClB,GAAIA,IAAmBxB,EAAkB,SACzC,OAAOwB,GAIX,GAAuB,SAAnBlC,EAAQlI,OAGVkI,EAAQoC,KAAOpC,EAAQqC,MAAQrC,EAAQnN,SAElC,GAAuB,UAAnBmN,EAAQlI,OAAoB,CACrC,GAAIgK,IAAUxB,EAEZ,MADAwB,EAAQrB,EACFT,EAAQnN,IAGhBmN,EAAQsC,kBAAkBtC,EAAQnN,SAEN,WAAnBmN,EAAQlI,QACjBkI,EAAQuC,OAAO,SAAUvC,EAAQnN,KAGnCiP,EAAQtB,EAER,IAAIgB,EAASpB,EAASV,EAASpM,EAAM0M,GACrC,GAAoB,WAAhBwB,EAAOnB,KAAmB,CAO5B,GAJAyB,EAAQ9B,EAAQ/M,KACZwN,EACAF,EAEAiB,EAAO3O,MAAQ6N,EACjB,SAGF,MAAO,CACL3N,MAAOyO,EAAO3O,IACdI,KAAM+M,EAAQ/M,MAGS,UAAhBuO,EAAOnB,OAChByB,EAAQrB,EAGRT,EAAQlI,OAAS,QACjBkI,EAAQnN,IAAM2O,EAAO3O,OAU7B,SAASsP,EAAoBF,EAAUjC,GACrC,IAAIlI,EAASmK,EAASjD,SAASgB,EAAQlI,QACvC,GAAIA,IAAWlE,EAAW,CAKxB,GAFAoM,EAAQiC,SAAW,KAEI,UAAnBjC,EAAQlI,OAAoB,CAE9B,GAAImK,EAASjD,SAAS,YAGpBgB,EAAQlI,OAAS,SACjBkI,EAAQnN,IAAMe,EACduO,EAAoBF,EAAUjC,GAEP,UAAnBA,EAAQlI,QAGV,OAAO4I,EAIXV,EAAQlI,OAAS,QACjBkI,EAAQnN,IAAM,IAAImI,UAChB,kDAGJ,OAAO0F,EAGT,IAAIc,EAASpB,EAAStI,EAAQmK,EAASjD,SAAUgB,EAAQnN,KAEzD,GAAoB,UAAhB2O,EAAOnB,KAIT,OAHAL,EAAQlI,OAAS,QACjBkI,EAAQnN,IAAM2O,EAAO3O,IACrBmN,EAAQiC,SAAW,KACZvB,EAGT,IAAI5N,EAAO0O,EAAO3O,IAElB,OAAMC,EAOFA,EAAKG,MAGP+M,EAAQiC,EAASO,YAAc1P,EAAKC,MAGpCiN,EAAQtK,KAAOuM,EAASQ,QAQD,WAAnBzC,EAAQlI,SACVkI,EAAQlI,OAAS,OACjBkI,EAAQnN,IAAMe,GAUlBoM,EAAQiC,SAAW,KACZvB,GANE5N,GA3BPkN,EAAQlI,OAAS,QACjBkI,EAAQnN,IAAM,IAAImI,UAAU,oCAC5BgF,EAAQiC,SAAW,KACZvB,GAoDX,SAASgC,EAAaC,GACpB,IAAIC,EAAQ,CAAEC,OAAQF,EAAK,IAEvB,KAAKA,IACPC,EAAME,SAAWH,EAAK,IAGpB,KAAKA,IACPC,EAAMG,WAAaJ,EAAK,GACxBC,EAAMI,SAAWL,EAAK,IAGxBpP,KAAK0P,WAAWpH,KAAK+G,GAGvB,SAASM,EAAcN,GACrB,IAAIpB,EAASoB,EAAMO,YAAc,GACjC3B,EAAOnB,KAAO,gBACPmB,EAAO3O,IACd+P,EAAMO,WAAa3B,EAGrB,SAASvB,EAAQL,GAIfrM,KAAK0P,WAAa,CAAC,CAAEJ,OAAQ,SAC7BjD,EAAYwB,QAAQsB,EAAcnP,MAClCA,KAAK6P,OAAM,GA8Bb,SAASnC,EAAOoC,GACd,GAAIA,EAAU,CACZ,IAAIC,EAAiBD,EAAStE,GAC9B,GAAIuE,EACF,OAAOA,EAAe5O,KAAK2O,GAG7B,GAA6B,oBAAlBA,EAAS3N,KAClB,OAAO2N,EAGT,IAAKE,MAAMF,EAAS5K,QAAS,CAC3B,IAAID,GAAK,EAAG9C,EAAO,SAASA,IAC1B,QAAS8C,EAAI6K,EAAS5K,OACpB,GAAI8F,EAAO7J,KAAK2O,EAAU7K,GAGxB,OAFA9C,EAAK3C,MAAQsQ,EAAS7K,GACtB9C,EAAKzC,MAAO,EACLyC,EAOX,OAHAA,EAAK3C,MAAQa,EACb8B,EAAKzC,MAAO,EAELyC,GAGT,OAAOA,EAAKA,KAAOA,GAKvB,MAAO,CAAEA,KAAMsM,GAIjB,SAASA,IACP,MAAO,CAAEjP,MAAOa,EAAWX,MAAM,GA+MnC,OA7mBA0N,EAAkBpM,UAAYqM,EAC9B7J,EAAOmK,EAAI,cAAeN,GAC1B7J,EAAO6J,EAA4B,cAAeD,GAClDA,EAAkB6C,YAAczM,EAC9B6J,EACAzB,EACA,qBAaFjI,EAAQuM,oBAAsB,SAASC,GACrC,IAAIC,EAAyB,oBAAXD,GAAyBA,EAAOE,YAClD,QAAOD,IACHA,IAAShD,GAG2B,uBAAnCgD,EAAKH,aAAeG,EAAK7O,QAIhCoC,EAAQ2M,KAAO,SAASH,GAQtB,OAPI3H,OAAO+H,eACT/H,OAAO+H,eAAeJ,EAAQ9C,IAE9B8C,EAAOK,UAAYnD,EACnB7J,EAAO2M,EAAQvE,EAAmB,sBAEpCuE,EAAOnP,UAAYwH,OAAOgE,OAAOmB,GAC1BwC,GAOTxM,EAAQ8M,MAAQ,SAASnR,GACvB,MAAO,CAAE4O,QAAS5O,IAsEpBsO,EAAsBE,EAAc9M,WACpCwC,EAAOsK,EAAc9M,UAAW0K,GAAqB,WACnD,OAAO1L,QAET2D,EAAQmK,cAAgBA,EAKxBnK,EAAQ+M,MAAQ,SAASvE,EAASC,EAASrM,EAAMsM,EAAa0B,QACxC,IAAhBA,IAAwBA,EAAcpO,SAE1C,IAAIgR,EAAO,IAAI7C,EACb5B,EAAKC,EAASC,EAASrM,EAAMsM,GAC7B0B,GAGF,OAAOpK,EAAQuM,oBAAoB9D,GAC/BuE,EACAA,EAAKxO,OAAOvC,MAAK,SAAS0C,GACxB,OAAOA,EAAO5C,KAAO4C,EAAO9C,MAAQmR,EAAKxO,WAuKjDyL,EAAsBD,GAEtBnK,EAAOmK,EAAI/B,EAAmB,aAO9BpI,EAAOmK,EAAInC,GAAgB,WACzB,OAAOxL,QAGTwD,EAAOmK,EAAI,YAAY,WACrB,MAAO,wBAkCThK,EAAQ8E,KAAO,SAASmI,GACtB,IAAInI,EAAO,GACX,IAAK,IAAIpJ,KAAOuR,EACdnI,EAAKH,KAAKjJ,GAMZ,OAJAoJ,EAAKoI,UAIE,SAAS1O,IACd,MAAOsG,EAAKvD,OAAQ,CAClB,IAAI7F,EAAMoJ,EAAKqI,MACf,GAAIzR,KAAOuR,EAGT,OAFAzO,EAAK3C,MAAQH,EACb8C,EAAKzC,MAAO,EACLyC,EAQX,OADAA,EAAKzC,MAAO,EACLyC,IAsCXwB,EAAQ+J,OAASA,EAMjBhB,EAAQ1L,UAAY,CAClBqP,YAAa3D,EAEbmD,MAAO,SAASkB,GAcd,GAbA/Q,KAAKgR,KAAO,EACZhR,KAAKmC,KAAO,EAGZnC,KAAK6O,KAAO7O,KAAK8O,MAAQzO,EACzBL,KAAKN,MAAO,EACZM,KAAK0O,SAAW,KAEhB1O,KAAKuE,OAAS,OACdvE,KAAKV,IAAMe,EAEXL,KAAK0P,WAAW7B,QAAQ8B,IAEnBoB,EACH,IAAK,IAAIxP,KAAQvB,KAEQ,MAAnBuB,EAAK0P,OAAO,IACZjG,EAAO7J,KAAKnB,KAAMuB,KACjByO,OAAOzO,EAAKkF,MAAM,MACrBzG,KAAKuB,GAAQlB,IAMrB6Q,KAAM,WACJlR,KAAKN,MAAO,EAEZ,IAAIyR,EAAYnR,KAAK0P,WAAW,GAC5B0B,EAAaD,EAAUvB,WAC3B,GAAwB,UAApBwB,EAAWtE,KACb,MAAMsE,EAAW9R,IAGnB,OAAOU,KAAKqR,MAGdtC,kBAAmB,SAASuC,GAC1B,GAAItR,KAAKN,KACP,MAAM4R,EAGR,IAAI7E,EAAUzM,KACd,SAASuR,EAAOC,EAAKC,GAYnB,OAXAxD,EAAOnB,KAAO,QACdmB,EAAO3O,IAAMgS,EACb7E,EAAQtK,KAAOqP,EAEXC,IAGFhF,EAAQlI,OAAS,OACjBkI,EAAQnN,IAAMe,KAGNoR,EAGZ,IAAK,IAAIxM,EAAIjF,KAAK0P,WAAWxK,OAAS,EAAGD,GAAK,IAAKA,EAAG,CACpD,IAAIoK,EAAQrP,KAAK0P,WAAWzK,GACxBgJ,EAASoB,EAAMO,WAEnB,GAAqB,SAAjBP,EAAMC,OAIR,OAAOiC,EAAO,OAGhB,GAAIlC,EAAMC,QAAUtP,KAAKgR,KAAM,CAC7B,IAAIU,EAAW1G,EAAO7J,KAAKkO,EAAO,YAC9BsC,EAAa3G,EAAO7J,KAAKkO,EAAO,cAEpC,GAAIqC,GAAYC,EAAY,CAC1B,GAAI3R,KAAKgR,KAAO3B,EAAME,SACpB,OAAOgC,EAAOlC,EAAME,UAAU,GACzB,GAAIvP,KAAKgR,KAAO3B,EAAMG,WAC3B,OAAO+B,EAAOlC,EAAMG,iBAGjB,GAAIkC,GACT,GAAI1R,KAAKgR,KAAO3B,EAAME,SACpB,OAAOgC,EAAOlC,EAAME,UAAU,OAG3B,KAAIoC,EAMT,MAAM,IAAInD,MAAM,0CALhB,GAAIxO,KAAKgR,KAAO3B,EAAMG,WACpB,OAAO+B,EAAOlC,EAAMG,gBAU9BR,OAAQ,SAASlC,EAAMxN,GACrB,IAAK,IAAI2F,EAAIjF,KAAK0P,WAAWxK,OAAS,EAAGD,GAAK,IAAKA,EAAG,CACpD,IAAIoK,EAAQrP,KAAK0P,WAAWzK,GAC5B,GAAIoK,EAAMC,QAAUtP,KAAKgR,MACrBhG,EAAO7J,KAAKkO,EAAO,eACnBrP,KAAKgR,KAAO3B,EAAMG,WAAY,CAChC,IAAIoC,EAAevC,EACnB,OAIAuC,IACU,UAAT9E,GACS,aAATA,IACD8E,EAAatC,QAAUhQ,GACvBA,GAAOsS,EAAapC,aAGtBoC,EAAe,MAGjB,IAAI3D,EAAS2D,EAAeA,EAAahC,WAAa,GAItD,OAHA3B,EAAOnB,KAAOA,EACdmB,EAAO3O,IAAMA,EAETsS,GACF5R,KAAKuE,OAAS,OACdvE,KAAKmC,KAAOyP,EAAapC,WAClBrC,GAGFnN,KAAK6R,SAAS5D,IAGvB4D,SAAU,SAAS5D,EAAQwB,GACzB,GAAoB,UAAhBxB,EAAOnB,KACT,MAAMmB,EAAO3O,IAcf,MAXoB,UAAhB2O,EAAOnB,MACS,aAAhBmB,EAAOnB,KACT9M,KAAKmC,KAAO8L,EAAO3O,IACM,WAAhB2O,EAAOnB,MAChB9M,KAAKqR,KAAOrR,KAAKV,IAAM2O,EAAO3O,IAC9BU,KAAKuE,OAAS,SACdvE,KAAKmC,KAAO,OACa,WAAhB8L,EAAOnB,MAAqB2C,IACrCzP,KAAKmC,KAAOsN,GAGPtC,GAGT2E,OAAQ,SAAStC,GACf,IAAK,IAAIvK,EAAIjF,KAAK0P,WAAWxK,OAAS,EAAGD,GAAK,IAAKA,EAAG,CACpD,IAAIoK,EAAQrP,KAAK0P,WAAWzK,GAC5B,GAAIoK,EAAMG,aAAeA,EAGvB,OAFAxP,KAAK6R,SAASxC,EAAMO,WAAYP,EAAMI,UACtCE,EAAcN,GACPlC,IAKb,MAAS,SAASmC,GAChB,IAAK,IAAIrK,EAAIjF,KAAK0P,WAAWxK,OAAS,EAAGD,GAAK,IAAKA,EAAG,CACpD,IAAIoK,EAAQrP,KAAK0P,WAAWzK,GAC5B,GAAIoK,EAAMC,SAAWA,EAAQ,CAC3B,IAAIrB,EAASoB,EAAMO,WACnB,GAAoB,UAAhB3B,EAAOnB,KAAkB,CAC3B,IAAIiF,EAAS9D,EAAO3O,IACpBqQ,EAAcN,GAEhB,OAAO0C,GAMX,MAAM,IAAIvD,MAAM,0BAGlBwD,cAAe,SAASlC,EAAUb,EAAYC,GAa5C,OAZAlP,KAAK0O,SAAW,CACdjD,SAAUiC,EAAOoC,GACjBb,WAAYA,EACZC,QAASA,GAGS,SAAhBlP,KAAKuE,SAGPvE,KAAKV,IAAMe,GAGN8M,IAQJxJ,EA9sBK,CAqtBiBD,EAAOC,SAGtC,IACEsO,mBAAqB9G,EACrB,MAAO+G,GAWmB,kBAAfC,WACTA,WAAWF,mBAAqB9G,EAEhC1G,SAAS,IAAK,yBAAdA,CAAwC0G,K,qFC1uBxCiH,EAAmC,oBAAVC,QAAyBA,OAAOD,iBAAmBC,OAAOD,gBAAgB5N,KAAK6N,SAA8B,oBAAZC,UAA8D,mBAA5BA,SAASF,iBAAiCE,SAASF,gBAAgB5N,KAAK8N,UACpOC,EAAQ,IAAIC,WAAW,IAEZ,SAASC,IACtB,IAAKL,EACH,MAAM,IAAI5D,MAAM,4GAGlB,OAAO4D,EAAgBG,GCPzB,IAFA,IAAIG,EAAY,GAEP,EAAI,EAAG,EAAI,MAAO,EACzBA,EAAU,IAAM,EAAI,KAAOC,SAAS,IAAIC,OAAO,GAGjD,SAASC,EAAYC,EAAKC,GACxB,IAAI9N,EAAI8N,GAAU,EACdC,EAAMN,EAEV,MAAO,CAACM,EAAIF,EAAI7N,MAAO+N,EAAIF,EAAI7N,MAAO+N,EAAIF,EAAI7N,MAAO+N,EAAIF,EAAI7N,MAAO,IAAK+N,EAAIF,EAAI7N,MAAO+N,EAAIF,EAAI7N,MAAO,IAAK+N,EAAIF,EAAI7N,MAAO+N,EAAIF,EAAI7N,MAAO,IAAK+N,EAAIF,EAAI7N,MAAO+N,EAAIF,EAAI7N,MAAO,IAAK+N,EAAIF,EAAI7N,MAAO+N,EAAIF,EAAI7N,MAAO+N,EAAIF,EAAI7N,MAAO+N,EAAIF,EAAI7N,MAAO+N,EAAIF,EAAI7N,MAAO+N,EAAIF,EAAI7N,OAAOgO,KAAK,IAGpQ,QCdf,SAASC,EAAGC,EAASL,EAAKC,GACxB,IAAI9N,EAAI6N,GAAOC,GAAU,EAEH,iBAAXI,IACTL,EAAkB,WAAZK,EAAuB,IAAIC,MAAM,IAAM,KAC7CD,EAAU,MAGZA,EAAUA,GAAW,GACrB,IAAIE,EAAOF,EAAQpI,SAAWoI,EAAQV,KAAOA,KAK7C,GAHAY,EAAK,GAAe,GAAVA,EAAK,GAAY,GAC3BA,EAAK,GAAe,GAAVA,EAAK,GAAY,IAEvBP,EACF,IAAK,IAAIQ,EAAK,EAAGA,EAAK,KAAMA,EAC1BR,EAAI7N,EAAIqO,GAAMD,EAAKC,GAIvB,OAAOR,GAAO,EAAYO,GAGb,Q,wBCzBf,MAAME,EAAS,SACTC,EAAQ,GACRC,EAAW,CAACC,EAAWC,EAAWJ,IAAWC,EAAMnI,eAAeqI,IAAcF,EAAME,GAAWrI,eAAesI,GAOhHC,EAAW,CAACF,EAAWG,EAAUF,EAAWJ,KACzCC,EAAMnI,eAAeqI,KACtBF,EAAME,GAAa,IAElBF,EAAME,GAAWrI,eAAesI,KACjCH,EAAME,GAAWC,GAAY,IAEjCH,EAAME,GAAWC,GAAUrL,KAAKuL,IAE9BC,EAAe,CAACJ,EAAWG,EAAUF,EAAWJ,KAClD,MAAMQ,EAAK,SAAUnL,GACjBoL,EAAWN,EAAWK,EAAIJ,GAC1BE,EAASjL,IAGb,OADAmL,EAAG/S,UAAUiT,UAAYJ,EAClBD,EAASF,EAAWK,EAAIJ,IAE7BK,EAAa,CAACN,EAAWG,EAAUF,EAAWJ,KAChD,IAAKE,EAASC,EAAWC,GACrB,OAAO,EAEX,GAAI,eAAWE,GAAW,CACtB,MAAMK,EAAMV,EAAME,GAAWC,GAAUzO,OACvC,IAAK,IAAID,EAAIiP,EAAM,EAAGjP,GAAK,EAAGA,IAAK,CAC/B,MAAMnF,EAAK0T,EAAME,GAAWC,GAAU1O,IAClC4O,IAAa/T,GAAOA,EAAGkB,WAAa6S,IAAa/T,EAAGkB,UAAUiT,YAC9DT,EAAME,GAAWC,GAAUQ,OAAOlP,EAAG,SAK7CuO,EAAME,GAAWC,GAAY,GAQjC,OAN0C,IAAtCH,EAAME,GAAWC,GAAUzO,gBACpBsO,EAAME,GAAWC,GACpB,eAASH,EAAME,YACRF,EAAME,KAGd,GAELU,EAAU,CAACV,EAAW9K,EAAM+K,EAAWJ,EAAQc,GAAoB,KACrE,MAAMC,EAAaD,GAAqBV,IAAaJ,EACrD,IAAKE,EAASC,EAAWC,GAIrB,OAHIW,GACAF,EAAQV,EAAW9K,IAEhB,EAEX,MAAMsL,EAAMV,EAAME,GAAWC,GAAUzO,OACvC,IAAKgP,EAID,OAHII,GACAF,EAAQV,EAAW9K,IAEhB,EAEX,IAAK,IAAI3D,EAAIiP,EAAM,EAAGjP,GAAK,EAAGA,IAC1BuO,EAAME,GAAWC,GAAU1O,GAAG2D,GAKlC,OAHI0L,GACAF,EAAQV,EAAW9K,IAEhB,GAEL2L,EAAiBb,WACZF,EAAME,ICtEjB,IAAIc,EAAsC,qBAAdC,UAA4BA,UAAY,KAC7D,MAGDC,EAAW,CACbC,WAAY,EACZC,KAAM,EACNC,QAAS,EACTC,OAAQ,GAENC,EAAa,IACJ,MAAM,EACjB,YAAYC,GACRhV,KAAKgV,QAAUA,EACfhV,KAAKiV,UAAY,KACjBjV,KAAKkV,MAAQ,6BACblV,KAAKmV,QAAU,GACfnV,KAAKoV,MAAQ,KACbpV,KAAKqV,QAAU,KACf,MAAM,KAAEpL,GAAS+K,EAAQ7B,QACrBlJ,IACAjK,KAAKkV,MAAQ,eAAmBjL,IAGxC,gBACI,OAAOjK,KAAKiV,WAAajV,KAAKiV,UAAUK,aAAeZ,EAASE,KAEpE,iBACI,OAAO5U,KAAKiV,WAAajV,KAAKiV,UAAUK,aAAeZ,EAASC,WAEpE,cACI,OAAO3U,KAAKiV,WAAajV,KAAKiV,UAAUK,aAAeZ,EAASG,QAEpE,aACI,OAAO7U,KAAKiV,WAAajV,KAAKiV,UAAUK,aAAeZ,EAASI,OAEpE,cACI,OAAO9U,KAAKuV,YAAcvV,KAAKwV,UAEnC,aACI,OAAOxV,KAAKyV,SAAWzV,KAAK0V,OAEhC,UACI1V,KAAKiV,UAAY,IAAIT,EAAexU,KAAKkV,OACzClV,KAAKiV,UAAUU,OAAUC,GAAUxB,EAAQ,OAAQyB,WAAYD,EAAO5V,KAAKgV,QAAQc,MACnF9V,KAAKiV,UAAUc,QAAWH,GAAUxB,EAAQ,OAAQ4B,YAAaJ,EAAO5V,KAAKgV,QAAQc,MACrF9V,KAAKiV,UAAUgB,QAAWL,GAAUxB,EAAQ,OAAQ8B,YAAaN,EAAO5V,KAAKgV,QAAQc,MACrF9V,KAAKiV,UAAUkB,UAAaP,IACxB,MAAMQ,EAAM,eAAcR,EAAMhN,MACb,kBAARwN,GAIXpW,KAAKqW,YAAYD,EAAIE,IACrB5O,EAAA,KAAOtC,MAAM,WAAYrC,KAAKC,UAAUoT,EAAK,KAAM,GAAI,MAClDhC,EAAQgC,EAAIE,GAAIF,IACjBhC,EAAQ,OAAQmC,cAAeH,EAAKpW,KAAKgV,QAAQc,OANjD9V,KAAKwW,sBAAsBJ,IAUvC,YAAYK,GACRzW,KAAKiV,UAAUyB,KAAKD,GAExB,KAAKE,GACD,MAAM,QAAEF,GAAYE,EACdC,EAAU,IAAIjX,QAAQ,CAACV,EAASC,KAClC,GAAIuX,EAAQpL,eAAe,UACvB,OAAOpM,IAEX6U,EAAa2C,EAAQH,GAAKlM,IACtB,MAAM,OAAE9H,EAAM,MAAE7C,GAAU,eAAiB2K,GAC3C,OAAO3K,EAAQP,EAAOO,GAASR,EAAQqD,KAE3CtC,KAAK6W,UAAUJ,EAAQH,MAI3B,OAFA5O,EAAA,KAAOtC,MAAM,WAAYrC,KAAKC,UAAUyT,EAAS,KAAM,GAAI,MAC3DzW,KAAKiV,UAAUyB,KAAK3T,KAAKC,UAAUyT,IAC5BG,EAEX,QACQ5W,KAAKiV,YACL,eAAWjV,KAAKiV,UAAU6B,aAAe9W,KAAKiV,UAAU6B,cAAgB9W,KAAKiV,UAAU8B,SAE3F/W,KAAKiV,UAAY,KAErB,YAAYqB,GACRU,aAAahX,KAAKmV,QAAQmB,WACnBtW,KAAKmV,QAAQmB,GAExB,UAAUA,GACNtW,KAAKmV,QAAQmB,GAAMW,WAAW,KAC1B7C,EAAQkC,EAAI,CAAE7W,MAAO,CAAE+K,KAAMxK,KAAKgV,QAAQkC,iBAAkBC,QAAS,aACrEnX,KAAKqW,YAAYC,IAClBvB,GAEP,sBAAsB3K,GAClB,GAAI,OAAOnG,KAAKmG,GACZ,OAAQA,EAAS,IACb,IAAK,IACDpK,KAAKoV,MAAQgC,SAAShN,EAASiN,UAAU,IACzC,MACJ,IAAK,IACDrX,KAAKqV,QAAU+B,SAAShN,EAASiN,UAAU,IAC3CjD,EAAQ,OAAQkD,UAAW,CAAElC,MAAOpV,KAAKoV,MAAOC,QAASrV,KAAKqV,SAAWrV,KAAKgV,QAAQc,MACtF,WAIRpO,EAAA,KAAO2B,KAAK,8BAA+Be,IChHvD,MAAM,EACF,aAAamN,GACTvX,KAAKyW,QAAUjO,OAAOgP,OAAO,CAAEC,QAAS,MAAOnB,GAAI,KAAYiB,IAGxD,QCLf,MAAMG,EAAQ,EACRC,EAAQ,EACRC,EAAW,EACjB,IAAIC,EAAQ,KACZ,MAAMC,EAAgBvW,IAClBsW,EAAQtW,GAEZ,MAAM,UAAgB,EAClB,YAAYwW,EAAgBC,GACxBC,QACAjY,KAAKuE,OAAS,gBACd,MAAMgT,EAAS,CACXW,QAAS,CAAER,QAAOC,QAAOC,YACzBG,eAAgBA,GAEhBC,IACAT,EAAOS,UAAYA,GAEnBH,IACAN,EAAOM,MAAQA,GAEnB7X,KAAKmY,aAAa,CAAE5T,OAAQvE,KAAKuE,OAAQgT,YCrBjD,MAAM,UAAgB,EAClB,YAAYA,EAAQjB,EAAK,IAGrB,IAAI8B,EAFJH,QACAjY,KAAKuE,OAAS,gBAGV6T,EADAb,EAAOlM,eAAe,UAChB,CAAE/I,OAAQiV,GAGV,CAAEhT,OAAQvE,KAAKuE,OAAQgT,UAE7BjB,IACA8B,EAAI9B,GAAKA,GAEbtW,KAAKmY,aAAaC,ICd1B,MAAM,UAAqB,EACvB,YAAYb,GACRU,QACAjY,KAAKuE,OAAS,qBACVgT,EAAOlM,eAAe,iBAAmBkM,EAAOc,oBACzCd,EAAOc,YAEdd,EAAOlM,eAAe,gBAAkBkM,EAAOe,mBACxCf,EAAOe,WAElBtY,KAAKmY,aAAa,CAAE5T,OAAQvE,KAAKuE,OAAQgT,YCVjD,MAAM,UAAuB,EACzB,YAAYgB,EAASC,EAAWR,GAC5BC,QACAjY,KAAKuE,OAAS,uBACd,MAAMgT,EAAS,CAAES,YAAWD,eAAgB,CAAEQ,UAASC,cACvDxY,KAAKmY,aAAa,CAAE5T,OAAQvE,KAAKuE,OAAQgT,YCLjD,MAAM,UAAa,EACf,cACIU,QACAjY,KAAKuE,OAAS,aACdvE,KAAKmY,aAAa,CAAE5T,OAAQvE,KAAKuE,OAAQgT,OAAQ,M,gBCLrD5V,EAAwC,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMxC,GAAS,OAAOA,aAAiBsC,EAAItC,EAAQ,IAAIsC,GAAE,SAAU7C,GAAWA,EAAQO,MAC/F,OAAO,IAAKsC,IAAMA,EAAInC,WAAU,SAAUV,EAASC,GAC/C,SAAS+C,EAAUzC,GAAS,IAAM0C,EAAKH,EAAUI,KAAK3C,IAAW,MAAO4C,GAAKlD,EAAOkD,IACpF,SAASC,EAAS7C,GAAS,IAAM0C,EAAKH,EAAU,SAASvC,IAAW,MAAO4C,GAAKlD,EAAOkD,IACvF,SAASF,EAAKI,GAAUA,EAAO5C,KAAOT,EAAQqD,EAAO9C,OAASwC,EAAMM,EAAO9C,OAAOI,KAAKqC,EAAWI,GAClGH,GAAMH,EAAYA,EAAU5B,MAAMyB,EAASC,GAAc,KAAKM,YAMtE,MAAMsW,EAAiB,aACjBC,EAAe,QACfC,EAAgB,gBACP,6CACX,MAAMpB,EAAS,IACT,UAAEqB,EAAS,cAAEC,GAAkB7D,EACrC,GAAI6D,GAAiBA,EAAcC,MAAM,KAAK,KAAOF,EACjDrB,EAAOrN,SAAW2O,MAEjB,CACD,MAAME,QAAqB,OAAelW,QAAQ+V,GAC9CG,IACAxB,EAAOrN,SAAW6O,GAG1B,MAAMC,EAAK,IAAI,EAAQ,CAAE9O,SAAUuO,EAAgBlU,OAAQmU,EAAcnB,YACnE,SAAErN,EAAW,YAAe8K,EAAQiE,QAAQD,GAQlD,OAPI9O,SACM8K,EAAQkE,UAAU,CAAEhP,WAAUiP,SAAU,CAACR,WACzC,OAAe1V,QAAQ2V,EAAW1O,IAGxCxC,EAAA,KAAOjI,MAAM,4CAEVyK,KCpCPkP,EAAkC,SAAUC,EAAGjX,GAC/C,IAAIkX,EAAI,GACR,IAAK,IAAIC,KAAKF,EAAO7Q,OAAOxH,UAAUqK,eAAelK,KAAKkY,EAAGE,IAAMnX,EAAEmE,QAAQgT,GAAK,IAC9ED,EAAEC,GAAKF,EAAEE,IACb,GAAS,MAALF,GAAqD,oBAAjC7Q,OAAOgR,sBACtB,KAAIvU,EAAI,EAAb,IAAgBsU,EAAI/Q,OAAOgR,sBAAsBH,GAAIpU,EAAIsU,EAAErU,OAAQD,IAC3D7C,EAAEmE,QAAQgT,EAAEtU,IAAM,GAAKuD,OAAOxH,UAAUyY,qBAAqBtY,KAAKkY,EAAGE,EAAEtU,MACvEqU,EAAEC,EAAEtU,IAAMoU,EAAEE,EAAEtU,KAE1B,OAAOqU,GAGX,MAAMI,EAAS,CACXpD,GAAI,SACJqD,kBAAmB,qBACnBC,iBAAkB,wBAClBC,mBAAoB,0BACpBC,WAAY,iBACZC,aAAc,oBAEH,MAAM,UAAoB,EACrC,YAAYxC,EAAS,IAEjB,GADAU,QACIV,EAAOlM,eAAe,gBAAiB,CACvC,MAAM2O,EAAKzC,EAAO0C,cAAc,UAAEC,EAAS,YAAEC,EAAW,aAAEC,EAAY,eAAEC,EAAc,MAAEC,EAAK,MAAEC,EAAK,UAAEC,GAAcR,EAAIC,EAAeb,EAAOY,EAAI,CAAC,YAAa,cAAe,eAAgB,iBAAkB,QAAS,QAAS,cACnO,IAAK,MAAM3a,KAAOqa,EACVra,GAAO4a,EAAa5O,eAAehM,KACnC4a,EAAaP,EAAOra,IAAQ4a,EAAa5a,UAClC4a,EAAa5a,IAG5BkY,EAAO0C,aAAeA,EAE1Bja,KAAKmY,aAAa,CAAE5T,OAAQvE,KAAK2S,WAAY4E,YChCrD,MAAM,UAAe,EACjB,YAAYjB,EAAI/R,GACZ0T,QACAjY,KAAKmY,aAAa,CAAE7B,KAAIhU,OAAQ,CAAEiC,aCJnC,IAAIkW,EAKAC,EAKAC,GATX,SAAWF,GACPA,EAAS,SAAW,QACpBA,EAAS,UAAY,UAFzB,CAGGA,IAAaA,EAAW,KAE3B,SAAWC,GACPA,EAAU,WAAa,UACvBA,EAAU,YAAc,WAF5B,CAGGA,IAAcA,EAAY,KAE7B,SAAWC,GACPA,EAAY,UAAY,eACxBA,EAAY,UAAY,eACxBA,EAAY,UAAY,eACxBA,EAAY,QAAU,aACtBA,EAAY,WAAa,gBACzBA,EAAY,SAAW,cACvBA,EAAY,SAAW,cACvBA,EAAY,OAAS,YACrBA,EAAY,QAAU,aACtBA,EAAY,aAAe,kBAC3BA,EAAY,aAAe,kBAC3BA,EAAY,eAAiB,oBAC7BA,EAAY,eAAiB,oBAC7BA,EAAY,UAAY,eAd5B,CAeGA,IAAgBA,EAAc,KAC1B,MAAMC,EAAoB,CAC7BC,QAAS,QACT,CAACF,EAAYG,SAAU,kBACvB,CAACH,EAAYI,QAAS,kBACtBC,iBAAkB,mBAClBC,WAAY,aACZC,iBAAkB,mBAClBC,eAAgB,iBAChBC,aAAc,gBAELC,EAAuB,CAChC1B,kBAAmB,GACnBC,iBAAkB,gBAClBC,mBAAoB,GACpBC,WAAY,GACZC,aAAc,GACduB,OAAO,EACPC,OAAO,EACPC,WAAW,EACXC,QAAQ,EACRC,aAAa,EACbC,cAAe,IAEZ,IAAIC,GAeAC,GAKAC,GAgBAC,IAnCX,SAAWH,GACPA,EAAMA,EAAM,OAAS,GAAK,MAC1BA,EAAMA,EAAM,cAAgB,GAAK,aACjCA,EAAMA,EAAM,UAAY,GAAK,SAC7BA,EAAMA,EAAM,cAAgB,GAAK,aACjCA,EAAMA,EAAM,WAAa,GAAK,UAC9BA,EAAMA,EAAM,aAAe,GAAK,YAChCA,EAAMA,EAAM,SAAW,GAAK,QAC5BA,EAAMA,EAAM,UAAY,GAAK,SAC7BA,EAAMA,EAAM,QAAU,GAAK,OAC3BA,EAAMA,EAAM,UAAY,GAAK,SAC7BA,EAAMA,EAAM,WAAa,IAAM,UAC/BA,EAAMA,EAAM,SAAW,IAAM,SAZjC,CAaGA,KAAUA,GAAQ,KAErB,SAAWC,GACPA,EAAK,eAAiB,cACtBA,EAAK,aAAe,YAFxB,CAGGA,KAASA,GAAO,KAEnB,SAAWC,GACPA,EAAiB,QAAU,OAC3BA,EAAiB,SAAW,QAC5BA,EAAiB,aAAe,YAChCA,EAAiB,OAAS,MAC1BA,EAAiB,UAAY,SAC7BA,EAAiB,UAAY,SAC7BA,EAAiB,SAAW,QAC5BA,EAAiB,eAAiB,cAClCA,EAAiB,aAAe,YAChCA,EAAiB,YAAc,WAC/BA,EAAiB,cAAgB,aACjCA,EAAiB,cAAgB,aACjCA,EAAiB,kBAAoB,qBAbzC,CAcGA,KAAqBA,GAAmB,KAE3C,SAAWC,GACPA,EAAW,SAAW,aACtBA,EAAW,WAAa,aACxBA,EAAW,YAAc,cAH7B,CAIGA,KAAeA,GAAa,KCvF/B,MAAM,WAAe,EACjB,WACI,OAAOpB,EAAYqB,QAG3B,MAAM,WAAe,EACjB,WACI,OAAOrB,EAAYsB,QAG3B,MAAM,WAAe,EACjB,WACI,OAAOtB,EAAYI,QAG3B,MAAM,WAAY,EACd,WACI,OAAOJ,EAAYuB,KAG3B,MAAM,WAAe,EACjB,WACI,OAAOvB,EAAYwB,QAG3B,MAAM,WAAa,EACf,WACI,OAAOxB,EAAYyB,MAG3B,MAAM,WAAkB,EACpB,WACI,OAAOzB,EAAY0B,WAG3B,MAAM,WAAkB,EACpB,WACI,OAAO1B,EAAY2B,WAG3B,MAAM,WAAoB,EACtB,WACI,OAAO3B,EAAY4B,aC9C3B,IAAI,GAAwC,SAAU3a,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMxC,GAAS,OAAOA,aAAiBsC,EAAItC,EAAQ,IAAIsC,GAAE,SAAU7C,GAAWA,EAAQO,MAC/F,OAAO,IAAKsC,IAAMA,EAAInC,WAAU,SAAUV,EAASC,GAC/C,SAAS+C,EAAUzC,GAAS,IAAM0C,EAAKH,EAAUI,KAAK3C,IAAW,MAAO4C,GAAKlD,EAAOkD,IACpF,SAASC,EAAS7C,GAAS,IAAM0C,EAAKH,EAAU,SAASvC,IAAW,MAAO4C,GAAKlD,EAAOkD,IACvF,SAASF,EAAKI,GAAUA,EAAO5C,KAAOT,EAAQqD,EAAO9C,OAASwC,EAAMM,EAAO9C,OAAOI,KAAKqC,EAAWI,GAClGH,GAAMH,EAAYA,EAAU5B,MAAMyB,EAASC,GAAc,KAAKM,YAItE,MAAMqa,GAAqBC,GAAW,IAAIja,OAAOga,kBAAkBC,GAC7DC,GAAgBC,GAAgB3Y,UAAU4Y,aAAaF,aAAaC,GACpEE,GAAmBF,GAAgB3Y,UAAU4Y,aAAaC,gBAAgBF,GAC1EG,GAAmB,IAAM9Y,UAAU4Y,aAAaE,mBAChDC,GAA0B,IAAM/Y,UAAU4Y,aAAaG,0BACvDC,GAAiBC,GAAWA,GAAUA,aAAkBC,YACxDC,GAAoB,CAACvT,EAAKqT,KAC5B,MAAMG,EAAU,eAAkBxT,GAClB,OAAZwT,IAGCA,EAAQC,aAAa,aACtBD,EAAQE,aAAa,WAAY,YAEhCF,EAAQC,aAAa,gBACtBD,EAAQE,aAAa,cAAe,eAExCF,EAAQG,UAAYN,IAElBO,GAAqB5T,IACvB,MAAMwT,EAAU,eAAkBxT,GAC9BwT,IACAA,EAAQG,UAAY,OAGtBE,GAAoB7T,IACtB,MAAMwT,EAAU,eAAkBxT,GAC9BwT,IACAA,EAAQM,OAAQ,IAelBC,GAAwB,CAAC/T,EAAKgU,IAAa,QAAU,OAAQ,OAAQ,GAAQ,YAC/E,MAAMR,EAAU,eAAkBxT,GAClC,GAAgB,OAAZwT,EACA,OAAO,EAEX,IAEI,aADMA,EAAQS,UAAUD,IACjB,EAEX,MAAOne,GACH,OAAO,MAGTqe,GAAgBC,GAAOA,EACvBC,GAAcf,IACZD,GAAcC,IACdA,EAAOgB,YAAYpQ,QAAQyL,GAAKA,EAAEpI,QAEtC+L,EAAS,MCvEb,IAAI,GAAwC,SAAUrb,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMxC,GAAS,OAAOA,aAAiBsC,EAAItC,EAAQ,IAAIsC,GAAE,SAAU7C,GAAWA,EAAQO,MAC/F,OAAO,IAAKsC,IAAMA,EAAInC,WAAU,SAAUV,EAASC,GAC/C,SAAS+C,EAAUzC,GAAS,IAAM0C,EAAKH,EAAUI,KAAK3C,IAAW,MAAO4C,GAAKlD,EAAOkD,IACpF,SAASC,EAAS7C,GAAS,IAAM0C,EAAKH,EAAU,SAASvC,IAAW,MAAO4C,GAAKlD,EAAOkD,IACvF,SAASF,EAAKI,GAAUA,EAAO5C,KAAOT,EAAQqD,EAAO9C,OAASwC,EAAMM,EAAO9C,OAAOI,KAAKqC,EAAWI,GAClGH,GAAMH,EAAYA,EAAU5B,MAAMyB,EAASC,GAAc,KAAKM,YAOtE,MAAM,GAAgBwa,GAAgB,QAAU,OAAQ,OAAQ,GAAQ,YACpEjV,EAAA,KAAOnI,KAAK,0BAA2Bod,GACvC,MAAM,MAAErB,EAAK,MAAEC,GAAUoB,EACzB,IAAKrB,IAAUC,EACX,OAAO,KAEX,IACI,aAAa,GAAoBoB,GAErC,MAAOld,GAEH,MADAiI,EAAA,KAAOjI,MAAM,uBAAwBA,GAC/BA,MAGRye,GAAqB,CAACC,EAAO,QACxB,CACH7C,OAAQ6C,GAAQA,IAASpC,GAAWqC,QACpC7C,OAAQ4C,GAAQA,IAASpC,GAAWsC,QAGtCC,GAAa,CAACH,EAAO,KAAMI,GAAW,IAAU,QAAU,OAAQ,OAAQ,GAAQ,YACpF,IAAIC,QAAgB,KAA0BC,MAAMhf,GAAS,IACzD0e,IACAK,EAAUA,EAAQE,OAAQC,GAAMA,EAAER,OAASA,IAE/C,MAAMS,EAAQJ,EAAQtZ,QAAUsZ,EAAQK,MAAOF,GAAOA,EAAEf,UAAYe,EAAEG,OACtE,IAAKF,EAAO,CACR,MAAM3B,QAAe,GAAoBiB,GAAmBC,IAE5D,OADA,GAAkBlB,GACXqB,GAAWH,GAEtB,IAAiB,IAAbI,EACA,OAAOC,EAEX,MAAMO,EAAQ,GAYd,OAXAP,EAAUA,EAAQE,OAAO,EAAGP,OAAMa,cAC9B,IAAKA,EACD,OAAO,EAEX,MAAM3f,EAAM,GAAG8e,KAAQa,IACvB,OAAKD,EAAME,SAAS5f,KAChB0f,EAAMzW,KAAKjJ,IACJ,KAIRmf,KAELU,GAAiB,CAAC,CAAC,IAAK,KAAM,CAAC,IAAK,KAAM,CAAC,IAAK,KAAM,CAAC,KAAM,KAAM,CAAC,KAAM,OAC1EC,GAAmBvB,GAAa,QAAU,OAAQ,OAAQ,GAAQ,YACpE,MAAMwB,EAAY,GACZnC,QAAe,GAAa,CAAE1B,MAAO,CAAEqC,SAAU,CAAEyB,MAAOzB,MAC1D0B,EAAarC,EAAOsC,iBAAiB,GAC3C,IAAK,IAAIta,EAAI,EAAGA,EAAIia,GAAeha,OAAQD,IAAK,CAC5C,MAAOua,EAAOC,GAAUP,GAAeja,GACjCya,QAAgBJ,EAAWK,iBAAiB,CAAEH,MAAO,CAAEH,MAAOG,GAASC,OAAQ,CAAEJ,MAAOI,KACzF7f,KAAK,KAAM,GACX6e,MAAM,KAAM,GACbiB,GACAN,EAAU9W,KAAK,CAAEsX,WAAY,GAAGJ,KAASC,IAAUD,QAAOC,WAIlE,OADA,GAAkBxC,GACXmC,KAELS,GAAuB1M,GAAY,QAAU,OAAQ,OAAQ,GAAQ,YACvE,IAAI,MAAEmI,GAAQ,EAAI,MAAEf,GAAUpH,EAC9B,MAAM,SAAE2M,EAAW,IAAO3M,EACtBoH,IACAA,QAAcwF,GAAexF,EAAOuF,EAAU/D,GAAWqC,SAASK,MAAMhf,GAAS,MAC7E8a,IACqB,mBAAVe,IACPA,EAAQ,IAEZA,EAAMsC,SAAW,CAAEyB,MAAO9E,KAGlC,IAAI,MAAEgB,GAAQ,EAAK,MAAEjB,GAAUnH,EAC/B,MAAM,SAAE6M,EAAW,IAAO7M,EAU1B,OATImH,IACAA,QAAcyF,GAAezF,EAAO0F,EAAUjE,GAAWsC,OAAOI,MAAMhf,GAAS,MAC3E6a,IACqB,mBAAViB,IACPA,EAAQ,IAEZA,EAAMqC,SAAW,CAAEyB,MAAO/E,KAG3B,CAAEgB,QAAOC,YAEdwE,GAAiB,CAACzJ,EAAIwI,EAAOX,IAAS,QAAU,OAAQ,OAAQ,GAAQ,YAC1E,MAAMK,QAAgBF,GAAWH,GAAM,GACvC,IAAK,IAAIlZ,EAAI,EAAGA,EAAIuZ,EAAQtZ,OAAQD,IAAK,CACrC,MAAM,SAAE2Y,EAAUkB,MAAOmB,GAAgBzB,EAAQvZ,GACjD,GAAIqR,IAAOsH,GAAYkB,IAAUmB,EAC7B,OAAOrC,EAGf,OAAO,QAELsC,GAAgCvD,IAClC,MAAMyC,EAAY,KAClB5W,OAAOC,KAAKkU,GAAawD,IAAI9gB,IACpB+f,EAAU/T,eAAehM,IAA6B,OAArBsd,EAAYtd,SAAsCgB,IAArBsc,EAAYtd,WACpEsd,EAAYtd,MAIzB+gB,GAA2B,CAAC9J,EAAIwI,EAAOX,EAAMxB,IAAgB,QAAU,OAAQ,OAAQ,GAAQ,YACjG,MAAM,SAAEiB,GAAajB,EACrB,IAAK,eAAUiB,KAActH,GAAMwI,GAAQ,CACvC,MAAMlB,QAAiBmC,GAAezJ,EAAIwI,EAAOX,GAAMM,MAAMhf,GAAS,MAClEme,IACAjB,EAAYiB,SAAW,CAAEyB,MAAOzB,IAGxC,OAAOjB,KAEL0D,GAAiBtC,IACnB,MAAMuC,EAAY,OACZC,EAAWxC,EAAIjF,MAAMwH,GACrBE,EAAYD,EAASE,UAAUpH,GAAK,YAAYpV,KAAKoV,IAAM,cAAcpV,KAAKoV,IACpF,GAAImH,EAAY,EACZ,OAAOzC,EAEX,MAAM2C,EAAuBC,IACzB,MAAMlf,EAAU,IAAIV,OAAO,+BACrBuB,EAASqe,EAAKC,MAAMnf,GAC1B,OAAOa,GAA2B,GAAjBA,EAAO4C,OAAc5C,EAAO,GAAK,MAEhDue,EAAcH,EAAoBH,EAASC,IAC3C/e,EAAU,IAAIV,OAAO,UAAU8f,GAC/BC,EAAgBP,EAASE,UAAUpH,GAAK5X,EAAQwC,KAAKoV,IAS3D,OARIyH,GAAiB,EACZ,YAAY7c,KAAKsc,EAASO,MAC3BP,EAASO,IAAkB,8BAI/BP,EAASC,IAAc,GAAGF,WAAmBO,6BAE1CN,EAAStN,KAAKqN,IAEnBS,GAAgBJ,GAAS,WAAW1c,KAAK0c,GACzCK,GAAgBL,GAAS,WAAW1c,KAAK0c,GACzCM,GAAoB,CAACC,EAAQC,KAC/B,MAAMb,EAAY,OACZc,EAAaD,EAAWrI,MAAMwH,GAC9Be,EAAkBD,EAAWX,UAAUM,IACvCO,EAAkBF,EAAWX,UAAUO,IAC7C,GAAIK,EAAkBC,EAClB,OAAOJ,EAEX,MAAMK,EAAcL,EAAOpI,MAAMwH,GAC3BkB,EAAmBD,EAAYd,UAAUM,IACzCU,EAAmBF,EAAYd,UAAUO,IACzCU,EAAaH,EAAY9a,MAAM+a,EAAkBC,GACjDE,EAAaJ,EAAY9a,MAAMgb,EAAmBF,EAAYrc,OAAS,GACvE0c,EAAaL,EAAY9a,MAAM,EAAG+a,GACxC,MAAO,IAAII,KAAeD,KAAeD,EAAY,IAAIzO,KAAKqN,IAE5DuB,GAAyB,CAACzX,EAAU0X,KACtC,IAAK1X,EACD,OAAO,EAEX,MAAM,WAAE2X,EAAU,kBAAEC,GAAsBC,GAA0B7X,GACpE,OAAO2X,EAAW9C,SAAS6C,IAAYE,EAAkB/C,SAAS6C,IAEhEG,GAA6B7X,IAC/B,MAAMgO,EAAM,CACR2J,WAAY,GACZC,kBAAmB,GACnBE,aAAc,GACdC,aAAc,GACdC,cAAe,IAGnB,OADA5Z,OAAOC,KAAK2P,GAAKvK,QAAQwU,IAAOjK,EAAIiK,GAAKjY,EAAYiY,EAAH,aAAmB,KAC9DjK,GAELkK,GAAqBrF,IACvBsF,GAAyBtF,EAAQ,SAAS,IAExCuF,GAAsBvF,IACxBsF,GAAyBtF,EAAQ,SAAS,IAExCwF,GAAqBxF,IACvBsF,GAAyBtF,EAAQ,QAAS,OAExCyF,GAAqBzF,IACvBsF,GAAyBtF,EAAQ,SAAS,IAExC0F,GAAsB1F,IACxBsF,GAAyBtF,EAAQ,SAAS,IAExC2F,GAAqB3F,IACvBsF,GAAyBtF,EAAQ,QAAS,OAExCsF,GAA2B,CAACtF,EAAQkB,EAAO,KAAM0E,EAAU,QAC7D,IAAK,GAAqB5F,GACtB,OAAO,KAEX,IAAI6F,EAAS,GACb,OAAQ3E,GACJ,IAAK,QACD2E,EAAS7F,EAAO8F,iBAChB,MACJ,IAAK,QACDD,EAAS7F,EAAOsC,iBAChB,MACJ,QACIuD,EAAS7F,EAAOgB,YAChB,MAER6E,EAAOjV,QAASmV,IACZ,OAAQH,GACJ,IAAK,KACL,KAAK,EACDG,EAAMH,SAAU,EAChB,MACJ,IAAK,MACL,KAAK,EACDG,EAAMH,SAAU,EAChB,MACJ,QACIG,EAAMH,SAAWG,EAAMH,QACvB,UAIVI,GAAiB,CAAClF,EAAKnT,EAAKD,EAAKuY,KACnC,MAAM5C,EAAY,OACZ6C,EAAQpF,EAAIjF,MAAMwH,GASxB,OARA6C,EAAMtV,QAAQ,CAAC8S,EAAM1b,KACb,cAAchB,KAAK0c,GACnBwC,EAAMle,IAAM,yBAAyB2F,0BAA4BD,4BAA8BuY,IAE1F,mBAAmBjf,KAAK0c,KAC7BwC,EAAMle,IAAM,YAAY2F,KAGzBuY,EAAMlQ,KAAKqN,IC7PtB,IAAI,GAAwC,SAAU1e,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMxC,GAAS,OAAOA,aAAiBsC,EAAItC,EAAQ,IAAIsC,GAAE,SAAU7C,GAAWA,EAAQO,MAC/F,OAAO,IAAKsC,IAAMA,EAAInC,WAAU,SAAUV,EAASC,GAC/C,SAAS+C,EAAUzC,GAAS,IAAM0C,EAAKH,EAAUI,KAAK3C,IAAW,MAAO4C,GAAKlD,EAAOkD,IACpF,SAASC,EAAS7C,GAAS,IAAM0C,EAAKH,EAAU,SAASvC,IAAW,MAAO4C,GAAKlD,EAAOkD,IACvF,SAASF,EAAKI,GAAUA,EAAO5C,KAAOT,EAAQqD,EAAO9C,OAASwC,EAAMM,EAAO9C,OAAOI,KAAKqC,EAAWI,GAClGH,GAAMH,EAAYA,EAAU5B,MAAMyB,EAASC,GAAc,KAAKM,YAUvD,MAAM,GACjB,YAAY2K,EAAMqG,GACdnT,KAAK8M,KAAOA,EACZ9M,KAAKmT,QAAUA,EACfnT,KAAKojB,gBAAkB,KACvBpjB,KAAKqjB,cAAe,EACpB3b,EAAA,KAAOnI,KAAK,sBAAuBS,KAAK8M,KAAM,WAAY9M,KAAKmT,SAC/DnT,KAAKsjB,aAAe,CAAEC,qBAAqB,EAAMC,qBAAqB,GACtExjB,KAAKyjB,UAAYzjB,KAAKyjB,UAAUjf,KAAKxE,MACrCA,KAAK0jB,QAET,mBACI1jB,KAAKqjB,cAAe,EAChBrjB,KAAK2jB,WACL3jB,KAAK4jB,eAGL5jB,KAAK6jB,gBAGb,QACI,OAAO,GAAU7jB,UAAM,OAAQ,GAAQ,YACnCA,KAAK8jB,SAAWtH,GAAkBxc,KAAK+jB,WACvC/jB,KAAK8jB,SAASE,uBAAyBpO,IACnC,OAAQ5V,KAAK8jB,SAASG,gBAClB,IAAK,SACDjkB,KAAKqjB,cAAe,EACpB,MACJ,IAAK,SACDrjB,KAAK8jB,SAAW,KAChB,MACJ,QACI9jB,KAAKqjB,cAAe,IAGhCrjB,KAAK8jB,SAASI,oBAAsBtO,IAC5B5V,KAAKqjB,aACL3b,EAAA,KAAOtC,MAAM,oCAGjBpF,KAAKmkB,oBAETnkB,KAAKmT,QAAQgH,kBAAoBna,KAAKokB,uBACjC3F,MAAMhf,IACP2U,EAAQ,OAAQiQ,WAAY5kB,EAAOO,KAAKmT,QAAQmD,IACzC,OAEX,MAAM,aAAEgO,EAAY,YAAEnK,EAAc,KAAI,YAAEuB,GAAc,GAAU1b,KAAKmT,QACnE6J,GAAc7C,IACwB,oBAA3Bna,KAAK8jB,SAASS,SACrBpK,EAAY8D,YAAYpQ,QAAQyL,GAAKtZ,KAAK8jB,SAASS,SAASjL,EAAGa,IAG/Dna,KAAK8jB,SAASU,UAAUrK,IAER,IAAhBuB,IACA+B,GAAiB6G,GACjBnH,GAAkBmH,EAAcnK,KAGf,OAAhBA,GACLna,KAAKmkB,sBAIjB,eACSnkB,KAAK2jB,YAGV3jB,KAAK8jB,SAASW,YAAYzkB,KAAKsjB,cAC1B1jB,KAAKI,KAAK0kB,qBAAqBlgB,KAAKxE,OACpCJ,KAAKI,KAAKyjB,WACVhF,MAAMhf,GAASiI,EAAA,KAAOjI,MAAM,2BAA4BA,IAEjE,gBACI,IAAKO,KAAK2kB,YACN,OAEJ,MAAM,UAAEzK,EAAS,UAAEsB,GAAcxb,KAAKmT,QAChC4K,EAAMvC,EAAY6E,GAAcnG,GAAaA,EAC7C0K,EAAe9G,GAAc,CAAEC,MAAKjR,KAAM2N,EAASoK,QACzD7kB,KAAK8jB,SAASgB,qBAAqBF,GAC9BhlB,KAAK,IAAMI,KAAK8jB,SAASiB,gBACzBnlB,KAAKI,KAAK0kB,qBAAqBlgB,KAAKxE,OACpCJ,KAAKI,KAAKyjB,WACVhF,MAAMhf,GAASiI,EAAA,KAAOjI,MAAM,4BAA6BA,IAElE,qBAAqBulB,GACjB,MAAM,UAAExJ,EAAS,iBAAEyJ,EAAgB,iBAAEC,EAAgB,mBAAEC,GAAuBnlB,KAAKmT,QAOnF,OANIqI,IACAwJ,EAAmBjH,IAAMsC,GAAc2E,EAAmBjH,MAE1DkH,GAAoBC,GAAoBC,IACxCH,EAAmBjH,IAAMkF,GAAe+B,EAAmBjH,IAAKkH,EAAkBC,EAAkBC,IAEjGnlB,KAAK8jB,SAASsB,oBAAoBJ,GAE7C,YACQ,eAAWhlB,KAAKojB,kBAChBpjB,KAAKojB,gBAAgBpjB,KAAK8jB,SAASuB,kBAG3C,uBACI,OAAO,GAAUrlB,UAAM,OAAQ,GAAQ,YACnC,GAAIgd,GAAchd,KAAKmT,QAAQgH,aAC3B,OAAOna,KAAKmT,QAAQgH,YAExB,MAAMwC,QAAoBkD,GAAoB7f,KAAKmT,SACnD,OAAO,GAAawJ,MAG5B,WACI,OAAO3c,KAAK8M,OAAS2N,EAASoK,MAElC,YACI,OAAO7kB,KAAK8M,OAAS2N,EAASwB,OAElC,UACI,MAAM,WAAEqJ,EAAa,IAAOtlB,KAAKmT,QAC3BsJ,EAAS,CAAE8I,aAAc,eAAgBC,aAAc,aAAcF,cAE3E,OADA5d,EAAA,KAAOnI,KAAK,aAAckd,GACnBA,GCrIf,MAAMgJ,GAAwB,CAACzQ,EAAS0Q,KACpC,MAAM,YAAEC,EAAW,WAAEC,EAAU,OAAEC,EAAM,WAAEC,EAAa,KAAI,gBAAEC,GAAkB,GAAOL,EACjFI,GAA6B,wBAAfF,UACPE,EAAWE,SAEtB,MAAMpd,EAAO,CACTkE,KAAM8N,EAAkBI,iBACxB7Z,KAAM6T,EAAQiR,MAAMJ,GACpBC,WAAYI,GAAiBJ,GAC7BC,mBAEJ,OAAQJ,GACJ,IAAK,aAAc,CACf,MAAMQ,EAAe3d,OAAOgP,OAAO,CAAE4O,OAAQtK,GAAiBuK,WAAazd,GAC3EwL,EAAQ,OAAQkS,aAAcH,EAAcnR,EAAQc,MACpD,MAEJ,IAAK,cAAe,CAChB,MAAMqQ,EAAe3d,OAAOgP,OAAO,CAAE4O,OAAQtK,GAAiByK,YAAc3d,GAC5EwL,EAAQ,OAAQkS,aAAcH,EAAcnR,EAAQc,MACpD,SAINoQ,GAAoBJ,IACtB,MAAM1N,EAAMrV,KAAKC,UAAU8iB,GACtB7d,QAAQ,YAAa,iBACrBA,QAAQ,OAAQ,OAChBA,QAAQ,QAAS,QACtB,OAAO,eAAcmQ,ICjCzB,IAAI,GAAwC,SAAUxW,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMxC,GAAS,OAAOA,aAAiBsC,EAAItC,EAAQ,IAAIsC,GAAE,SAAU7C,GAAWA,EAAQO,MAC/F,OAAO,IAAKsC,IAAMA,EAAInC,WAAU,SAAUV,EAASC,GAC/C,SAAS+C,EAAUzC,GAAS,IAAM0C,EAAKH,EAAUI,KAAK3C,IAAW,MAAO4C,GAAKlD,EAAOkD,IACpF,SAASC,EAAS7C,GAAS,IAAM0C,EAAKH,EAAU,SAASvC,IAAW,MAAO4C,GAAKlD,EAAOkD,IACvF,SAASF,EAAKI,GAAUA,EAAO5C,KAAOT,EAAQqD,EAAO9C,OAASwC,EAAMM,EAAO9C,OAAOI,KAAKqC,EAAWI,GAClGH,GAAMH,EAAYA,EAAU5B,MAAMyB,EAASC,GAAc,KAAKM,YAcvD,MAAM,GACjB,YAAY6S,EAASwR,GACjBxmB,KAAKgV,QAAUA,EACfhV,KAAKsW,GAAK,GACVtW,KAAKuO,MAAQqN,GAAMA,GAAM6K,KACzBzmB,KAAK0mB,UAAY,GACjB1mB,KAAKmZ,SAAW,GAChBnZ,KAAK2mB,KAAO9K,GAAK+K,YACjB5mB,KAAK6mB,UAAY,KACjB7mB,KAAK8mB,OAASlL,GAAM6K,IACpBzmB,KAAK+mB,WAAanL,GAAM6K,IACxBzmB,KAAKgnB,WAAY,EACjBhnB,KAAKinB,UAAW,EAChBjnB,KAAKknB,WAAa,EAClBlnB,KAAKmnB,cAAgB,KACrBnnB,KAAKonB,YAAc,KACnBpnB,KAAKqnB,UAAW,EAChBrnB,KAAKsnB,sBAAyBC,IAC1B,MAAMC,EAASD,EAAQ,IAAQvnB,KAAKknB,YAAelnB,KAAKknB,YAAcK,IAAWvnB,KAAKknB,WAAa,EAInG,OAHIM,GAASD,GAAS,IAClBvnB,KAAKknB,WAAaK,GAEfC,GAEX,MAAM,WAAElC,EAAYmC,QAASjN,EAAS,MAAED,EAAK,SAAEuF,EAAQ,MAAExF,EAAK,SAAE0F,EAAQ,aAAEsE,EAAY,cAAEoD,EAAeC,kBAAkB,MAAErM,EAAK,MAAEC,IAAYvG,EAC9IhV,KAAKmT,QAAU3K,OAAOgP,OAAO,GAAI6D,EAAsB,CAAEC,QAAOC,QAAO+J,aAAYhB,eAAcoD,gBAAenN,QAAOuF,WAAUxF,QAAO0F,WAAUxF,aAAagM,GAC/JxmB,KAAK4nB,cAAgB5nB,KAAK4nB,cAAcpjB,KAAKxE,MAC7CA,KAAK0jB,QAET,aACI,OAAO1jB,KAAKmnB,cAEhB,WAAWU,GACP7nB,KAAKmnB,cAAgBU,EAEzB,kBACI,OAAO7nB,KAAKmT,QAAQgH,YAExB,mBACI,OAAOna,KAAKmT,QAAQiH,aAExB,oBACI,MAAO,qBAAqBpa,KAAKsW,GAErC,SACItW,KAAK8nB,UAAYpN,EAAUqN,SAC3B/nB,KAAKgoB,KAAO,IAAI,GAAKvN,EAASoK,MAAO7kB,KAAKmT,SAC1CnT,KAAKioB,sBAET,SACIjoB,KAAK8nB,UAAYpN,EAAUwN,QAC3BloB,KAAKgoB,KAAO,IAAI,GAAKvN,EAASwB,OAAQjc,KAAKmT,SAC3CnT,KAAKioB,sBAET,OAAO1Q,EAAS,GAAI0B,GAAU,GAC1BjZ,KAAKmoB,MAAQ5Q,EAAO4Q,OAAS,kBAC7BnoB,KAAKooB,UAAY7Q,EAAO6Q,WAAa,GACrCpoB,KAAKqoB,SAASzM,GAAM0M,QACpB,MAAMC,EAAS,KACXvoB,KAAKgoB,MAAOhoB,KAAKgoB,KAAKlE,SAAS/M,QAC/B/W,KAAKqoB,SAASzM,GAAM4M,UAExB,GAAIvP,EAAS,CACT,MAAMwP,EAAM,IAAI,GAAI,CAAEC,OAAQ1oB,KAAKgV,QAAQgD,UAAWiC,aAAcja,KAAKmT,UACzEnT,KAAK2oB,SAASF,GACThK,MAAMhf,GAASiI,EAAA,KAAOjI,MAAM,oBAAqBA,IACjDG,KAAK2oB,EAAO/jB,KAAKxE,YAGtBuoB,IAGR,SAASK,GACL,MAAMxS,EAAM,IAAI,GAAO,CAAEsS,OAAQ1oB,KAAKgV,QAAQgD,UAAWoO,OAAQ,WAAYwC,cAAa3O,aAAcja,KAAKmT,UAC7GnT,KAAK2oB,SAASvS,GAElB,QAAQyS,GACJ,MAAMzS,EAAM,IAAI,GAAO,CAAEsS,OAAQ1oB,KAAKgV,QAAQgD,UAAWoO,OAAQ,UAAWyC,gBAAe5O,aAAcja,KAAKmT,UAC9GnT,KAAK2oB,SAASvS,GAElB,OACI,MAAMA,EAAM,IAAI,GAAO,CAAEsS,OAAQ1oB,KAAKgV,QAAQgD,UAAWoO,OAAQ,OAAQnM,aAAcja,KAAKmT,UAC5F,OAAOnT,KAAK2oB,SAASvS,GAChBxW,KAAKI,KAAK8oB,8BAA8BtkB,KAAKxE,OAC7Cye,MAAMze,KAAK+oB,4BAA4BvkB,KAAKxE,OAErD,SACI,MAAMoW,EAAM,IAAI,GAAO,CAAEsS,OAAQ1oB,KAAKgV,QAAQgD,UAAWoO,OAAQ,SAAUnM,aAAcja,KAAKmT,UAC9F,OAAOnT,KAAK2oB,SAASvS,GAChBxW,KAAKI,KAAK8oB,8BAA8BtkB,KAAKxE,OAC7Cye,MAAMze,KAAK+oB,4BAA4BvkB,KAAKxE,OAErD,aACI,MAAMoW,EAAM,IAAI,GAAO,CAAEsS,OAAQ1oB,KAAKgV,QAAQgD,UAAWoO,OAAQ,aAAcnM,aAAcja,KAAKmT,UAClG,OAAOnT,KAAK2oB,SAASvS,GAChBxW,KAAKI,KAAK8oB,8BAA8BtkB,KAAKxE,OAC7Cye,MAAMze,KAAK+oB,4BAA4BvkB,KAAKxE,OAErD,KAAKgpB,GACD,MAAM5S,EAAM,IAAI,GAAK,CAAEsS,OAAQ1oB,KAAKgV,QAAQgD,UAAWgR,OAAM/O,aAAcja,KAAKmT,UAChFnT,KAAK2oB,SAASvS,GAElB,QAAQ6S,EAAIC,GACR,MAAM9S,EAAM,CAAE+S,KAAMnpB,KAAKgV,QAAQ7B,QAAQiW,MAAOH,KAAIC,QAC9C3pB,EAAO,IAAI,GAAK,CAAEmpB,OAAQ1oB,KAAKgV,QAAQgD,UAAW5B,MAAK6D,aAAcja,KAAKmT,UAChFnT,KAAK2oB,SAASppB,GAElB,YACIijB,GAAmBxiB,KAAKmT,QAAQgH,aAEpC,cACImI,GAAkBtiB,KAAKmT,QAAQgH,aAEnC,kBACIsI,GAAkBziB,KAAKmT,QAAQgH,aAEnC,iBAAiByD,GACb,OAAO,GAAU5d,UAAM,OAAQ,GAAQ,YACnC,MAAM,SAAE8jB,GAAa9jB,KAAKgoB,KACpBqB,EAASvF,EAASwF,aAAaC,KAAK,EAAGvG,OAAS7E,WAAsB,UAATA,GACnE,GAAIkL,EAAQ,CACR,MAAMG,QAAkB9M,GAAa,CAAEpB,MAAO,CAAEsC,SAAU,CAAEyB,MAAOzB,MAC7D6L,EAAaD,EAAUzG,iBAAiB,GAC9CsG,EAAOK,aAAaD,GACpBzpB,KAAKmT,QAAQoH,MAAQqD,EACrB,MAAM,YAAEzD,GAAgBna,KAAKmT,QAC7BgH,EAAY4I,iBAAiBlV,QAAQyL,GAAKA,EAAEpI,QAC5CiJ,EAAYoF,iBAAiB1R,QAAQyL,GAAKkQ,EAAUjF,SAASjL,IAC7DtZ,KAAKmT,QAAQgH,YAAcqP,MAIvC,YACI7G,GAAmB3iB,KAAKmT,QAAQgH,aAEpC,cACIuI,GAAkB1iB,KAAKmT,QAAQgH,aAEnC,kBACIyI,GAAkB5iB,KAAKmT,QAAQgH,aAEnC,eAAeyD,GACX,OAAO,GAAU5d,UAAM,OAAQ,GAAQ,YACnC,MAAM,SAAE8jB,GAAa9jB,KAAKgoB,KACpBqB,EAASvF,EAASwF,aAAaC,KAAK,EAAGvG,OAAS7E,WAAsB,UAATA,GACnE,GAAIkL,EAAQ,CACR,MAAMG,QAAkB9M,GAAa,CAAEnB,MAAO,CAAEqC,SAAU,CAAEyB,MAAOzB,MAC7D0B,EAAakK,EAAUjK,iBAAiB,GAC9C8J,EAAOK,aAAapK,GACpB,MAAM,aAAEgF,EAAY,YAAEnK,GAAgBna,KAAKmT,QAC3CgK,GAAkBmH,EAAckF,GAChCxpB,KAAKmT,QAAQmH,MAAQsD,EACrBzD,EAAY4I,iBAAiBlV,QAAQyL,GAAKkQ,EAAUjF,SAASjL,IAC7Da,EAAYoF,iBAAiB1R,QAAQyL,GAAKA,EAAEpI,QAC5ClR,KAAKmT,QAAQgH,YAAcqP,MAIvC,OACIhH,GAAmBxiB,KAAKmT,QAAQiH,cAEpC,SACIkI,GAAkBtiB,KAAKmT,QAAQiH,cAEnC,aACIqI,GAAkBziB,KAAKmT,QAAQiH,cAEnC,SAAS7L,GAOL,OANAvO,KAAK+mB,WAAa/mB,KAAK8mB,OACvB9mB,KAAK8mB,OAASvY,EACdvO,KAAKuO,MAAQqN,GAAM5b,KAAK8mB,QAAQ6C,cAChC3pB,KAAK0mB,UAAY9K,GAAM5b,KAAK+mB,YAAY4C,cACxCjiB,EAAA,KAAOnI,KAAK,QAAQS,KAAKsW,wBAAwBtW,KAAK0mB,gBAAgB1mB,KAAKuO,SAC3EvO,KAAK4pB,sBAAsB,CAAE9c,KAAM8N,EAAkBK,WAAY9Z,KAAMnB,OAC/DuO,GACJ,KAAKqN,GAAMiO,MACP7pB,KAAK8pB,OAAO,CAAE3B,MAAO,QAASC,UAAW,OAAQ,GACjD,MACJ,KAAKxM,GAAMmO,OACP9S,WAAW,KACP,MAAM,cAAEyQ,EAAa,UAAElN,GAAcxa,KAAKmT,QACtCuU,GAAiBlN,GACjBmD,GAAsB+J,EAAelN,IAE1C,GACH,MAEJ,KAAKoB,GAAM4M,QACPxoB,KAAKgqB,YACL,OAGZ,cAAc5T,GACV,MAAM,OAAE7R,EAAM,OAAEgT,GAAWnB,EAC3B,OAAQ7R,GACJ,KAAKoW,EAAYsB,OAEb,GADAjc,KAAKgnB,WAAY,EACbhnB,KAAK8mB,QAAUlL,GAAMmO,OACrB,OAEA/pB,KAAK8mB,QAAUlL,GAAMqO,OACrBjqB,KAAKqoB,SAASzM,GAAMmO,QAEnB/pB,KAAKinB,UACNjnB,KAAKkqB,aAAa3S,EAAOwG,KAE7B,MAEJ,KAAKpD,EAAYwP,MACb,GAAInqB,KAAK8mB,QAAUlL,GAAMqO,MACrB,OAEJjqB,KAAKinB,UAAW,EAChBjnB,KAAKkqB,aAAa3S,EAAOwG,KACzB,MAEJ,KAAKpD,EAAYG,QACjB,KAAKH,EAAYI,OAAQ,CACrB,MAAQqP,aAAcna,EAAaoa,eAAgBC,EAAa,kBAAEC,GAAsBhT,EACxFvX,KAAK6mB,UAAYyD,EACjB,MAAME,EAAmBD,IAAsB7P,EAAUwN,QAAUxN,EAAUqN,SAAWrN,EAAUwN,QAC5F/B,EAAe,CAAErZ,KAAM8N,EAAkBrW,GAASpD,KAAMnB,KAAMiQ,cAAaqa,gBAAeE,oBAC3FpW,EAAQ,OAAQkS,aAAcH,EAAcnmB,KAAKsW,KAClDlC,EAAQ,OAAQkS,aAAcH,EAAcnmB,KAAKgV,QAAQc,MAE7D,MAEJ,KAAK6E,EAAYyB,KACjB,KAAKzB,EAAY8P,MAAO,CACpB,MAAMtE,EAAe3d,OAAOgP,OAAOhP,OAAOgP,OAAO,GAAID,GAAS,CAAEzK,KAAM8N,EAAkBC,QAAS1Z,KAAMnB,OAClGoU,EAAQ,OAAQkS,aAAcH,EAAcnmB,KAAKsW,KAClDlC,EAAQ,OAAQkS,aAAcH,EAAcnmB,KAAKgV,QAAQc,MAE7D,MAEJ,KAAK6E,EAAYuB,IACblc,KAAK8pB,OAAOvS,GAAQ,GACpB,OAGZ,uBAAuBmT,EAAQC,GAC3B,OAAO,GAAU3qB,UAAM,OAAQ,GAAQ,YACnC,IAAKA,KAAKsnB,sBAAsBoD,EAAOE,YAAcF,EAAOnpB,OAASopB,EAAeE,OAEhF,OADAnjB,EAAA,KAAOjI,MAAM,qDAAsDirB,GAC5D,iBAEX,MAAM,OAAEtE,EAAM,KAAExd,EAAMkiB,QAASC,EAASC,OAAOhrB,KAAKknB,YAAa+D,SAAUC,GAAUR,EACrF,OAAQtE,GACJ,IAAK,UAAW,CACZpmB,KAAKknB,WAAa,EAClB,MAAM,OAAEiE,EAAM,YAAEC,EAAW,YAAEC,EAAW,WAAEC,EAAU,OAAET,EAAM,mBAAEU,EAAkB,KAAE5E,GAASgE,EAC3F3qB,KAAKwrB,0BAA0B,CAAEpF,OAAQtK,GAAiB2P,KAAMC,eAAgBb,EAAQhiB,cAAeS,OAAOiiB,GAAqB5E,SAC/HyE,UACMprB,KAAK2rB,yBAAyBP,IAEpCC,UACMrrB,KAAK4rB,yBAAyBP,IAEpCC,GAAc3E,IAAS9K,GAAKgQ,kBACtB7rB,KAAK8rB,8BAA8BR,IAE7C,MAAMS,EAAe,GACrB,IAAK,MAAM9mB,KAAK2D,EACZmjB,EAAazjB,KAAKE,OAAOgP,OAAO,CAAEuT,OAAQniB,EAAK3D,GAAG,GAAIimB,MAAO5hB,OAAOrE,IAAM,eAAoB2D,EAAK3D,GAAG,MAE1GjF,KAAKwrB,0BAA0B,CAAEpF,OAAQtK,GAAiBkQ,UAAWD,iBACrE,MAEJ,IAAK,MACD/rB,KAAKwrB,0BAA0BhjB,OAAOgP,OAAO,CAAE4O,OAAQtK,GAAiBmQ,IAAKlB,SAAQG,SAAS,eAAoBtiB,KAClH,MAEJ,IAAK,SACD5I,KAAKwrB,0BAA0BhjB,OAAOgP,OAAO,CAAE4O,OAAQtK,GAAiBK,OAAQ4O,SAAQG,SAAS,eAAoBtiB,KACrH,MACJ,IAAK,MACD5I,KAAKwrB,0BAA0BhjB,OAAOgP,OAAO,CAAE4O,OAAQtK,GAAiBoQ,OAAQnB,SAAQG,SAAS,eAAoBtiB,KACrH,MACJ,IAAK,QACD5I,KAAKwrB,0BAA0B,CAAEpF,OAAQtK,GAAiBqQ,QAC1D,MACJ,QACInsB,KAAKwrB,0BAA0B,CAAEpF,SAAQxd,OAAMmiB,SAAQG,UACvD,UAIhB,YAAYpJ,GACH9hB,KAAKmZ,SAAS8F,SAAS6C,IACxB9hB,KAAKmZ,SAAS7Q,KAAKwZ,GAEvB,MAAM5X,EAAWlK,KAAKgV,QAAQ6D,cAC1B7Y,KAAKgV,QAAQoX,oBAAoBliB,EAAU4X,KAC3C9hB,KAAKgV,QAAQqX,cAAcniB,GAAU4X,GAAWtZ,OAAOgP,OAAOhP,OAAOgP,OAAO,GAAIxX,KAAKgV,QAAQqX,cAAcniB,GAAU4X,IAAW,CAAEiJ,OAAQ/qB,KAAKsW,MAGvJ,yBAAyBwL,GACrB,OAAO,GAAU9hB,UAAM,OAAQ,GAAQ,YACnC,MAAMoY,EAAM,CACR/N,OAAQrK,KAAKqK,OACb8O,SAAU,CAAC2I,GACXwK,QAAU/U,IACN,MAAM,UAAEuQ,EAAWqB,KAAMrgB,EAAmByjB,YAAaxjB,EAAiBoO,QAASqV,EAAa1f,KAAM2f,GAAgBlV,EAAO3O,KAC7H5I,KAAKwrB,0BAA0B,CAAEpF,OAAQtK,GAAiB4Q,YAAa5E,YAAWhf,oBAAmBC,kBAAiByjB,cAAaC,cAAaE,UAAWpV,EAAOqV,eAGpKxiB,QAAiBpK,KAAKgV,QAAQ6X,eAAezU,GAC9CqG,MAAMhf,IACPiI,EAAA,KAAOjI,MAAM,+BAAgCA,KAE7CoiB,GAAuBzX,EAAU0X,KACjC9hB,KAAK8sB,YAAYhL,GACjBtZ,OAAOukB,iBAAiB/sB,KAAM,CAC1BgtB,gBAAiB,CACbhhB,cAAc,EACdxM,MAAO,CAAC2X,EAASrK,KACb9M,KAAKgV,QAAQiY,eAAe,CAAE5iB,OAAQrK,KAAKqK,OAAQyX,UAASlZ,KAAM,CAAEwd,OAAQ,OAAQjP,UAASrK,kBAOrH,yBAAyBgV,GACrB,OAAO,GAAU9hB,UAAM,OAAQ,GAAQ,YACnC,MAAMoY,EAAM,CACR/N,OAAQrK,KAAKqK,OACb8O,SAAU,CAAC2I,GACXwK,QAAU/U,IACN,MAAM,UAAEmO,GAAcnO,EACtB,OAAQmO,EAAUC,aACd,IAAK,cACDD,EAAUG,OAAS7lB,KAAKsW,GACxBmP,GAAsBzlB,KAAKgV,QAAS0Q,GACpC,MACJ,QACIhe,EAAA,KAAOjI,MAAM,sCAAuC8X,MAI9DnN,QAAiBpK,KAAKgV,QAAQ6X,eAAezU,GAC9CqG,MAAMhf,IACPiI,EAAA,KAAOjI,MAAM,+BAAgCA,KAE7CoiB,GAAuBzX,EAAU0X,IACjC9hB,KAAK8sB,YAAYhL,MAI7B,aAAaA,EAASvK,EAAS,IAC3B,MAAM3O,EAAOJ,OAAOgP,OAAO,CAAE0V,YAAa,eAAgBrH,OAAQ7lB,KAAKsW,GAAI9W,MAAO,MAAQ+X,GAC1FvX,KAAKgV,QAAQiY,eAAe,CAAE5iB,OAAQrK,KAAKqK,OAAQyX,UAASlZ,SAEhE,8BAA8BkZ,GAC1B,OAAO,GAAU9hB,UAAM,OAAQ,GAAQ,YACnC,MAAMmtB,EAAc,CAACC,EAASpH,EAAW,KAAMxmB,EAAQ,QACnD,MAAM8W,EAAKc,SAAS4O,IAAa,KACjChmB,KAAKqtB,aAAavL,EAAS,CAAEsL,UAAS9W,KAAI9W,WAExC8tB,EAAiB,KACnB,MAAM,MAAE/R,GAAUvb,KAAKmT,QACvB,GAAsB,mBAAVoI,IAAwBA,GAA4B,kBAAVA,GAAsB,eAASA,GACjF,KAAM,cAAcvb,KAAKsW,oBAG3B8B,EAAM,CACR/N,OAAQrK,KAAKqK,OACb8O,SAAU,CAAC2I,GACXwK,QAAU/U,IACN,MAAM,KAAE3O,GAAS2O,EACjB,OAAQ3O,EAAK,iBACT,IAAK,oBACD,GAAIA,EAAK2kB,aAAc,CACnB,MAAMnV,EAAMrV,KAAKC,UAAU4F,EAAK2kB,cAActlB,QAAQ,QAAS,QAC/DjI,KAAKwrB,0BAA0B,CAAEpF,OAAQtK,GAAiB0R,WAAYC,QAAS1qB,KAAKqG,MAAMgP,KAE9F,MACJ,QACIpY,KAAKwrB,0BAA0B,CAAEpF,OAAQtK,GAAiB4R,eAAgBN,QAASxkB,EAAK,gBAAiBwB,SAAUxB,EAAKwB,cAIlIA,QAAiBpK,KAAKgV,QAAQ6X,eAAezU,GAC9CqG,MAAMhf,IACPiI,EAAA,KAAOjI,MAAM,8BAA+BA,KAE5CoiB,GAAuBzX,EAAU0X,KACjC9hB,KAAK2mB,KAAO9K,GAAKgQ,UACjB7rB,KAAK8sB,YAAYhL,GACjBtZ,OAAOukB,iBAAiB/sB,KAAM,CAC1B2tB,iBAAkB,CACd3hB,cAAc,EACdxM,MAAO,KACH2tB,EAAY,uBAGpBS,UAAW,CACP5hB,cAAc,EACdxM,MAAQquB,IACJV,EAAY,OAAQ,KAAMU,KAGlCC,UAAW,CACP9hB,cAAc,EACdxM,MAAO,KACH2tB,EAAY,OAAQ,KAAM,SAGlCY,KAAM,CACF/hB,cAAc,EACdxM,MAAQwmB,IACJmH,EAAY,OAAQnH,KAG5BgI,OAAQ,CACJhiB,cAAc,EACdxM,MAAQwmB,IACJmH,EAAY,SAAUnH,KAG9BiI,YAAa,CACTjiB,cAAc,EACdxM,MAAQquB,IACJV,EAAY,YAAa,KAAM,CAAC,QAASU,MAGjDK,WAAY,CACRliB,cAAc,EACdxM,MAAO,KACH2tB,EAAY,YAAa,KAAM,CAAC,OAAQ,UAGhDgB,SAAU,CACNniB,cAAc,EACdxM,MAAQquB,IACJP,IACAH,EAAY,gBAAiB,KAAMU,KAG3CO,eAAgB,CACZpiB,cAAc,EACdxM,MAAO,CAAC6uB,EAAQC,KACZhB,IACA,MAAM9tB,EAAQ8uB,EAAW,CAACD,EAAQC,GAAYD,EAC9ClB,EAAY,aAAc,KAAM3tB,KAGxC+uB,KAAM,CACFviB,cAAc,EACdxM,MAAQwmB,IACJmH,EAAY,OAAQnH,KAG5BwI,QAAS,CACLxiB,cAAc,EACdxM,MAAQwmB,IACJmH,EAAY,QAASnH,KAG7ByI,UAAW,CACPziB,cAAc,EACdxM,MAAQwmB,IACJsH,IACAH,EAAY,SAAUnH,KAG9B0I,UAAW,CACP1iB,cAAc,EACdxM,MAAQwmB,IACJsH,IACAH,EAAY,aAAcnH,EAAU,eAG5C2I,WAAY,CACR3iB,cAAc,EACdxM,MAAQwmB,IACJsH,IACAH,EAAY,YAAanH,EAAU,WAG3C4I,OAAQ,CACJ5iB,cAAc,EACdxM,MAAO,CAACwmB,EAAU6I,KACdvB,IACAH,EAAY,aAAcnH,EAAU8I,UAAUD,MAGtDE,WAAY,CACR/iB,cAAc,EACdxM,MAAQwmB,IACJmH,EAAY,aAAcnH,EAAU,UAG5CgJ,SAAU,CACNhjB,cAAc,EACdxM,MAAQwmB,IACJmH,EAAY,aAAcnH,EAAU,QAG5CiJ,SAAU,CACNjjB,cAAc,EACdxM,MAAQwmB,IACJmH,EAAY,YAAanH,EAAU,UAG3CkJ,OAAQ,CACJljB,cAAc,EACdxM,MAAQwmB,IACJmH,EAAY,YAAanH,EAAU,QAG3CmJ,SAAU,CACNnjB,cAAc,EACdxM,MAAO,CAACwmB,EAAUoJ,KACdjC,EAAY,WAAYnH,EAAUoJ,WAO1D,8BAA8BhlB,GAE1B,MADuB,WAAvBA,EAASilB,UAAyBrvB,KAAKqoB,SAASzM,GAAMmO,QAAU/pB,KAAKqoB,SAASzM,GAAM0T,OAC7E,EAEX,4BAA4B7vB,GAExB,OADAiI,EAAA,KAAOjI,MAAM,aAAaA,EAAM2mB,kBAAkBpmB,KAAKsW,OAChD,EAEX,aAAa4D,GACT,IAAI6D,EAAMkD,GAAkB/G,EAAWla,KAAKgoB,KAAKlE,SAASuB,iBAAiBtH,KACvE/d,KAAKmT,QAAQqI,YACbuC,EAAMsC,GAActC,IAExB,MAAM6G,EAAe9G,GAAc,CAAEC,MAAKjR,KAAM2N,EAASwB,SACzDjc,KAAKgoB,KAAKlE,SAASgB,qBAAqBF,GACnChlB,KAAK,KACFI,KAAKinB,UACLjnB,KAAKqoB,SAASzM,GAAMqO,OAEpBjqB,KAAKgnB,WACLhnB,KAAKqoB,SAASzM,GAAMmO,UAGvBtL,MAAMhf,IACPiI,EAAA,KAAOjI,MAAM,oCAAqCA,GAClDO,KAAK8pB,WAGb,kCACQ,eAAW9pB,KAAKgoB,KAAK5E,iBACrBhP,EAAQ,OAAQ5F,MAAO,IAAIA,MAAM,+CAAgDxO,KAAKgV,QAAQc,OAGlGtN,OAAOsD,eAAe9L,KAAKgoB,KAAM,kBAAmB,CAAExoB,MAAOQ,KAAKuvB,UAAU/qB,KAAKxE,QACjFA,KAAKqnB,UAAW,EAChBrnB,KAAKgoB,KAAK7D,oBAEd,UAAUvb,GACF5I,KAAKonB,aACLpQ,aAAahX,KAAKonB,aAEtBpnB,KAAKonB,YAAc,KACnBpnB,KAAKqnB,UAAW,EAChB,MAAM,IAAEtJ,EAAG,KAAEjR,GAASlE,EACtB,IAAkC,IAA9BmV,EAAIxX,QAAQ,aAEZ,YADAvG,KAAKwvB,kCAGT,IAAIpZ,EAAM,KACV,MAAMqZ,EAAY,CAAE/G,OAAQ1oB,KAAKgV,QAAQgD,UAAW+F,MAAK9D,aAAcja,KAAKmT,SAC5E,OAAQrG,GACJ,KAAK2N,EAASoK,MACV7kB,KAAKqoB,SAASzM,GAAM8T,YACpBtZ,EAAM,IAAI,GAAOqZ,GACjB,MACJ,KAAKhV,EAASwB,OACVjc,KAAKqoB,SAASzM,GAAM+T,WACpBvZ,GAA8B,IAAxBpW,KAAKmT,QAAQsI,OAAkB,IAAI,GAAOgU,GAAa,IAAI,GAAOA,GACxE,MACJ,QAEI,OADA/nB,EAAA,KAAOjI,MAASO,KAAKsW,GAAR,6BAAwC1N,GAC9C5I,KAAK8pB,OAAO,IAAI,GAE/B9pB,KAAK2oB,SAASvS,GACTxW,KAAKwK,IACN,MAAM,QAAEG,EAAU,MAASH,EAC3BpK,KAAKmnB,cAAgB5c,EACrBuC,IAAS2N,EAASoK,MAAQ7kB,KAAKqoB,SAASzM,GAAMgU,QAAU5vB,KAAKqoB,SAASzM,GAAMmO,UAE3EtL,MAAMhf,IACPiI,EAAA,KAAOjI,MAAM,GAAGO,KAAKsW,gBAAgBxJ,WAAerN,GACpDO,KAAK8pB,WAGb,sBACI,MAAM,SAAEhG,GAAa9jB,KAAKgoB,KAC1BhoB,KAAKqnB,UAAW,EAChBvD,EAAS+L,eAAiBja,IAClB5V,KAAKqnB,WAGgB,OAArBrnB,KAAKonB,cACLpnB,KAAKonB,YAAcnQ,WAAW,IAAMjX,KAAKuvB,UAAUzL,EAASuB,kBAAmB,MAE/EzP,EAAMka,UACNpoB,EAAA,KAAOnI,KAAK,gBAAiBqW,EAAMka,WAGnC9vB,KAAKuvB,UAAUzL,EAASuB,oBAGhCvB,EAASiM,iBAAiB,QAAUna,IAChC5V,KAAKmT,QAAQiH,aAAexE,EAAMoa,QAAQ,GAC1C,MAAM,cAAEtI,EAAa,aAAEtN,EAAY,YAAEsB,GAAgB1b,KAAKmT,SACtC,IAAhBuI,GACAyB,GAAkBuK,EAAetN,KAGzC0J,EAASiM,iBAAiB,YAAcna,IACpC5V,KAAKmT,QAAQiH,aAAexE,EAAMqH,SAG1C,cAAcxd,GACVO,KAAK4pB,sBAAsB,CAAE9c,KAAM8N,EAAkBO,eAAgB1b,UACrEO,KAAK8pB,OAAO,IAAI,GAEpB,0BAA0BvS,GACtBvX,KAAK4pB,sBAAsBphB,OAAOgP,OAAO,CAAE1K,KAAM8N,EAAkBI,iBAAkB7Z,KAAMnB,MAAQuX,IAEvG,sBAAsB4O,IACe,IAA7BnmB,KAAKmT,QAAQuI,cAGZtH,EAAQ,OAAQkS,aAAcH,EAAcnmB,KAAKsW,IAAI,IACtDlC,EAAQ,OAAQkS,aAAcH,EAAcnmB,KAAKgV,QAAQc,OAGjE,SAASM,GAIL,OAHIpW,KAAKqK,SACL+L,EAAI6Z,aAAejwB,KAAKqK,QAErBrK,KAAKgV,QAAQiE,QAAQ7C,GAEhC,QACI,MAAM,GAAEE,EAAE,cAAEqF,EAAa,mBAAE9B,EAAkB,eAAEQ,GAAmBra,KAAKmT,QAClEmD,IACDtW,KAAKmT,QAAQmD,GAAK,KAEtBtW,KAAKsW,GAAKtW,KAAKmT,QAAQmD,GAClBqF,IAAiB,eAASA,KAC3B3b,KAAKmT,QAAQwI,cAAgB3b,KAAKgV,QAAQ7B,QAAQwI,eAAiB,IAElE9B,IACD7Z,KAAKmT,QAAQ0G,mBAAqB7Z,KAAKmT,QAAQwG,mBAEnD3Z,KAAKgV,QAAQiR,MAAMjmB,KAAKsW,IAAMtW,KAC9B4T,EAAS,OAAQyQ,WAAYrkB,KAAK4nB,cAAe5nB,KAAKsW,IAClD,eAAW+D,IACXzG,EAAS,OAAQ0S,aAAcjM,EAAe7V,KAAKxE,MAAOA,KAAKsW,IAEnEtW,KAAKqoB,SAASzM,GAAM6K,KACpB/e,EAAA,KAAOnI,KAAK,yBAA0BS,KAAKmT,SAE/C,YACI,MAAM,aAAEiH,EAAY,YAAED,EAAW,cAAEuN,EAAa,aAAEpD,GAAiBtkB,KAAKmT,QACxE6K,GAAW5D,GACX4D,GAAW7D,IACsB,IAA7Bna,KAAKmT,QAAQuI,cACb8B,GAAkBkK,GAClBlK,GAAkB8G,IAEtBtQ,EAAW,OAAQqQ,WAAY,KAAMrkB,KAAKsW,IAC1CtW,KAAKgoB,KAAO,KACZhoB,KAAKgV,QAAQiR,MAAMjmB,KAAKsW,IAAM,YACvBtW,KAAKgV,QAAQiR,MAAMjmB,KAAKsW,KCvrBvC,IAAI,GAAwC,SAAU1U,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMxC,GAAS,OAAOA,aAAiBsC,EAAItC,EAAQ,IAAIsC,GAAE,SAAU7C,GAAWA,EAAQO,MAC/F,OAAO,IAAKsC,IAAMA,EAAInC,WAAU,SAAUV,EAASC,GAC/C,SAAS+C,EAAUzC,GAAS,IAAM0C,EAAKH,EAAUI,KAAK3C,IAAW,MAAO4C,GAAKlD,EAAOkD,IACpF,SAASC,EAAS7C,GAAS,IAAM0C,EAAKH,EAAU,SAASvC,IAAW,MAAO4C,GAAKlD,EAAOkD,IACvF,SAASF,EAAKI,GAAUA,EAAO5C,KAAOT,EAAQqD,EAAO9C,OAASwC,EAAMM,EAAO9C,OAAOI,KAAKqC,EAAWI,GAClGH,GAAMH,EAAYA,EAAU5B,MAAMyB,EAASC,GAAc,KAAKM,YAMvD,MAAM,WAAa,GAC9B,cACI8V,SAAS/X,WACTF,KAAKkwB,eAAiB,KAE1B,OAAO3Y,EAAS,GAAI0B,GAAU,GACtBjZ,KAAK0b,uBAAuB,IAC5B1b,KAAK0b,YAAYoO,OAAOvS,EAAQ0B,GAEpChB,MAAM6R,OAAOvS,EAAQ0B,GAEzB,iBAAiBuN,GACb,OAAO,GAAUxmB,UAAM,OAAQ,GAAQ,YACnC,MAAMmwB,QAAsBtT,GAAgB,CAAEtB,OAAO,IACrD4U,EAAclS,YAAYpQ,QAAQyL,IAC9BA,EAAEyW,iBAAiB,QAAS,KACpB/vB,KAAK0b,aACL1b,KAAK0b,YAAYoO,aAI7B,MAAM,iBAAElQ,EAAgB,mBAAEC,EAAkB,WAAEC,EAAU,aAAEC,GAAiB/Z,KAAKmT,QAC1EA,EAAU3K,OAAOgP,OAAO,CAAEkE,aAAa,EAAMvB,YAAagW,EAAexW,kBAAsB3Z,KAAK6mB,UAAR,UAA4BjN,mBAAkBC,mBAAuBA,EAAH,UAAgCC,WAAeA,EAAH,YAA0BC,aAAiBA,EAAH,aAA8ByM,GAGtR,OAFAxmB,KAAK0b,YAAc,IAAI,GAAK1b,KAAKgV,QAAS7B,GAC1CnT,KAAK0b,YAAY0U,SACVpwB,KAAK0b,eAGpB,kBACQ1b,KAAK0b,uBAAuB,IAC5B1b,KAAK0b,YAAYoO,SAGzB,kBAAkBlM,GACd,OAAO,GAAU5d,UAAM,OAAQ,GAAQ,YACnCA,KAAKmT,QAAQqH,UAAYoD,EACzB,MAAM,cAAE8J,EAAa,UAAElN,GAAcxa,KAAKmT,QAC1C,SAAIuU,IAAiBlN,IACVmD,GAAsB+J,EAAelN,MAKxD,YACIxa,KAAKqwB,QAAO,GACZpY,MAAM+R,YAEV,OAAOnC,GAAO,GACV,IAAa,IAATA,EACA,OAAOyI,cAActwB,KAAKkwB,gBAE9BxoB,EAAA,KAAOb,SAAS,GAChB7G,KAAKkwB,eAAiB1tB,OAAO+tB,YAAY,IAAM,GAAUvwB,UAAM,OAAQ,GAAQ,YAC3E,MAAMwwB,QAAcxwB,KAAKgoB,KAAKlE,SAAS2M,SAAS,MAChD,IAAIC,EAAc,GAClB,MAAMC,EAAgB,CAAC,cAAe,QAAS,kBAAmB,SAAU,kBAAmB,oBACzFC,EAAc,CAAC,KAAM,OAAQ,aACnCJ,EAAM3iB,QAAQgjB,IACNF,EAAc1R,SAAS4R,EAAO/jB,QAGlC4jB,GAAe,KAAKG,EAAO/jB,SAC3BtE,OAAOC,KAAKooB,GAAQhjB,QAAQijB,IACnBF,EAAY3R,SAAS6R,KACtBJ,GAAe,KAAKI,MAAaD,EAAOC,aAIpDppB,EAAA,KAAOnI,KAAKmxB,MACZ,MCjFZ,IAAI,GAAwC,SAAU9uB,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMxC,GAAS,OAAOA,aAAiBsC,EAAItC,EAAQ,IAAIsC,GAAE,SAAU7C,GAAWA,EAAQO,MAC/F,OAAO,IAAKsC,IAAMA,EAAInC,WAAU,SAAUV,EAASC,GAC/C,SAAS+C,EAAUzC,GAAS,IAAM0C,EAAKH,EAAUI,KAAK3C,IAAW,MAAO4C,GAAKlD,EAAOkD,IACpF,SAASC,EAAS7C,GAAS,IAAM0C,EAAKH,EAAU,SAASvC,IAAW,MAAO4C,GAAKlD,EAAOkD,IACvF,SAASF,EAAKI,GAAUA,EAAO5C,KAAOT,EAAQqD,EAAO9C,OAASwC,EAAMM,EAAO9C,OAAOI,KAAKqC,EAAWI,GAClGH,GAAMH,EAAYA,EAAU5B,MAAMyB,EAASC,GAAc,KAAKM,YAYtE,MAAM,GACF,YAAY6S,GACRhV,KAAKgV,QAAUA,EAEnB,KAAKsB,EAAI/R,GACL,MAAM6R,EAAM,IAAI,EAAOE,EAAI/R,GACvBvE,KAAKqK,SACL+L,EAAI6Z,aAAejwB,KAAKqK,QAE5BrK,KAAKgV,QAAQiE,QAAQ7C,GAEzB,cAAcA,GACV,MAAM,QAAEpB,GAAYhV,MACd,GAAEsW,EAAE,OAAE/R,EAAM,OAAEgT,GAAWnB,GACzB,OAAEyP,EAAM,aAAEkL,EAAY,UAAEC,GAAczZ,EACtCkE,EAASlX,IAAWoW,EAAYI,OACtC,GAAkB,mBAAdiW,EACA,OAAOhxB,KAAKixB,gBAAgB1Z,EAAO2Z,SAEvC,GAAIrL,GAAU7Q,EAAQiR,MAAM5a,eAAewa,GAAS,CAChD,IAAIpK,EAMA,OAFAzG,EAAQiR,MAAMJ,GAAQsL,cAAc/a,QACpCpW,KAAKoxB,KAAK9a,EAAI/R,GAJdyQ,EAAQiR,MAAMJ,GAAQiE,OAAO,IAAI,GAQzC,MAAMuH,EAAa,KACf,MAAMlwB,EAAO,IAAI,GAAK6T,EAAS,CAC3BsB,GAAIuP,EACJ3L,UAAW3C,EAAOwG,IAClBpE,kBAAmBpC,EAAO+Z,iBAC1B1X,iBAAkBrC,EAAOga,eACzB1X,mBAAoBtC,EAAOia,iBAC3B1X,WAAYvC,EAAOka,eACnB1X,aAAcxC,EAAO+Z,iBACrB7V,WAGJ,OADAta,EAAKkJ,OAASrK,KAAKqK,OACZlJ,GAEX,OAAQoD,GACJ,KAAKoW,EAAY+W,KACb1c,EAAQ2c,aACR,MACJ,KAAKhX,EAAYqB,OAAQ,CACrB,MAAM7a,EAAOkwB,IACblwB,EAAKknB,SAASzM,GAAMgW,SACpB5xB,KAAKoxB,KAAK9a,EAAI/R,GACd,MAEJ,KAAKoW,EAAYI,OAAQ,CACrB,MAAM5Z,EAAOkwB,IACTrxB,KAAKgV,QAAQ6c,iBACb1wB,EAAK+f,SAGL/f,EAAKknB,SAASzM,GAAMkW,YAExB3wB,EAAKgwB,cAAc/a,GACnB,MAEJ,KAAKuE,EAAY8P,MACjB,IAAK,eACD,IAAKsG,EAED,YADArpB,EAAA,KAAOjI,MAAM,mCAAoC8X,GAGrD,MAAMrN,EAAW8K,EAAQ6D,cACnBkZ,EAAahB,EAAajY,MAAM,KAAK,GACvC9D,EAAQoX,oBAAoBliB,EAAU6mB,GACtC3c,EAAQlK,EAAUqN,EAAQwZ,GAErBA,IAAiB/b,EAAQgD,UAC9BhY,KAAKgyB,oBAAoBza,EAAOmO,WAE3B1Q,EAAQoX,oBAAoBliB,EAAU6nB,GAC3C3d,EAAQlK,EAAUqN,EAAQwa,GAErB/c,EAAQiR,MAAM5a,eAAe0lB,GAClC/b,EAAQiR,MAAM8K,GAAcI,cAAc/a,GAG1ChC,EAAQ,OAAQkS,aAAc/O,EAAQvC,EAAQc,MAElD,MACJ,KAAK6E,EAAYyB,KACb7E,EAAOzK,KAAO8N,EAAkBC,QAChCzG,EAAQ,OAAQkS,aAAc/O,EAAQvC,EAAQc,MAC9C,MACJ,KAAK6E,EAAYsX,YACb1a,EAAOzK,KAAO8N,EAAkBM,iBAChC9G,EAAQ,OAAQkS,aAAc/O,EAAQvC,EAAQc,MAC9C,MACJ,QACIpO,EAAA,KAAO2B,KAAK,gCAAiC+M,IAGzD,gBAAgBsU,EAAQwH,GACpB,MAAMC,EAAU3pB,OAAOC,KAAKzI,KAAKgV,QAAQiR,OACzC,GAAsB,YAAlByE,EAAOtE,OAOP,OAAO+L,EAAQ5I,KAAMjT,GAAOtW,KAAKgV,QAAQiR,MAAM3P,GAAI6C,SAAS8F,SAASiT,IAPxC,CAC7B,MAAME,EAAK1H,EAAO9hB,KAAK2gB,KAAM8I,GAAOF,EAAQlT,SAASoT,EAAG,KACxD,GAAID,aAAchf,MACd,OAAOgf,EAAG,IAOtB,gBAAgBlB,GACZ,OAAO,GAAUlxB,UAAM,OAAQ,GAAQ,YACnC,MAAM,QAAEgV,GAAYhV,KACdkK,EAAW8K,EAAQ6D,eACnB,OAAEuN,EAAM,UAAE8L,EAAS,OAAErH,EAAM,YAAEO,EAAW,YAAEC,EAAW,WAAEC,EAAU,mBAAEC,EAAkB,KAAE5E,EAAI,OAAEd,GAAWqL,EAC9G,OAAQ9K,GACJ,IAAK,4BAA6B,CAC9B,MAAMkM,EAAsB,KACxBtd,EAAQiY,eAAe,CAAE5iB,OAAQrK,KAAKqK,OAAQyX,QAASoQ,EAAWtpB,KAAM,CAAE2pB,UAAW,CAAEnF,QAAS,YAAa3gB,QAASylB,EAAW3wB,KAAMspB,OAErIzS,EAAM,CACR/N,OAAQrK,KAAKqK,OACb8O,SAAU,CAAC+Y,GACX5F,QAAS,EAAG1jB,KAAM8hB,MACd,MAAMpU,EAAKuP,GAAU7lB,KAAKwyB,gBAAgB9H,EAAQwH,GAClD,GAAI5b,GAAMtB,EAAQiR,MAAM5a,eAAeiL,GAAK,CACxC,MAAMnV,EAAO6T,EAAQiR,MAAM3P,GAC3BnV,EAAK2rB,YAAYoF,GACjB/wB,EAAK0lB,UAAYgE,EACjB1pB,EAAKsxB,uBAAuB/H,EAAQwG,GAC/BtxB,KAAKH,IACQ,mBAAVA,GACA6yB,SAMdhwB,QAAe0S,EAAQ6X,eAAezU,GACvCqG,MAAMhf,IACPiI,EAAA,KAAOjI,MAAM,gCAAiCA,KAE9CoiB,GAAuBvf,EAAQ4vB,IAC/BI,IAEJ,MAEJ,IAAK,4BAA6B,CAC9B,IAAInxB,EAAO,KACX,GAAI+wB,GAAald,EAAQoX,oBAAoBliB,EAAUgoB,GAAY,CAC/D,MAAM,OAAEnH,EAAS,MAAS/V,EAAQqX,cAAcniB,GAAUgoB,GAE1D,GADA/wB,EAAO6T,EAAQiR,MAAM8E,IAAW,KACjB,OAAXA,EAAiB,CACjB,MAAM5E,EAAe,CAAErZ,KAAM8N,EAAkBI,iBAAkBoL,OAAQtK,GAAiB4W,MAAOhH,eAAgBb,EAAQhiB,cAAeS,OAAOiiB,GAAqB5E,QAC/JvS,EAAQ,OAAQkS,aAAcH,EAAc4E,GAAQ,IACrD3W,EAAQ,OAAQkS,aAAcH,EAAcnR,EAAQc,MAE3C,OAAT3U,GACA6S,EAAW,OAAQsS,aAAc,KAAMyE,IAInD,MAAM5R,EAAW,CAAC+Y,EAAW9G,EAAaC,EAAaC,GACvDtW,EAAQ2d,iBAAiB,CAAEtoB,OAAQrK,KAAKqK,OAAQ8O,aAC3CvZ,KAAK,EAAGgzB,uBAAuB,OAC5BzxB,IACAA,EAAKgY,SAAWhY,EAAKgY,SAASuF,OAAOmU,IAAMD,EAAqB3T,SAAS4T,OAG5EpU,MAAMhf,IACPiI,EAAA,KAAOjI,MAAM,+BAAgCA,KAEjD,WAKhB,oBAAoBimB,GAChB,OAAQA,EAAUC,aACd,IAAK,cACL,IAAK,aACDF,GAAsBzlB,KAAKgV,QAAS0Q,GACpC,MACJ,IAAK,YAAa,CACd,MAAMS,EAAe,CAAErZ,KAAM8N,EAAkBI,iBAAkBoL,OAAQtK,GAAiBgX,SAAUC,KAAMrN,EAAUsN,SACpH5e,EAAQ,OAAQkS,aAAcH,EAAcnmB,KAAKgV,QAAQc,MACzD,SAKD,UCjNA,WACX,MAAM,SAAE5L,EAAQ,MAAE0L,EAAK,OAAE2B,GAAW0b,GAC9B,WAAEC,EAAU,QAAE3oB,GAAYgN,EAChC,GAAIrN,IAAa8K,EAAQ6D,cACrB,OAAOnR,EAAA,KAAOjI,MAAM,8BAExB,OAAQmW,GACJ,IAAK,uBACD,GAAmB,mBAAfsd,EAAiC,CACjC,MAAM5G,EAAU,IAAI,GAAatX,GACjCsX,EAAQjiB,OAASE,EACjB+hB,EAAQ6E,cAAc5Z,EAAOA,aAG7BvC,EAAQme,QAAQC,oBAAoB7b,GAExC,MACJ,IAAK,sBACDvC,EAAQqe,QAAQD,oBAAoB7b,GACpC,MACJ,IAAK,0BACDvC,EAAQse,UAAUF,oBAAoB7b,GACtC,MACJ,QACI,OAAO7P,EAAA,KAAOjI,MAAM,8BAA8ByzB,KC1B1D,GAAwC,SAAUtxB,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMxC,GAAS,OAAOA,aAAiBsC,EAAItC,EAAQ,IAAIsC,GAAE,SAAU7C,GAAWA,EAAQO,MAC/F,OAAO,IAAKsC,IAAMA,EAAInC,WAAU,SAAUV,EAASC,GAC/C,SAAS+C,EAAUzC,GAAS,IAAM0C,EAAKH,EAAUI,KAAK3C,IAAW,MAAO4C,GAAKlD,EAAOkD,IACpF,SAASC,EAAS7C,GAAS,IAAM0C,EAAKH,EAAU,SAASvC,IAAW,MAAO4C,GAAKlD,EAAOkD,IACvF,SAASF,EAAKI,GAAUA,EAAO5C,KAAOT,EAAQqD,EAAO9C,OAASwC,EAAMM,EAAO9C,OAAOI,KAAKqC,EAAWI,GAClGH,GAAMH,EAAYA,EAAU5B,MAAMyB,EAASC,GAAc,KAAKM,YActE,MAAMoxB,GAAqB,IACZ,MAAM,GACjB,YAAYpgB,GAgBR,GAfAnT,KAAKmT,QAAUA,EACfnT,KAAK8V,KAAO,IACZ9V,KAAKgY,UAAY,GACjBhY,KAAKqsB,cAAgB,GACrBrsB,KAAKwzB,UAAY,EACjBxzB,KAAK4Y,UAAY,KACjB5Y,KAAK6Y,cAAgB,KACrB7Y,KAAKyzB,SAAW,GAChBzzB,KAAKkX,kBAAoB,KACzBlX,KAAK0zB,WAAa,KAClB1zB,KAAK2zB,UAAW,EAChB3zB,KAAK4zB,cAAe,EACpB5zB,KAAK6zB,gBAAiB,EACtB7zB,KAAK8zB,OAAQ,EACb9zB,KAAK+zB,cAAgB,IAChB/zB,KAAKg0B,kBACN,MAAM,IAAIxlB,MAAM,wBAEpBxO,KAAKi0B,cAAgBj0B,KAAKi0B,cAAczvB,KAAKxE,MAC7CA,KAAKk0B,sBAAwBl0B,KAAKk0B,sBAAsB1vB,KAAKxE,MAC7DA,KAAKm0B,iBAAmBn0B,KAAKm0B,iBAAiB3vB,KAAKxE,MACnDA,KAAKo0B,kBAAoBp0B,KAAKo0B,kBAAkB5vB,KAAKxE,MACrDA,KAAKq0B,sBAAwBr0B,KAAKq0B,sBAAsB7vB,KAAKxE,MAC7DA,KAAKs0B,mBACLt0B,KAAK0zB,WAAa,IAAI,EAAW1zB,MAErC,eACI,OAAO0H,EAAA,KAEX,gBACI,OAAO1H,KAAK0zB,YAAc1zB,KAAK0zB,WAAWle,UAE9C,cACI,OAAOxV,KAAKwzB,WAAaxzB,KAAKwzB,WAAczrB,KAAKwsB,MAAQ,IAE7D,qBACI,OAAyB,IAAlB,eAAU,EAAG,GAExB,QAAQne,GACJ,OAAIpW,KAAK8zB,MACE,IAAIn0B,QAAQV,GAAWe,KAAK+zB,cAAczrB,KAAK,CAAErJ,UAASmX,SAEhEpW,KAAKwV,UAMHxV,KAAK0zB,WAAWhd,KAAKN,GACvBqI,MAAMhf,IAIP,MAHIA,EAAM+K,MAAQ/K,EAAM+K,OAASxK,KAAKkX,kBAClClX,KAAKw0B,mBAEH/0B,IAVC,IAAIE,QAAQV,IACfe,KAAK+zB,cAAczrB,KAAK,CAAErJ,UAASmX,QACnCpW,KAAKy0B,YAWjB,WAAW5F,GACH7uB,KAAK8zB,MACL9zB,KAAK+zB,cAAczrB,KAAK,CAAE8N,IAAKyY,IAGnC7uB,KAAK0zB,WAAWgB,YAAY7F,GAEhC,kBACI,MAAM,QAAEtW,GAAU,EAAK,MAAEoc,GAAQ,GAAU30B,KAAKmT,QAChD,OAAOyhB,QAAQrc,GAAWoc,GAE9B,UAAUpd,IACV,WAAU,SAAErN,EAAQ,SAAEiP,EAAQ,QAAEmT,IAC5B,OAAO,GAAUtsB,UAAM,OAAQ,GAAQ,YACnC,MAAM60B,EAAK,IAAI,EAAa,CAAEzH,QAAS,OAAKljB,WAAUiP,aAChD7W,QAAetC,KAAKiZ,QAAQ4b,IAC5B,gBAAEC,EAAkB,GAAE,mBAAEC,EAAqB,IAAOzyB,EAK1D,OAJIwyB,EAAgB5vB,QAChB4vB,EAAgBjnB,QAASiU,GAAY9hB,KAAKg1B,oBAAoB9qB,EAAU4X,IAE5EiT,EAAmBlnB,QAASiU,GAAY9hB,KAAKi1B,iBAAiB/qB,EAAUoiB,EAASxK,IAC1Exf,KAGf,aAAY,SAAE4H,EAAQ,SAAEiP,EAAQ,QAAEmT,IAC9B,OAAO,GAAUtsB,UAAM,OAAQ,GAAQ,YACnC,MAAM60B,EAAK,IAAI,EAAa,CAAEzH,QAAS,OAAQljB,WAAUiP,aACzD,OAAOnZ,KAAKiZ,QAAQ4b,MAG5B,aACI,OAAO,GAAU70B,UAAM,OAAQ,GAAQ,YACnCgX,aAAahX,KAAKk1B,mBAClBl1B,KAAKqsB,cAAgB,GACrBrsB,KAAK6zB,gBAAiB,EACtB7zB,KAAK6Y,cAAgB,KACrB7Y,KAAKw0B,yBACC,OAAerxB,WAAWnD,KAAK4Y,WACrC5Y,KAAK+zB,cAAgB,GACrB/zB,KAAKm1B,sBAGb,GAAGzhB,EAAWG,GAEV,OADAD,EAASF,EAAWG,EAAU7T,KAAK8V,MAC5B9V,KAEX,IAAI0T,EAAWG,GAEX,OADAG,EAAWN,EAAWG,EAAU7T,KAAK8V,MAC9B9V,KAEX,aAAa20B,GACT,OAAO,GAAU30B,UAAM,OAAQ,GAAQ,YACnCA,KAAKmT,QAAQwhB,MAAQA,EACrB,IACI,GAAI30B,KAAKo1B,cACCp1B,KAAKy0B,cAEV,CACD,MAAMY,EAAK,IAAI,EAAer1B,KAAKmT,QAAQoF,QAASoc,EAAO30B,KAAKgY,WAC1D5N,QAAiBpK,KAAKiZ,QAAQoc,IAC5BC,eAAe,WAAEC,EAAa,MAAS,IAAOnrB,EACtDpK,KAAKwzB,WAAa+B,GAAc,GAGxC,MAAO91B,GACHiI,EAAA,KAAOjI,MAAM,sBAAuBA,GACpC2U,EAAQ,OAAQ5F,MAAO/O,EAAOO,KAAK8V,MAAM,OAIrD,UACI,OAAO,GAAU9V,UAAM,OAAQ,GAAQ,YAC9BA,KAAK0zB,aACN1zB,KAAK0zB,WAAa,IAAI,EAAW1zB,OAErCA,KAAKs0B,mBACAt0B,KAAK0zB,WAAW8B,SACjBx1B,KAAK0zB,WAAWe,aAI5B,kBAAkBh1B,GACd2U,EAAQ,OAAQ5F,MAAO/O,EAAOO,KAAK8V,MAEvC,gBACI,OAAO,GAAU9V,UAAM,OAAQ,GAAQ,YACnCA,KAAK8zB,OAAQ,EACb,MAAM2B,EAAWz1B,KAAK2zB,SAAW,YAAc,SACzC,QAAEpb,EAAO,MAAEoc,GAAU30B,KAAKmT,QAC1BuiB,EAAK,IAAI,EAAQ,CAAEnd,UAAS,CAACkd,GAAWd,GAAS30B,KAAKgY,WACtD5N,QAAiBpK,KAAKiZ,QAAQyc,GAAIjX,MAAMze,KAAKo0B,mBACnD,GAAIhqB,EAAU,CACVpK,KAAK6zB,gBAAiB,EACtB,MAAM,UAAE7b,EAAS,OAAE2d,EAAM,cAAEC,EAAeN,eAAe,WAAEC,EAAa,KAAI,UAAE3c,EAAY,MAAS,IAAOxO,EAC1GpK,KAAKwzB,WAAa+B,GAAc,EAChCv1B,KAAK4Y,UAAYA,EACjB5Y,KAAK6Y,oBAAsBgd,EAAM71B,MACjCA,KAAKq0B,wBACLr0B,KAAKgY,UAAYA,EACjBhY,KAAK21B,OAASA,EACd31B,KAAK41B,cAAgBA,EACrB51B,KAAK81B,sBACL91B,KAAK+1B,MAAQ,KACb/1B,KAAKg2B,aACL5hB,EAAQ,OAAQ6hB,MAAOj2B,KAAMA,KAAK8V,MAClCpO,EAAA,KAAOnI,KAAK,sBAIxB,sBAAsBqW,GAClBlO,EAAA,KAAOjI,MAAM,UAAUmW,EAAM9I,QAAQ8I,EAAMuB,WACvCnX,KAAK6Y,eACLtE,EAAcvU,KAAK6Y,eAEvB,IAAK,MAAMqd,KAAOl2B,KAAKqsB,cACnB9X,EAAc2hB,GAElBl2B,KAAKqsB,cAAgB,GACrBrsB,KAAKyzB,SAAW,GACZzzB,KAAKo1B,UACLp1B,KAAK8zB,OAAQ,EACb9zB,KAAK6zB,gBAAiB,EACtB7zB,KAAKwzB,UAAY,GAEjBxzB,KAAK6zB,iBACL7zB,KAAKk1B,kBAAoBje,WAAW,IAAMjX,KAAKy0B,UAAWz0B,KAAKm2B,iBAGvE,iBAAiB/rB,GACb,MAAM,OAAE7F,EAAM,OAAEgT,GAAWnN,EAC3B,OAAQ7F,GACJ,KAAK,OAAY8X,UACb+Z,GAAiBp2B,KAAMuX,GACvB,MACJ,KAAK,OAAY8e,WACbr2B,KAAK8zB,OAAQ,EACb,OAGZ,oBAAoB5pB,EAAU4X,GACrB9hB,KAAKosB,oBAAoBliB,EAAU4X,KAGpCA,UACO9hB,KAAKqsB,cAAcniB,GAAU4X,GACpC9N,EAAW9J,EAAU,KAAM4X,YAGpB9hB,KAAKqsB,cAAcniB,GAC1BqK,EAAcrK,KAGtB,iBAAiBA,EAAUoiB,EAAU,KAAMxK,GACnC9hB,KAAKosB,oBAAoBliB,EAAU4X,KAGlC9hB,KAAKosB,oBAAoBliB,KAC1BlK,KAAKqsB,cAAcniB,GAAY,IAEnClK,KAAKqsB,cAAcniB,GAAU4X,GAAW,GACpC,eAAWwK,IACX1Y,EAAS1J,EAAUoiB,EAASxK,IAGpC,oBAAoB5X,EAAU4X,GAC1B,SAAI9hB,KAAKqsB,cAAchhB,eAAenB,OAC7B4X,GAAYA,GAAW9hB,KAAKqsB,cAAcniB,GAAUmB,eAAeyW,KAMhF,mBACI9hB,KAAKm1B,mBACLn1B,KAAKs2B,GAAG,OAAQzgB,WAAY7V,KAAKi0B,eACjCj0B,KAAKs2B,GAAG,OAAQtgB,YAAahW,KAAKk0B,uBAClCl0B,KAAKs2B,GAAG,OAAQpgB,YAAalW,KAAKk0B,uBAClCl0B,KAAKs2B,GAAG,OAAQ/f,cAAevW,KAAKm0B,kBAExC,mBACIn0B,KAAKu2B,IAAI,OAAQ1gB,WAAY7V,KAAKi0B,eAClCj0B,KAAKu2B,IAAI,OAAQvgB,YAAahW,KAAKk0B,uBACnCl0B,KAAKu2B,IAAI,OAAQrgB,YAAalW,KAAKk0B,uBACnCl0B,KAAKu2B,IAAI,OAAQhgB,cAAevW,KAAKm0B,kBAEzC,sBACIn0B,KAAK+zB,cAAclmB,QAAQ,EAAG5O,UAASmX,UAChB,kBAARA,EACPpW,KAAKw2B,WAAWpgB,GAGhBnX,EAAQe,KAAKiZ,QAAQ7C,MAIjC,mBACIpW,KAAK8zB,OAAQ,EACb9c,aAAahX,KAAKy2B,mBACdz2B,KAAK0zB,YACL1zB,KAAK0zB,WAAW3c,QAGxB,wBACI,IAAK/W,KAAKwzB,UACN,OAEJ,MAAMkD,EAAO12B,KAAKwzB,UAAazrB,KAAKwsB,MAAQ,IACxCmC,GAAQ,KACRhvB,EAAA,KAAO2B,KAAK,gFACZ+K,EAAQ,OAAQkS,aAAc,CAAExZ,KAAM8N,EAAkBQ,aAAcpG,QAAShV,MAAQA,KAAK8V,MAAM,IAEjG9V,KAAKo1B,SACNne,WAAWjX,KAAKq0B,sBAAuB,KAG/C,aACI,IAA0B,IAAtBr0B,KAAK4zB,aAAT,CAGA,IAAmB,IAAf5zB,KAAK+1B,MACL,OAAO/1B,KAAKw0B,mBAEhBx0B,KAAK+1B,OAAQ,EACb/1B,KAAKiZ,QAAQ,IAAI,GACZrZ,KAAK,IAAMI,KAAK+1B,OAAQ,GACxBtX,MAAM,IAAMze,KAAK+1B,OAAQ,GAC9B/1B,KAAKy2B,kBAAoBxf,WAAW,IAAMjX,KAAKg2B,aAAczC,KAEjE,UAAU7f,EAAWG,GACjBD,EAASF,EAAWG,GAExB,WAAWH,GACPM,EAAWN,GAEf,cACI,OAAO,KC1Tf,IAAI,GAAwC,SAAU9R,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMxC,GAAS,OAAOA,aAAiBsC,EAAItC,EAAQ,IAAIsC,GAAE,SAAU7C,GAAWA,EAAQO,MAC/F,OAAO,IAAKsC,IAAMA,EAAInC,WAAU,SAAUV,EAASC,GAC/C,SAAS+C,EAAUzC,GAAS,IAAM0C,EAAKH,EAAUI,KAAK3C,IAAW,MAAO4C,GAAKlD,EAAOkD,IACpF,SAASC,EAAS7C,GAAS,IAAM0C,EAAKH,EAAU,SAASvC,IAAW,MAAO4C,GAAKlD,EAAOkD,IACvF,SAASF,EAAKI,GAAUA,EAAO5C,KAAOT,EAAQqD,EAAO9C,OAASwC,EAAMM,EAAO9C,OAAOI,KAAKqC,EAAWI,GAClGH,GAAMH,EAAYA,EAAU5B,MAAMyB,EAASC,GAAc,KAAKM,YAGlE,GAAkC,SAAUkX,EAAGjX,GAC/C,IAAIkX,EAAI,GACR,IAAK,IAAIC,KAAKF,EAAO7Q,OAAOxH,UAAUqK,eAAelK,KAAKkY,EAAGE,IAAMnX,EAAEmE,QAAQgT,GAAK,IAC9ED,EAAEC,GAAKF,EAAEE,IACb,GAAS,MAALF,GAAqD,oBAAjC7Q,OAAOgR,sBACtB,KAAIvU,EAAI,EAAb,IAAgBsU,EAAI/Q,OAAOgR,sBAAsBH,GAAIpU,EAAIsU,EAAErU,OAAQD,IAC3D7C,EAAEmE,QAAQgT,EAAEtU,IAAM,GAAKuD,OAAOxH,UAAUyY,qBAAqBtY,KAAKkY,EAAGE,EAAEtU,MACvEqU,EAAEC,EAAEtU,IAAMoU,EAAEE,EAAEtU,KAE1B,OAAOqU,GAYI,MAAM,WAAuB,GACxC,cACIrB,SAAS/X,WACTF,KAAKimB,MAAQ,GACbjmB,KAAK6xB,kBAAmB,EACxB7xB,KAAK22B,YAAc,GACnB32B,KAAK42B,cAAgB,KACrB52B,KAAK62B,eAAiB,KACtB72B,KAAK2zB,UAAW,EAChB3zB,KAAK82B,SAAW,GAChB92B,KAAK+2B,mBAAoB,EACzB/2B,KAAKg3B,mBAAoB,EACzBh3B,KAAKi3B,SAAW,KAEpB,qBACI,OAAO,IAEX,UACI,MAAMC,EAAS1uB,OAAOgE,OAAO,KAAM,CAC/BioB,QAAS,CAAE0C,IAAK,IAAMlf,MAAMwc,WAEhC,OAAO,GAAUz0B,UAAM,OAAQ,GAAQ,YACnCA,KAAKgY,gBAAkB,OAAanV,QAAQ,QAC5Cq0B,EAAOzC,QAAQtzB,KAAKnB,SAG5B,iBAAiBsb,GAAQ,EAAMC,GAAQ,GACnC,OAAO,GAAUvb,UAAM,OAAQ,GAAQ,YACnC,IACI,MAAMid,QAAe,GAAa,CAAE3B,QAAOC,UAE3C,OADAyC,GAAWf,IACJ,EAEX,MAAOjD,GACH,OAAO,MAInB,SACIha,KAAK2xB,aAET,aACI,MAAMuF,EAAS1uB,OAAOgE,OAAO,KAAM,CAC/BmlB,WAAY,CAAEwF,IAAK,IAAMlf,MAAM0Z,cAEnC,OAAO,GAAU3xB,UAAM,OAAQ,GAAQ,YACnCwI,OAAOC,KAAKzI,KAAKimB,OAAOpY,QAAQwU,GAAKriB,KAAKimB,MAAM5D,GAAGgG,SAASzM,GAAMiO,QAClE7pB,KAAKimB,MAAQ,SACPiR,EAAOvF,WAAWxwB,KAAKnB,SAGrC,UAAUo3B,GACN,OAAO,IAAIz3B,QAAQ,CAACV,EAASC,KAQzB,GAPA4U,EAAa,OAAQwD,UAAW+f,IAC5B,MAAM,MAAEjiB,EAAK,QAAEC,GAAYgiB,EACrBC,EAAQliB,EAAmB,EAARgiB,GAAchiB,EAAQ,KAAS,KAAQ,EAC1DmiB,EAAUliB,EAAqB,EAAR+hB,GAAc/hB,EAAU,KAAS,KAAQ,EACtEpW,EAAQ,CAAEmW,QAAOC,UAASiiB,MAAOA,EAAME,QAAQ,GAAID,QAASA,EAAQC,QAAQ,MAC7Ex3B,KAAK8V,MACRshB,EAAQ9tB,OAAO8tB,IACVA,EACD,OAAOl4B,EAAO,8BAA8Bk4B,GAEhDp3B,KAAKw2B,WAAW,QAAQY,GACxB,IAAIK,EAAQL,EAAQ,KAChBA,EAAQ,MACRK,IAEJ,MAAMC,EAAO,IAAIC,OAAO,MACxB,IAAK,IAAI1yB,EAAI,EAAGA,EAAIwyB,EAAOxyB,IACvBjF,KAAKw2B,WAAW,QAAQkB,GAE5B13B,KAAKw2B,WAAW,UAGxB,aACI,OAAOlY,KAAaG,MAAMhf,IACtB2U,EAAQ,OAAQiQ,WAAY5kB,EAAOO,KAAK8V,MACjC,KAGf,kBACI,OAAOwI,GAAWvC,GAAWsC,OAAOI,MAAMhf,IACtC2U,EAAQ,OAAQiQ,WAAY5kB,EAAOO,KAAK8V,MACjC,KAGf,oBACI,OAAOwI,GAAWvC,GAAWqC,SAASK,MAAMhf,IACxC2U,EAAQ,OAAQiQ,WAAY5kB,EAAOO,KAAK8V,MACjC,KAGf,qBACI,OAAOwI,GAAWvC,GAAW6b,UAAUnZ,MAAMhf,IACzC2U,EAAQ,OAAQiQ,WAAY5kB,EAAOO,KAAK8V,MACjC,KAGf,iBAAiBQ,EAAIwI,EAAOX,GACxB,OAAO4B,GAAezJ,EAAIwI,EAAOX,GAErC,iBACI,OAAO,GAAUne,UAAM,OAAQ,GAAQ,YACnC0H,EAAA,KAAO2B,KAAK,8DACZ,MAAMwuB,EAAQ,GACd,CAAC,aAAc,aAAc,eAAe1X,IAAKhC,IAC7C0Z,EAAM1Z,GAAQ,GACd3V,OAAOsD,eAAe+rB,EAAM1Z,GAAO,UAAW,CAC1C3e,MAAO,WACH,OAAOgJ,OAAOC,KAAKzI,MAAMmgB,IAAIkC,GAAKriB,KAAKqiB,SAInD,MAAM7D,QAAgBxe,KAAKse,aAO3B,OANAE,EAAQ3Q,QAASyL,IACTue,EAAMxsB,eAAeiO,EAAE6E,QACvB0Z,EAAMve,EAAE6E,MAAM7E,EAAEsE,UAAYtE,KAGpCtZ,KAAK82B,SAAWe,EACT73B,KAAKwe,WAGpB,cACI,OAAOxe,KAAK82B,UAAY,GAE5B,qBAAqBlZ,GACjB,OAAO,GAAU5d,UAAM,OAAQ,GAAQ,YACnC,IACI,aAAamf,GAAgBvB,GAEjC,MAAOne,GACH,MAAMA,MAIlB,mBAEI,OADAiI,EAAA,KAAO2B,KAAK,qEACLrJ,KAAK82B,SAASgB,YAAc,GAEvC,qBAEI,OADApwB,EAAA,KAAO2B,KAAK,uEACLrJ,KAAK82B,SAASiB,YAAc,GAEvC,sBAEI,OADArwB,EAAA,KAAO2B,KAAK,wEACLrJ,KAAK82B,SAASkB,aAAe,GAExC,uBACI,MAAO,CAAE1c,MAAOtb,KAAK+2B,kBAAmBxb,MAAOvb,KAAKg3B,mBAExD,iBAAiBiB,GACb,OAAO,GAAUj4B,UAAM,OAAQ,GAAQ,YACnC,MAAM,MAAEua,EAAK,SAAEuF,GAAamY,EAAUtb,EAAc,GAAOsb,EAAU,CAAC,QAAS,aAK/E,OAJA/X,GAA6BvD,GAC7B3c,KAAK+2B,wBAA0B3W,GAAyB7F,EAAOuF,EAAU,aAAcnD,GACvF3c,KAAKua,MAAQA,EACbva,KAAK8f,SAAWA,EACT9f,KAAK+2B,qBAGpB,oBACI/2B,KAAK+2B,mBAAoB,EAE7B,mBACI/2B,KAAK+2B,mBAAoB,EAE7B,iBAAiBkB,GACb,OAAO,GAAUj4B,UAAM,OAAQ,GAAQ,YACnC,MAAM,MAAEsa,EAAK,SAAE0F,GAAaiY,EAAUtb,EAAc,GAAOsb,EAAU,CAAC,QAAS,aAK/E,OAJA/X,GAA6BvD,GAC7B3c,KAAKg3B,wBAA0B5W,GAAyB9F,EAAO0F,EAAU,aAAcrD,GACvF3c,KAAKsa,MAAQA,EACbta,KAAKggB,SAAWA,EACThgB,KAAKg3B,qBAGpB,gBACIh3B,KAAKg3B,mBAAoB,EAE7B,eACIh3B,KAAKg3B,mBAAoB,EAE7B,eAAekB,GAEPl4B,KAAK22B,YADc,mBAAZuB,EACYA,EAAU,CAAC,CAAEC,KAAM,CAAC,kCAAqC,GAGzDD,EAG3B,iBACI,OAAOl4B,KAAK22B,YAEhB,YAAY/Y,GACR5d,KAAKi3B,SAAWrZ,EAEpB,cACI,OAAO5d,KAAKi3B,SAEhB,iBAAiBrtB,GACb5J,KAAK42B,cAAgB,eAAkBhtB,GAE3C,mBACI,OAAO5J,KAAK42B,cAEhB,kBAAkBhtB,GACd5J,KAAK62B,eAAiB,eAAkBjtB,GAE5C,oBACI,OAAO5J,KAAK62B,eAEhB,gBAAe,OAAExsB,EAAQyX,QAASiP,EAAe,GAAE,KAAEnoB,IACjD,IAAKmoB,EACD,MAAM,IAAIviB,MAAM,kCAAoCuiB,GAExD,MAAM3a,EAAM,IAAI,GAAU,CAAEsS,OAAQ1oB,KAAKgY,UAAW+Y,eAAcnoB,SAC9DyB,IACA+L,EAAI6Z,aAAe5lB,GAEvBrK,KAAKiZ,QAAQ7C,GAAKqI,MAAMhf,GAASA,GAErC,gBAAe,OAAE4K,EAAQ8O,SAAU4X,EAAe,GAAE,QAAEzE,IAClD,OAAO,GAAUtsB,UAAM,OAAQ,GAAQ,YAEnC,GADA+wB,EAAeA,EAAarS,OAAOoD,GAAWA,IAAY9hB,KAAKosB,oBAAoBpsB,KAAK6Y,cAAeiJ,KAClGiP,EAAa7rB,OACd,MAAO,GAEX,MAAMkR,EAAM,IAAI,GAAU,CAAEsS,OAAQ1oB,KAAKgY,UAAW+Y,iBAChD1mB,IACA+L,EAAI6Z,aAAe5lB,GAEvB,MAAMD,QAAiBpK,KAAKiZ,QAAQ7C,IAC9B,aAAE8L,EAAe,GAAE,WAAEH,EAAa,IAAOE,GAA0B7X,GAKzE,OAJI8X,EAAahd,QACbgd,EAAarU,QAAQiU,GAAW9hB,KAAKg1B,oBAAoBh1B,KAAK6Y,cAAeiJ,IAEjFC,EAAWlU,QAAQiU,GAAW9hB,KAAKi1B,iBAAiBj1B,KAAK6Y,cAAeyT,EAASxK,IAC1E1X,KAGf,kBAAiB,OAAEC,EAAQ8O,SAAU4X,EAAe,KAChD,OAAO,GAAU/wB,UAAM,OAAQ,GAAQ,YAEnC,GADA+wB,EAAeA,EAAarS,OAAOoD,GAAWA,GAAW9hB,KAAKosB,oBAAoBpsB,KAAK6Y,cAAeiJ,KACjGiP,EAAa7rB,OACd,MAAO,GAEX,MAAMkR,EAAM,IAAI,GAAY,CAAEsS,OAAQ1oB,KAAKgY,UAAW+Y,iBAClD1mB,IACA+L,EAAI6Z,aAAe5lB,GAEvB,MAAMD,QAAiBpK,KAAKiZ,QAAQ7C,IAC9B,aAAE+L,EAAe,GAAE,cAAEC,EAAgB,IAAOH,GAA0B7X,GAG5E,OAFA+X,EAAatU,QAAQiU,GAAW9hB,KAAKg1B,oBAAoBh1B,KAAK6Y,cAAeiJ,IAC7EM,EAAcvU,QAAQiU,GAAW9hB,KAAKg1B,oBAAoBh1B,KAAK6Y,cAAeiJ,IACvE1X,MC9RnB,IAAI,GAAwC,SAAUxI,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMxC,GAAS,OAAOA,aAAiBsC,EAAItC,EAAQ,IAAIsC,GAAE,SAAU7C,GAAWA,EAAQO,MAC/F,OAAO,IAAKsC,IAAMA,EAAInC,WAAU,SAAUV,EAASC,GAC/C,SAAS+C,EAAUzC,GAAS,IAAM0C,EAAKH,EAAUI,KAAK3C,IAAW,MAAO4C,GAAKlD,EAAOkD,IACpF,SAASC,EAAS7C,GAAS,IAAM0C,EAAKH,EAAU,SAASvC,IAAW,MAAO4C,GAAKlD,EAAOkD,IACvF,SAASF,EAAKI,GAAUA,EAAO5C,KAAOT,EAAQqD,EAAO9C,OAASwC,EAAMM,EAAO9C,OAAOI,KAAKqC,EAAWI,GAClGH,GAAMH,EAAYA,EAAU5B,MAAMyB,EAASC,GAAc,KAAKM,YAOvD,MAAM,WAAmB,GACpC,QAAQgV,GACJ,IAAIf,EAAMe,EACV,GAAIA,aAAmB,EAAa,CAChC,MAAMI,EAAS,CAAEJ,QAASA,EAAQV,SAC9BU,EAAQ8Y,eACR1Y,EAAOhN,QAAU4M,EAAQ8Y,cAE7B7Z,EAAM,IAAI,EAAQ,CAAElM,SAAUlK,KAAK6Y,cAAetU,OAAQ,UAAWgT,WAEzE,OAAOU,MAAMgB,QAAQ7C,GAEzB,QAAQjD,GACJ,OAAO,GAAUnT,UAAM,OAAQ,GAAQ,YACnC,MAAM,kBAAE2Z,EAAoB,MAASxG,EACrC,IAAKwG,EACD,MAAM,IAAIlS,UAAU,iCAExB,MAAMtG,EAAO,IAAI,GAAKnB,KAAMmT,GAE5B,OADAhS,EAAKivB,SACEjvB,MC7BZ,MAAMi3B,GAAU,QACvBtgB,EAAa,kBAAkBsgB,K,kCCJ/B,IAAIC,EAAI,EAAQ,QACZC,EAAc,EAAQ,QACtBC,EAAgB,EAAQ,QACxBC,EAAkB,EAAQ,QAC1BC,EAAsB,EAAQ,QAE9BC,EAAUJ,EAAY,GAAGrlB,MAEzB0lB,EAAcJ,GAAiB/vB,OAC/BowB,EAAgBH,EAAoB,OAAQ,KAIhDJ,EAAE,CAAEQ,OAAQ,QAASC,OAAO,EAAMC,OAAQJ,IAAgBC,GAAiB,CACzE3lB,KAAM,SAAc+lB,GAClB,OAAON,EAAQF,EAAgBx4B,WAAqBK,IAAd24B,EAA0B,IAAMA,O,kCCf1E,IAAIX,EAAI,EAAQ,QACZY,EAAY,EAAQ,QAA+Bha,SACnDia,EAAmB,EAAQ,QAI/Bb,EAAE,CAAEQ,OAAQ,QAASC,OAAO,GAAQ,CAClC7Z,SAAU,SAAkBka,GAC1B,OAAOF,EAAUj5B,KAAMm5B,EAAIj5B,UAAUgF,OAAS,EAAIhF,UAAU,QAAKG,MAKrE64B,EAAiB","file":"js/vendors~layout.js","sourcesContent":["export const STORAGE_PREFIX = '@signalwire:';\nexport const ADD = 'add';\nexport const REMOVE = 'remove';\nexport const SESSION_ID = 'sessId';\nexport var SwEvent;\n(function (SwEvent) {\n    SwEvent[\"SocketOpen\"] = \"signalwire.socket.open\";\n    SwEvent[\"SocketClose\"] = \"signalwire.socket.close\";\n    SwEvent[\"SocketError\"] = \"signalwire.socket.error\";\n    SwEvent[\"SocketMessage\"] = \"signalwire.socket.message\";\n    SwEvent[\"SpeedTest\"] = \"signalwire.internal.speedtest\";\n    SwEvent[\"Ready\"] = \"signalwire.ready\";\n    SwEvent[\"Error\"] = \"signalwire.error\";\n    SwEvent[\"Notification\"] = \"signalwire.notification\";\n    SwEvent[\"Messages\"] = \"signalwire.messages\";\n    SwEvent[\"Calls\"] = \"signalwire.calls\";\n    SwEvent[\"MediaError\"] = \"signalwire.rtc.mediaError\";\n})(SwEvent || (SwEvent = {}));\nexport var BladeMethod;\n(function (BladeMethod) {\n    BladeMethod[\"Broadcast\"] = \"blade.broadcast\";\n    BladeMethod[\"Disconnect\"] = \"blade.disconnect\";\n})(BladeMethod || (BladeMethod = {}));\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","'use strict';\nvar PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar redefine = require('../internals/redefine');\nvar anObject = require('../internals/an-object');\nvar $toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar getRegExpFlags = require('../internals/regexp-get-flags');\n\nvar TO_STRING = 'toString';\nvar RegExpPrototype = RegExp.prototype;\nvar n$ToString = RegExpPrototype[TO_STRING];\n\nvar NOT_GENERIC = fails(function () { return n$ToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });\n// FF44- RegExp#toString has a wrong name\nvar INCORRECT_NAME = PROPER_FUNCTION_NAME && n$ToString.name != TO_STRING;\n\n// `RegExp.prototype.toString` method\n// https://tc39.es/ecma262/#sec-regexp.prototype.tostring\nif (NOT_GENERIC || INCORRECT_NAME) {\n  redefine(RegExp.prototype, TO_STRING, function toString() {\n    var R = anObject(this);\n    var pattern = $toString(R.source);\n    var flags = $toString(getRegExpFlags(R));\n    return '/' + pattern + '/' + flags;\n  }, { unsafe: true });\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { mutateStorageKey, safeParseJson } from '../helpers';\nconst _inNode = () => typeof window === 'undefined' && typeof process !== 'undefined';\nconst _get = (storageType, key) => __awaiter(void 0, void 0, void 0, function* () {\n    if (_inNode())\n        return null;\n    const res = window[storageType].getItem(mutateStorageKey(key));\n    return safeParseJson(res);\n});\nconst _set = (storageType, key, value) => __awaiter(void 0, void 0, void 0, function* () {\n    if (_inNode())\n        return null;\n    if (typeof value === 'object') {\n        value = JSON.stringify(value);\n    }\n    window[storageType].setItem(mutateStorageKey(key), value);\n});\nconst _remove = (storageType, key) => __awaiter(void 0, void 0, void 0, function* () {\n    if (_inNode())\n        return null;\n    return window[storageType].removeItem(mutateStorageKey(key));\n});\nexport const localStorage = {\n    getItem: (key) => _get('localStorage', key),\n    setItem: (key, value) => _set('localStorage', key, value),\n    removeItem: (key) => _remove('localStorage', key),\n};\nexport const sessionStorage = {\n    getItem: (key) => _get('sessionStorage', key),\n    setItem: (key, value) => _set('sessionStorage', key, value),\n    removeItem: (key) => _remove('sessionStorage', key),\n};\n","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn't print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don't have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === 'trace' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods(level, loggerName) {\n        /*jshint validthis:true */\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, loggerName);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this, level, loggerName);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, level, loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, defaultLevel, factory) {\n      var self = this;\n      var currentLevel;\n      defaultLevel = defaultLevel == null ? \"WARN\" : defaultLevel;\n\n      var storageKey = \"loglevel\";\n      if (typeof name === \"string\") {\n        storageKey += \":\" + name;\n      } else if (typeof name === \"symbol\") {\n        storageKey = undefined;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var location = cookie.indexOf(\n                      encodeURIComponent(storageKey) + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      function clearPersistedLevel() {\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage.removeItem(storageKey);\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=; expires=Thu, 01 Jan 1970 00:00:00 UTC\";\n          } catch (ignore) {}\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          return currentLevel;\n      };\n\n      self.setLevel = function (level, persist) {\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              currentLevel = level;\n              if (persist !== false) {  // defaults to true\n                  persistLevelIfPossible(level);\n              }\n              replaceLoggingMethods.call(self, level, name);\n              if (typeof console === undefinedType && level < self.levels.SILENT) {\n                  return \"No console available for logging\";\n              }\n          } else {\n              throw \"log.setLevel() called with invalid level: \" + level;\n          }\n      };\n\n      self.setDefaultLevel = function (level) {\n          defaultLevel = level;\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.resetLevel = function () {\n          self.setLevel(defaultLevel, false);\n          clearPersistedLevel();\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      // Initialize with the right level\n      var initialLevel = getPersistedLevel();\n      if (initialLevel == null) {\n          initialLevel = defaultLevel;\n      }\n      self.setLevel(initialLevel, false);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    var defaultLogger = new Logger();\n\n    var _loggersByName = {};\n    defaultLogger.getLogger = function getLogger(name) {\n        if ((typeof name !== \"symbol\" && typeof name !== \"string\") || name === \"\") {\n          throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n          logger = _loggersByName[name] = new Logger(\n            name, defaultLogger.getLevel(), defaultLogger.methodFactory);\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    // ES6 default export, for compatibility\n    defaultLogger['default'] = defaultLogger;\n\n    return defaultLogger;\n}));\n","import log from 'loglevel';\nconst datetime = () => new Date().toISOString().replace('T', ' ').replace('Z', '');\nconst logger = log.getLogger('signalwire');\nconst originalFactory = logger.methodFactory;\nlogger.methodFactory = (methodName, logLevel, loggerName) => {\n    const rawMethod = originalFactory(methodName, logLevel, loggerName);\n    return function () {\n        const messages = [datetime(), '-'];\n        for (let i = 0; i < arguments.length; i++) {\n            messages.push(arguments[i]);\n        }\n        rawMethod.apply(undefined, messages);\n    };\n};\nlogger.setLevel(logger.getLevel());\nexport default logger;\n","import logger from './logger';\nimport { STORAGE_PREFIX } from './constants';\nexport const deepCopy = (obj) => JSON.parse(JSON.stringify(obj));\nexport const objEmpty = (obj) => Object.keys(obj).length === 0;\nexport const mutateStorageKey = (key) => `${STORAGE_PREFIX}${key}`;\nexport const mutateLiveArrayData = (data) => {\n    const [participantId, participantNumber, participantName, codec, mediaJson, participantData] = data;\n    let media = {};\n    try {\n        media = JSON.parse(mediaJson.replace(/ID\"/g, 'Id\"'));\n    }\n    catch (error) {\n        logger.warn('Verto LA invalid media JSON string:', mediaJson);\n    }\n    return { participantId: Number(participantId), participantNumber, participantName, codec, media, participantData };\n};\nexport const safeParseJson = (value) => {\n    if (typeof value !== 'string') {\n        return value;\n    }\n    try {\n        return JSON.parse(value);\n    }\n    catch (error) {\n        return value;\n    }\n};\nexport const isDefined = (variable) => typeof variable !== 'undefined';\nexport const isFunction = (variable) => variable instanceof Function || typeof variable === 'function';\nexport const findElementByType = (tag) => {\n    if (typeof document !== 'object' || !('getElementById' in document)) {\n        return null;\n    }\n    if (typeof tag === 'string') {\n        return document.getElementById(tag) || null;\n    }\n    else if (typeof tag === 'function') {\n        return tag();\n    }\n    else if (tag instanceof HTMLMediaElement) {\n        return tag;\n    }\n    return null;\n};\nconst PROTOCOL_PATTERN = /^(ws|wss):\\/\\//;\nexport const checkWebSocketHost = (host) => {\n    const protocol = PROTOCOL_PATTERN.test(host) ? '' : 'wss://';\n    return `${protocol}${host}`;\n};\nexport const destructResponse = (response, nodeId = null) => {\n    const { result = {}, error } = response;\n    if (error) {\n        return { error };\n    }\n    const { result: nestedResult = null } = result;\n    if (nestedResult === null) {\n        if (nodeId !== null) {\n            result.node_id = nodeId;\n        }\n        return { result };\n    }\n    const { code = null, node_id = null, result: vertoResult = null } = nestedResult;\n    if (code && code !== '200') {\n        return { error: nestedResult };\n    }\n    if (vertoResult) {\n        return destructResponse(vertoResult, node_id);\n    }\n    return { result: nestedResult };\n};\nexport const randomInt = (min, max) => {\n    return Math.floor(Math.random() * (max - min + 1) + min);\n};\n","var call = require('../internals/function-call');\nvar hasOwn = require('../internals/has-own-property');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar regExpFlags = require('../internals/regexp-flags');\n\nvar RegExpPrototype = RegExp.prototype;\n\nmodule.exports = function (R) {\n  var flags = R.flags;\n  return flags === undefined && !('flags' in RegExpPrototype) && !hasOwn(R, 'flags') && isPrototypeOf(RegExpPrototype, R)\n    ? call(regExpFlags, R) : flags;\n};\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  define(Gp, \"constructor\", GeneratorFunctionPrototype);\n  define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction);\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n// find the complete implementation of crypto (msCrypto) on IE11.\nvar getRandomValues = typeof crypto != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto != 'undefined' && typeof msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto);\nvar rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\nexport default function rng() {\n  if (!getRandomValues) {\n    throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n  }\n\n  return getRandomValues(rnds8);\n}","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex; // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n\n  return [bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]]].join('');\n}\n\nexport default bytesToUuid;","import rng from './rng.js';\nimport bytesToUuid from './bytesToUuid.js';\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof options == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nexport default v4;","import { objEmpty, isFunction } from '../util/helpers';\nconst GLOBAL = 'GLOBAL';\nconst queue = {};\nconst isQueued = (eventName, uniqueId = GLOBAL) => queue.hasOwnProperty(eventName) && queue[eventName].hasOwnProperty(uniqueId);\nconst queueLength = (eventName, uniqueId = GLOBAL) => {\n    if (!isQueued(eventName, uniqueId)) {\n        return 0;\n    }\n    return queue[eventName][uniqueId].length;\n};\nconst register = (eventName, callback, uniqueId = GLOBAL) => {\n    if (!queue.hasOwnProperty(eventName)) {\n        queue[eventName] = {};\n    }\n    if (!queue[eventName].hasOwnProperty(uniqueId)) {\n        queue[eventName][uniqueId] = [];\n    }\n    queue[eventName][uniqueId].push(callback);\n};\nconst registerOnce = (eventName, callback, uniqueId = GLOBAL) => {\n    const cb = function (data) {\n        deRegister(eventName, cb, uniqueId);\n        callback(data);\n    };\n    cb.prototype.targetRef = callback;\n    return register(eventName, cb, uniqueId);\n};\nconst deRegister = (eventName, callback, uniqueId = GLOBAL) => {\n    if (!isQueued(eventName, uniqueId)) {\n        return false;\n    }\n    if (isFunction(callback)) {\n        const len = queue[eventName][uniqueId].length;\n        for (let i = len - 1; i >= 0; i--) {\n            const fn = queue[eventName][uniqueId][i];\n            if (callback === fn || (fn.prototype && callback === fn.prototype.targetRef)) {\n                queue[eventName][uniqueId].splice(i, 1);\n            }\n        }\n    }\n    else {\n        queue[eventName][uniqueId] = [];\n    }\n    if (queue[eventName][uniqueId].length === 0) {\n        delete queue[eventName][uniqueId];\n        if (objEmpty(queue[eventName])) {\n            delete queue[eventName];\n        }\n    }\n    return true;\n};\nconst trigger = (eventName, data, uniqueId = GLOBAL, globalPropagation = true) => {\n    const _propagate = globalPropagation && uniqueId !== GLOBAL;\n    if (!isQueued(eventName, uniqueId)) {\n        if (_propagate) {\n            trigger(eventName, data);\n        }\n        return false;\n    }\n    const len = queue[eventName][uniqueId].length;\n    if (!len) {\n        if (_propagate) {\n            trigger(eventName, data);\n        }\n        return false;\n    }\n    for (let i = len - 1; i >= 0; i--) {\n        queue[eventName][uniqueId][i](data);\n    }\n    if (_propagate) {\n        trigger(eventName, data);\n    }\n    return true;\n};\nconst deRegisterAll = (eventName) => {\n    delete queue[eventName];\n};\nexport { trigger, register, registerOnce, deRegister, deRegisterAll, isQueued, queueLength };\n","import logger from '../util/logger';\nimport { SwEvent } from '../util/constants';\nimport { safeParseJson, checkWebSocketHost, destructResponse } from '../util/helpers';\nimport { registerOnce, trigger } from '../services/Handler';\nimport { isFunction } from '../util/helpers';\nlet WebSocketClass = typeof WebSocket !== 'undefined' ? WebSocket : null;\nexport const setWebSocket = (websocket) => {\n    WebSocketClass = websocket;\n};\nconst WS_STATE = {\n    CONNECTING: 0,\n    OPEN: 1,\n    CLOSING: 2,\n    CLOSED: 3\n};\nconst TIMEOUT_MS = 10 * 1000;\nexport default class Connection {\n    constructor(session) {\n        this.session = session;\n        this._wsClient = null;\n        this._host = 'wss://relay.signalwire.com';\n        this._timers = {};\n        this.upDur = null;\n        this.downDur = null;\n        const { host } = session.options;\n        if (host) {\n            this._host = checkWebSocketHost(host);\n        }\n    }\n    get connected() {\n        return this._wsClient && this._wsClient.readyState === WS_STATE.OPEN;\n    }\n    get connecting() {\n        return this._wsClient && this._wsClient.readyState === WS_STATE.CONNECTING;\n    }\n    get closing() {\n        return this._wsClient && this._wsClient.readyState === WS_STATE.CLOSING;\n    }\n    get closed() {\n        return this._wsClient && this._wsClient.readyState === WS_STATE.CLOSED;\n    }\n    get isAlive() {\n        return this.connecting || this.connected;\n    }\n    get isDead() {\n        return this.closing || this.closed;\n    }\n    connect() {\n        this._wsClient = new WebSocketClass(this._host);\n        this._wsClient.onopen = (event) => trigger(SwEvent.SocketOpen, event, this.session.uuid);\n        this._wsClient.onclose = (event) => trigger(SwEvent.SocketClose, event, this.session.uuid);\n        this._wsClient.onerror = (event) => trigger(SwEvent.SocketError, event, this.session.uuid);\n        this._wsClient.onmessage = (event) => {\n            const msg = safeParseJson(event.data);\n            if (typeof msg === 'string') {\n                this._handleStringResponse(msg);\n                return;\n            }\n            this._unsetTimer(msg.id);\n            logger.debug('RECV: \\n', JSON.stringify(msg, null, 2), '\\n');\n            if (!trigger(msg.id, msg)) {\n                trigger(SwEvent.SocketMessage, msg, this.session.uuid);\n            }\n        };\n    }\n    sendRawText(request) {\n        this._wsClient.send(request);\n    }\n    send(bladeObj) {\n        const { request } = bladeObj;\n        const promise = new Promise((resolve, reject) => {\n            if (request.hasOwnProperty('result')) {\n                return resolve();\n            }\n            registerOnce(request.id, (response) => {\n                const { result, error } = destructResponse(response);\n                return error ? reject(error) : resolve(result);\n            });\n            this._setTimer(request.id);\n        });\n        logger.debug('SEND: \\n', JSON.stringify(request, null, 2), '\\n');\n        this._wsClient.send(JSON.stringify(request));\n        return promise;\n    }\n    close() {\n        if (this._wsClient) {\n            isFunction(this._wsClient._beginClose) ? this._wsClient._beginClose() : this._wsClient.close();\n        }\n        this._wsClient = null;\n    }\n    _unsetTimer(id) {\n        clearTimeout(this._timers[id]);\n        delete this._timers[id];\n    }\n    _setTimer(id) {\n        this._timers[id] = setTimeout(() => {\n            trigger(id, { error: { code: this.session.timeoutErrorCode, message: 'Timeout' } });\n            this._unsetTimer(id);\n        }, TIMEOUT_MS);\n    }\n    _handleStringResponse(response) {\n        if (/^#SP/.test(response)) {\n            switch (response[3]) {\n                case 'U':\n                    this.upDur = parseInt(response.substring(4));\n                    break;\n                case 'D':\n                    this.downDur = parseInt(response.substring(4));\n                    trigger(SwEvent.SpeedTest, { upDur: this.upDur, downDur: this.downDur }, this.session.uuid);\n                    break;\n            }\n        }\n        else {\n            logger.warn('Unknown message from socket', response);\n        }\n    }\n}\n","import { v4 as uuidv4 } from 'uuid';\nclass BaseMessage {\n    buildRequest(params) {\n        this.request = Object.assign({ jsonrpc: '2.0', id: uuidv4() }, params);\n    }\n}\nexport default BaseMessage;\n","import BaseMessage from '../BaseMessage';\nconst major = 2;\nconst minor = 1;\nconst revision = 0;\nlet agent = null;\nconst setAgentName = (name) => {\n    agent = name;\n};\nclass Connect extends BaseMessage {\n    constructor(authentication, sessionid) {\n        super();\n        this.method = 'blade.connect';\n        const params = {\n            version: { major, minor, revision },\n            authentication: authentication\n        };\n        if (sessionid) {\n            params.sessionid = sessionid;\n        }\n        if (agent) {\n            params.agent = agent;\n        }\n        this.buildRequest({ method: this.method, params });\n    }\n}\nexport { Connect, setAgentName };\n","import BaseMessage from '../BaseMessage';\nclass Execute extends BaseMessage {\n    constructor(params, id = '') {\n        super();\n        this.method = 'blade.execute';\n        let tmp;\n        if (params.hasOwnProperty('result')) {\n            tmp = { result: params };\n        }\n        else {\n            tmp = { method: this.method, params };\n        }\n        if (id) {\n            tmp.id = id;\n        }\n        this.buildRequest(tmp);\n    }\n}\nexport { Execute };\n","import BaseMessage from '../BaseMessage';\nclass Subscription extends BaseMessage {\n    constructor(params) {\n        super();\n        this.method = 'blade.subscription';\n        if (params.hasOwnProperty('auto_create') && !params.auto_create) {\n            delete params.auto_create;\n        }\n        if (params.hasOwnProperty('downstream') && !params.downstream) {\n            delete params.downstream;\n        }\n        this.buildRequest({ method: this.method, params });\n    }\n}\nexport { Subscription };\n","import BaseMessage from '../BaseMessage';\nclass Reauthenticate extends BaseMessage {\n    constructor(project, jwt_token, sessionid) {\n        super();\n        this.method = 'blade.reauthenticate';\n        const params = { sessionid, authentication: { project, jwt_token } };\n        this.buildRequest({ method: this.method, params });\n    }\n}\nexport { Reauthenticate };\n","import BaseMessage from '../BaseMessage';\nclass Ping extends BaseMessage {\n    constructor() {\n        super();\n        this.method = 'blade.ping';\n        this.buildRequest({ method: this.method, params: {} });\n    }\n}\nexport { Ping };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport logger from '../util/logger';\nimport { Execute } from '../messages/Blade';\nimport { sessionStorage } from '../util/storage/';\nconst SETUP_PROTOCOL = 'signalwire';\nconst SETUP_METHOD = 'setup';\nconst SETUP_CHANNEL = 'notifications';\nexport default (session) => __awaiter(void 0, void 0, void 0, function* () {\n    const params = {};\n    const { signature, relayProtocol } = session;\n    if (relayProtocol && relayProtocol.split('_')[1] === signature) {\n        params.protocol = relayProtocol;\n    }\n    else {\n        const prevProtocol = yield sessionStorage.getItem(signature);\n        if (prevProtocol) {\n            params.protocol = prevProtocol;\n        }\n    }\n    const be = new Execute({ protocol: SETUP_PROTOCOL, method: SETUP_METHOD, params });\n    const { protocol = null } = yield session.execute(be);\n    if (protocol) {\n        yield session.subscribe({ protocol, channels: [SETUP_CHANNEL] });\n        yield sessionStorage.setItem(signature, protocol);\n    }\n    else {\n        logger.error('Error during setup the session protocol.');\n    }\n    return protocol;\n});\n","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport BaseMessage from '../BaseMessage';\nconst tmpMap = {\n    id: 'callID',\n    destinationNumber: 'destination_number',\n    remoteCallerName: 'remote_caller_id_name',\n    remoteCallerNumber: 'remote_caller_id_number',\n    callerName: 'caller_id_name',\n    callerNumber: 'caller_id_number'\n};\nexport default class BaseRequest extends BaseMessage {\n    constructor(params = {}) {\n        super();\n        if (params.hasOwnProperty('dialogParams')) {\n            const _a = params.dialogParams, { remoteSdp, localStream, remoteStream, onNotification, camId, micId, speakerId } = _a, dialogParams = __rest(_a, [\"remoteSdp\", \"localStream\", \"remoteStream\", \"onNotification\", \"camId\", \"micId\", \"speakerId\"]);\n            for (const key in tmpMap) {\n                if (key && dialogParams.hasOwnProperty(key)) {\n                    dialogParams[tmpMap[key]] = dialogParams[key];\n                    delete dialogParams[key];\n                }\n            }\n            params.dialogParams = dialogParams;\n        }\n        this.buildRequest({ method: this.toString(), params });\n    }\n}\n","import BaseRequest from './BaseRequest';\nclass Result extends BaseRequest {\n    constructor(id, method) {\n        super();\n        this.buildRequest({ id, result: { method } });\n    }\n}\nexport { Result };\n","export var PeerType;\n(function (PeerType) {\n    PeerType[\"Offer\"] = \"offer\";\n    PeerType[\"Answer\"] = \"answer\";\n})(PeerType || (PeerType = {}));\nexport var Direction;\n(function (Direction) {\n    Direction[\"Inbound\"] = \"inbound\";\n    Direction[\"Outbound\"] = \"outbound\";\n})(Direction || (Direction = {}));\nexport var VertoMethod;\n(function (VertoMethod) {\n    VertoMethod[\"Invite\"] = \"verto.invite\";\n    VertoMethod[\"Attach\"] = \"verto.attach\";\n    VertoMethod[\"Answer\"] = \"verto.answer\";\n    VertoMethod[\"Info\"] = \"verto.info\";\n    VertoMethod[\"Display\"] = \"verto.display\";\n    VertoMethod[\"Media\"] = \"verto.media\";\n    VertoMethod[\"Event\"] = \"verto.event\";\n    VertoMethod[\"Bye\"] = \"verto.bye\";\n    VertoMethod[\"Punt\"] = \"verto.punt\";\n    VertoMethod[\"Broadcast\"] = \"verto.broadcast\";\n    VertoMethod[\"Subscribe\"] = \"verto.subscribe\";\n    VertoMethod[\"Unsubscribe\"] = \"verto.unsubscribe\";\n    VertoMethod[\"ClientReady\"] = \"verto.clientReady\";\n    VertoMethod[\"Modify\"] = \"verto.modify\";\n})(VertoMethod || (VertoMethod = {}));\nexport const NOTIFICATION_TYPE = {\n    generic: 'event',\n    [VertoMethod.Display]: 'participantData',\n    [VertoMethod.Attach]: 'participantData',\n    conferenceUpdate: 'conferenceUpdate',\n    callUpdate: 'callUpdate',\n    vertoClientReady: 'vertoClientReady',\n    userMediaError: 'userMediaError',\n    refreshToken: 'refreshToken',\n};\nexport const DEFAULT_CALL_OPTIONS = {\n    destinationNumber: '',\n    remoteCallerName: 'Outbound Call',\n    remoteCallerNumber: '',\n    callerName: '',\n    callerNumber: '',\n    audio: true,\n    video: false,\n    useStereo: false,\n    attach: false,\n    screenShare: false,\n    userVariables: {},\n};\nexport var State;\n(function (State) {\n    State[State[\"New\"] = 0] = \"New\";\n    State[State[\"Requesting\"] = 1] = \"Requesting\";\n    State[State[\"Trying\"] = 2] = \"Trying\";\n    State[State[\"Recovering\"] = 3] = \"Recovering\";\n    State[State[\"Ringing\"] = 4] = \"Ringing\";\n    State[State[\"Answering\"] = 5] = \"Answering\";\n    State[State[\"Early\"] = 6] = \"Early\";\n    State[State[\"Active\"] = 7] = \"Active\";\n    State[State[\"Held\"] = 8] = \"Held\";\n    State[State[\"Hangup\"] = 9] = \"Hangup\";\n    State[State[\"Destroy\"] = 10] = \"Destroy\";\n    State[State[\"Purge\"] = 11] = \"Purge\";\n})(State || (State = {}));\nexport var Role;\n(function (Role) {\n    Role[\"Participant\"] = \"participant\";\n    Role[\"Moderator\"] = \"moderator\";\n})(Role || (Role = {}));\nexport var ConferenceAction;\n(function (ConferenceAction) {\n    ConferenceAction[\"Join\"] = \"join\";\n    ConferenceAction[\"Leave\"] = \"leave\";\n    ConferenceAction[\"Bootstrap\"] = \"bootstrap\";\n    ConferenceAction[\"Add\"] = \"add\";\n    ConferenceAction[\"Modify\"] = \"modify\";\n    ConferenceAction[\"Delete\"] = \"delete\";\n    ConferenceAction[\"Clear\"] = \"clear\";\n    ConferenceAction[\"ChatMessage\"] = \"chatMessage\";\n    ConferenceAction[\"LayerInfo\"] = \"layerInfo\";\n    ConferenceAction[\"LogoInfo\"] = \"logoInfo\";\n    ConferenceAction[\"LayoutInfo\"] = \"layoutInfo\";\n    ConferenceAction[\"LayoutList\"] = \"layoutList\";\n    ConferenceAction[\"ModCmdResponse\"] = \"modCommandResponse\";\n})(ConferenceAction || (ConferenceAction = {}));\nexport var DeviceType;\n(function (DeviceType) {\n    DeviceType[\"Video\"] = \"videoinput\";\n    DeviceType[\"AudioIn\"] = \"audioinput\";\n    DeviceType[\"AudioOut\"] = \"audiooutput\";\n})(DeviceType || (DeviceType = {}));\n","import BaseRequest from './verto/BaseRequest';\nimport { Login } from './verto/Login';\nimport { Result } from './verto/Result';\nimport { VertoMethod } from '../webrtc/constants';\nclass Invite extends BaseRequest {\n    toString() {\n        return VertoMethod.Invite;\n    }\n}\nclass Answer extends BaseRequest {\n    toString() {\n        return VertoMethod.Answer;\n    }\n}\nclass Attach extends BaseRequest {\n    toString() {\n        return VertoMethod.Attach;\n    }\n}\nclass Bye extends BaseRequest {\n    toString() {\n        return VertoMethod.Bye;\n    }\n}\nclass Modify extends BaseRequest {\n    toString() {\n        return VertoMethod.Modify;\n    }\n}\nclass Info extends BaseRequest {\n    toString() {\n        return VertoMethod.Info;\n    }\n}\nclass Broadcast extends BaseRequest {\n    toString() {\n        return VertoMethod.Broadcast;\n    }\n}\nclass Subscribe extends BaseRequest {\n    toString() {\n        return VertoMethod.Subscribe;\n    }\n}\nclass Unsubscribe extends BaseRequest {\n    toString() {\n        return VertoMethod.Unsubscribe;\n    }\n}\nexport { Login, Invite, Answer, Attach, Bye, Modify, Info, Broadcast, Subscribe, Unsubscribe, Result };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { findElementByType } from '../helpers';\nconst RTCPeerConnection = (config) => new window.RTCPeerConnection(config);\nconst getUserMedia = (constraints) => navigator.mediaDevices.getUserMedia(constraints);\nconst getDisplayMedia = (constraints) => navigator.mediaDevices.getDisplayMedia(constraints);\nconst enumerateDevices = () => navigator.mediaDevices.enumerateDevices();\nconst getSupportedConstraints = () => navigator.mediaDevices.getSupportedConstraints();\nconst streamIsValid = (stream) => stream && stream instanceof MediaStream;\nconst attachMediaStream = (tag, stream) => {\n    const element = findElementByType(tag);\n    if (element === null) {\n        return;\n    }\n    if (!element.getAttribute('autoplay')) {\n        element.setAttribute('autoplay', 'autoplay');\n    }\n    if (!element.getAttribute('playsinline')) {\n        element.setAttribute('playsinline', 'playsinline');\n    }\n    element.srcObject = stream;\n};\nconst detachMediaStream = (tag) => {\n    const element = findElementByType(tag);\n    if (element) {\n        element.srcObject = null;\n    }\n};\nconst muteMediaElement = (tag) => {\n    const element = findElementByType(tag);\n    if (element) {\n        element.muted = true;\n    }\n};\nconst unmuteMediaElement = (tag) => {\n    const element = findElementByType(tag);\n    if (element) {\n        element.muted = false;\n    }\n};\nconst toggleMuteMediaElement = (tag) => {\n    const element = findElementByType(tag);\n    if (element) {\n        element.muted = !element.muted;\n    }\n};\nconst setMediaElementSinkId = (tag, deviceId) => __awaiter(void 0, void 0, void 0, function* () {\n    const element = findElementByType(tag);\n    if (element === null) {\n        return false;\n    }\n    try {\n        yield element.setSinkId(deviceId);\n        return true;\n    }\n    catch (error) {\n        return false;\n    }\n});\nconst sdpToJsonHack = sdp => sdp;\nconst stopStream = (stream) => {\n    if (streamIsValid(stream)) {\n        stream.getTracks().forEach(t => t.stop());\n    }\n    stream = null;\n};\nexport { RTCPeerConnection, getUserMedia, getDisplayMedia, enumerateDevices, getSupportedConstraints, streamIsValid, attachMediaStream, detachMediaStream, sdpToJsonHack, stopStream, muteMediaElement, unmuteMediaElement, toggleMuteMediaElement, setMediaElementSinkId };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport logger from '../util/logger';\nimport * as WebRTC from '../util/webrtc';\nimport { isDefined } from '../util/helpers';\nimport { DeviceType } from './constants';\nconst getUserMedia = (constraints) => __awaiter(void 0, void 0, void 0, function* () {\n    logger.info('RTCService.getUserMedia', constraints);\n    const { audio, video } = constraints;\n    if (!audio && !video) {\n        return null;\n    }\n    try {\n        return yield WebRTC.getUserMedia(constraints);\n    }\n    catch (error) {\n        logger.error('getUserMedia error: ', error);\n        throw error;\n    }\n});\nconst _constraintsByKind = (kind = null) => {\n    return {\n        audio: !kind || kind === DeviceType.AudioIn,\n        video: !kind || kind === DeviceType.Video\n    };\n};\nconst getDevices = (kind = null, fullList = false) => __awaiter(void 0, void 0, void 0, function* () {\n    let devices = yield WebRTC.enumerateDevices().catch(error => []);\n    if (kind) {\n        devices = devices.filter((d) => d.kind === kind);\n    }\n    const valid = devices.length && devices.every((d) => (d.deviceId && d.label));\n    if (!valid) {\n        const stream = yield WebRTC.getUserMedia(_constraintsByKind(kind));\n        WebRTC.stopStream(stream);\n        return getDevices(kind);\n    }\n    if (fullList === true) {\n        return devices;\n    }\n    const found = [];\n    devices = devices.filter(({ kind, groupId }) => {\n        if (!groupId) {\n            return true;\n        }\n        const key = `${kind}-${groupId}`;\n        if (!found.includes(key)) {\n            found.push(key);\n            return true;\n        }\n        return false;\n    });\n    return devices;\n});\nconst resolutionList = [[320, 240], [640, 360], [640, 480], [1280, 720], [1920, 1080]];\nconst scanResolutions = (deviceId) => __awaiter(void 0, void 0, void 0, function* () {\n    const supported = [];\n    const stream = yield getUserMedia({ video: { deviceId: { exact: deviceId } } });\n    const videoTrack = stream.getVideoTracks()[0];\n    for (let i = 0; i < resolutionList.length; i++) {\n        const [width, height] = resolutionList[i];\n        const success = yield videoTrack.applyConstraints({ width: { exact: width }, height: { exact: height } })\n            .then(() => true)\n            .catch(() => false);\n        if (success) {\n            supported.push({ resolution: `${width}x${height}`, width, height });\n        }\n    }\n    WebRTC.stopStream(stream);\n    return supported;\n});\nconst getMediaConstraints = (options) => __awaiter(void 0, void 0, void 0, function* () {\n    let { audio = true, micId } = options;\n    const { micLabel = '' } = options;\n    if (micId) {\n        micId = yield assureDeviceId(micId, micLabel, DeviceType.AudioIn).catch(error => null);\n        if (micId) {\n            if (typeof audio === 'boolean') {\n                audio = {};\n            }\n            audio.deviceId = { exact: micId };\n        }\n    }\n    let { video = false, camId } = options;\n    const { camLabel = '' } = options;\n    if (camId) {\n        camId = yield assureDeviceId(camId, camLabel, DeviceType.Video).catch(error => null);\n        if (camId) {\n            if (typeof video === 'boolean') {\n                video = {};\n            }\n            video.deviceId = { exact: camId };\n        }\n    }\n    return { audio, video };\n});\nconst assureDeviceId = (id, label, kind) => __awaiter(void 0, void 0, void 0, function* () {\n    const devices = yield getDevices(kind, true);\n    for (let i = 0; i < devices.length; i++) {\n        const { deviceId, label: deviceLabel } = devices[i];\n        if (id === deviceId || label === deviceLabel) {\n            return deviceId;\n        }\n    }\n    return null;\n});\nconst removeUnsupportedConstraints = (constraints) => {\n    const supported = WebRTC.getSupportedConstraints();\n    Object.keys(constraints).map(key => {\n        if (!supported.hasOwnProperty(key) || constraints[key] === null || constraints[key] === undefined) {\n            delete constraints[key];\n        }\n    });\n};\nconst checkDeviceIdConstraints = (id, label, kind, constraints) => __awaiter(void 0, void 0, void 0, function* () {\n    const { deviceId } = constraints;\n    if (!isDefined(deviceId) && (id || label)) {\n        const deviceId = yield assureDeviceId(id, label, kind).catch(error => null);\n        if (deviceId) {\n            constraints.deviceId = { exact: deviceId };\n        }\n    }\n    return constraints;\n});\nconst sdpStereoHack = (sdp) => {\n    const endOfLine = '\\r\\n';\n    const sdpLines = sdp.split(endOfLine);\n    const opusIndex = sdpLines.findIndex(s => /^a=rtpmap/.test(s) && /opus\\/48000/.test(s));\n    if (opusIndex < 0) {\n        return sdp;\n    }\n    const getCodecPayloadType = (line) => {\n        const pattern = new RegExp('a=rtpmap:(\\\\d+) \\\\w+\\\\/\\\\d+');\n        const result = line.match(pattern);\n        return result && result.length == 2 ? result[1] : null;\n    };\n    const opusPayload = getCodecPayloadType(sdpLines[opusIndex]);\n    const pattern = new RegExp(`a=fmtp:${opusPayload}`);\n    const fmtpLineIndex = sdpLines.findIndex(s => pattern.test(s));\n    if (fmtpLineIndex >= 0) {\n        if (!/stereo=1;/.test(sdpLines[fmtpLineIndex])) {\n            sdpLines[fmtpLineIndex] += '; stereo=1; sprop-stereo=1';\n        }\n    }\n    else {\n        sdpLines[opusIndex] += `${endOfLine}a=fmtp:${opusPayload} stereo=1; sprop-stereo=1`;\n    }\n    return sdpLines.join(endOfLine);\n};\nconst _isAudioLine = (line) => /^m=audio/.test(line);\nconst _isVideoLine = (line) => /^m=video/.test(line);\nconst sdpMediaOrderHack = (answer, localOffer) => {\n    const endOfLine = '\\r\\n';\n    const offerLines = localOffer.split(endOfLine);\n    const offerAudioIndex = offerLines.findIndex(_isAudioLine);\n    const offerVideoIndex = offerLines.findIndex(_isVideoLine);\n    if (offerAudioIndex < offerVideoIndex) {\n        return answer;\n    }\n    const answerLines = answer.split(endOfLine);\n    const answerAudioIndex = answerLines.findIndex(_isAudioLine);\n    const answerVideoIndex = answerLines.findIndex(_isVideoLine);\n    const audioLines = answerLines.slice(answerAudioIndex, answerVideoIndex);\n    const videoLines = answerLines.slice(answerVideoIndex, (answerLines.length - 1));\n    const beginLines = answerLines.slice(0, answerAudioIndex);\n    return [...beginLines, ...videoLines, ...audioLines, ''].join(endOfLine);\n};\nconst checkSubscribeResponse = (response, channel) => {\n    if (!response) {\n        return false;\n    }\n    const { subscribed, alreadySubscribed } = destructSubscribeResponse(response);\n    return subscribed.includes(channel) || alreadySubscribed.includes(channel);\n};\nconst destructSubscribeResponse = (response) => {\n    const tmp = {\n        subscribed: [],\n        alreadySubscribed: [],\n        unauthorized: [],\n        unsubscribed: [],\n        notSubscribed: []\n    };\n    Object.keys(tmp).forEach(k => { tmp[k] = response[`${k}Channels`] || []; });\n    return tmp;\n};\nconst enableAudioTracks = (stream) => {\n    _updateMediaStreamTracks(stream, 'audio', true);\n};\nconst disableAudioTracks = (stream) => {\n    _updateMediaStreamTracks(stream, 'audio', false);\n};\nconst toggleAudioTracks = (stream) => {\n    _updateMediaStreamTracks(stream, 'audio', null);\n};\nconst enableVideoTracks = (stream) => {\n    _updateMediaStreamTracks(stream, 'video', true);\n};\nconst disableVideoTracks = (stream) => {\n    _updateMediaStreamTracks(stream, 'video', false);\n};\nconst toggleVideoTracks = (stream) => {\n    _updateMediaStreamTracks(stream, 'video', null);\n};\nconst _updateMediaStreamTracks = (stream, kind = null, enabled = null) => {\n    if (!WebRTC.streamIsValid(stream)) {\n        return null;\n    }\n    let tracks = [];\n    switch (kind) {\n        case 'audio':\n            tracks = stream.getAudioTracks();\n            break;\n        case 'video':\n            tracks = stream.getVideoTracks();\n            break;\n        default:\n            tracks = stream.getTracks();\n            break;\n    }\n    tracks.forEach((track) => {\n        switch (enabled) {\n            case 'on':\n            case true:\n                track.enabled = true;\n                break;\n            case 'off':\n            case false:\n                track.enabled = false;\n                break;\n            default:\n                track.enabled = !track.enabled;\n                break;\n        }\n    });\n};\nconst sdpBitrateHack = (sdp, max, min, start) => {\n    const endOfLine = '\\r\\n';\n    const lines = sdp.split(endOfLine);\n    lines.forEach((line, i) => {\n        if (/^a=fmtp:\\d*/.test(line)) {\n            lines[i] += `;x-google-max-bitrate=${max};x-google-min-bitrate=${min};x-google-start-bitrate=${start}`;\n        }\n        else if (/^a=mid:(1|video)/.test(line)) {\n            lines[i] += `\\r\\nb=AS:${max}`;\n        }\n    });\n    return lines.join(endOfLine);\n};\nexport { getUserMedia, getDevices, scanResolutions, getMediaConstraints, assureDeviceId, removeUnsupportedConstraints, checkDeviceIdConstraints, sdpStereoHack, sdpMediaOrderHack, sdpBitrateHack, checkSubscribeResponse, destructSubscribeResponse, enableAudioTracks, disableAudioTracks, toggleAudioTracks, enableVideoTracks, disableVideoTracks, toggleVideoTracks, };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport logger from '../util/logger';\nimport { getUserMedia, getMediaConstraints, sdpStereoHack, sdpBitrateHack } from './helpers';\nimport { SwEvent } from '../util/constants';\nimport { PeerType } from './constants';\nimport { attachMediaStream, muteMediaElement, sdpToJsonHack, RTCPeerConnection, streamIsValid } from '../util/webrtc';\nimport { isFunction } from '../util/helpers';\nimport { trigger } from '../services/Handler';\nexport default class Peer {\n    constructor(type, options) {\n        this.type = type;\n        this.options = options;\n        this.onSdpReadyTwice = null;\n        this._negotiating = false;\n        logger.info('New Peer with type:', this.type, 'Options:', this.options);\n        this._constraints = { offerToReceiveAudio: true, offerToReceiveVideo: true };\n        this._sdpReady = this._sdpReady.bind(this);\n        this._init();\n    }\n    startNegotiation() {\n        this._negotiating = true;\n        if (this._isOffer()) {\n            this._createOffer();\n        }\n        else {\n            this._createAnswer();\n        }\n    }\n    _init() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.instance = RTCPeerConnection(this._config());\n            this.instance.onsignalingstatechange = event => {\n                switch (this.instance.signalingState) {\n                    case 'stable':\n                        this._negotiating = false;\n                        break;\n                    case 'closed':\n                        this.instance = null;\n                        break;\n                    default:\n                        this._negotiating = true;\n                }\n            };\n            this.instance.onnegotiationneeded = event => {\n                if (this._negotiating) {\n                    logger.debug('Skip twice onnegotiationneeded..');\n                    return;\n                }\n                this.startNegotiation();\n            };\n            this.options.localStream = yield this._retrieveLocalStream()\n                .catch(error => {\n                trigger(SwEvent.MediaError, error, this.options.id);\n                return null;\n            });\n            const { localElement, localStream = null, screenShare = false } = this.options;\n            if (streamIsValid(localStream)) {\n                if (typeof this.instance.addTrack === 'function') {\n                    localStream.getTracks().forEach(t => this.instance.addTrack(t, localStream));\n                }\n                else {\n                    this.instance.addStream(localStream);\n                }\n                if (screenShare !== true) {\n                    muteMediaElement(localElement);\n                    attachMediaStream(localElement, localStream);\n                }\n            }\n            else if (localStream === null) {\n                this.startNegotiation();\n            }\n        });\n    }\n    _createOffer() {\n        if (!this._isOffer()) {\n            return;\n        }\n        this.instance.createOffer(this._constraints)\n            .then(this._setLocalDescription.bind(this))\n            .then(this._sdpReady)\n            .catch(error => logger.error('Peer _createOffer error:', error));\n    }\n    _createAnswer() {\n        if (!this._isAnswer()) {\n            return;\n        }\n        const { remoteSdp, useStereo } = this.options;\n        const sdp = useStereo ? sdpStereoHack(remoteSdp) : remoteSdp;\n        const sessionDescr = sdpToJsonHack({ sdp, type: PeerType.Offer });\n        this.instance.setRemoteDescription(sessionDescr)\n            .then(() => this.instance.createAnswer())\n            .then(this._setLocalDescription.bind(this))\n            .then(this._sdpReady)\n            .catch(error => logger.error('Peer _createAnswer error:', error));\n    }\n    _setLocalDescription(sessionDescription) {\n        const { useStereo, googleMaxBitrate, googleMinBitrate, googleStartBitrate } = this.options;\n        if (useStereo) {\n            sessionDescription.sdp = sdpStereoHack(sessionDescription.sdp);\n        }\n        if (googleMaxBitrate && googleMinBitrate && googleStartBitrate) {\n            sessionDescription.sdp = sdpBitrateHack(sessionDescription.sdp, googleMaxBitrate, googleMinBitrate, googleStartBitrate);\n        }\n        return this.instance.setLocalDescription(sessionDescription);\n    }\n    _sdpReady() {\n        if (isFunction(this.onSdpReadyTwice)) {\n            this.onSdpReadyTwice(this.instance.localDescription);\n        }\n    }\n    _retrieveLocalStream() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (streamIsValid(this.options.localStream)) {\n                return this.options.localStream;\n            }\n            const constraints = yield getMediaConstraints(this.options);\n            return getUserMedia(constraints);\n        });\n    }\n    _isOffer() {\n        return this.type === PeerType.Offer;\n    }\n    _isAnswer() {\n        return this.type === PeerType.Answer;\n    }\n    _config() {\n        const { iceServers = [] } = this.options;\n        const config = { sdpSemantics: 'unified-plan', bundlePolicy: 'max-compat', iceServers };\n        logger.info('RTC config', config);\n        return config;\n    }\n}\n","import { NOTIFICATION_TYPE, ConferenceAction } from './constants';\nimport { SwEvent } from '../util/constants';\nimport { trigger } from '../services/Handler';\nimport { safeParseJson } from '../util/helpers';\nconst MCULayoutEventHandler = (session, eventData) => {\n    const { contentType, canvasType, callID, canvasInfo = null, currentLayerIdx = -1 } = eventData;\n    if (canvasInfo && canvasType !== 'mcu-personal-canvas') {\n        delete canvasInfo.memberID;\n    }\n    const data = {\n        type: NOTIFICATION_TYPE.conferenceUpdate,\n        call: session.calls[callID],\n        canvasInfo: _clearCanvasInfo(canvasInfo),\n        currentLayerIdx\n    };\n    switch (contentType) {\n        case 'layer-info': {\n            const notification = Object.assign({ action: ConferenceAction.LayerInfo }, data);\n            trigger(SwEvent.Notification, notification, session.uuid);\n            break;\n        }\n        case 'layout-info': {\n            const notification = Object.assign({ action: ConferenceAction.LayoutInfo }, data);\n            trigger(SwEvent.Notification, notification, session.uuid);\n            break;\n        }\n    }\n};\nconst _clearCanvasInfo = (canvasInfo) => {\n    const tmp = JSON.stringify(canvasInfo)\n        .replace(/memberID/g, 'participantId')\n        .replace(/ID\"/g, 'Id\"')\n        .replace(/POS\"/g, 'Pos\"');\n    return safeParseJson(tmp);\n};\nexport { MCULayoutEventHandler };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { v4 as uuidv4 } from 'uuid';\nimport logger from '../util/logger';\nimport { Invite, Answer, Attach, Bye, Modify, Info } from '../messages/Verto';\nimport Peer from './Peer';\nimport { SwEvent } from '../util/constants';\nimport { State, DEFAULT_CALL_OPTIONS, ConferenceAction, Role, PeerType, VertoMethod, NOTIFICATION_TYPE, Direction } from './constants';\nimport { trigger, register, deRegister } from '../services/Handler';\nimport { sdpStereoHack, sdpMediaOrderHack, checkSubscribeResponse, enableAudioTracks, disableAudioTracks, toggleAudioTracks, enableVideoTracks, disableVideoTracks, toggleVideoTracks } from './helpers';\nimport { objEmpty, mutateLiveArrayData, isFunction } from '../util/helpers';\nimport { attachMediaStream, detachMediaStream, sdpToJsonHack, stopStream, getUserMedia, setMediaElementSinkId } from '../util/webrtc';\nimport { MCULayoutEventHandler } from './LayoutHandler';\nexport default class BaseCall {\n    constructor(session, opts) {\n        this.session = session;\n        this.id = '';\n        this.state = State[State.New];\n        this.prevState = '';\n        this.channels = [];\n        this.role = Role.Participant;\n        this.extension = null;\n        this._state = State.New;\n        this._prevState = State.New;\n        this.gotAnswer = false;\n        this.gotEarly = false;\n        this._lastSerno = 0;\n        this._targetNodeId = null;\n        this._iceTimeout = null;\n        this._iceDone = false;\n        this._checkConferenceSerno = (serno) => {\n            const check = (serno < 0) || (!this._lastSerno || (this._lastSerno && serno === (this._lastSerno + 1)));\n            if (check && serno >= 0) {\n                this._lastSerno = serno;\n            }\n            return check;\n        };\n        const { iceServers, speaker: speakerId, micId, micLabel, camId, camLabel, localElement, remoteElement, mediaConstraints: { audio, video } } = session;\n        this.options = Object.assign({}, DEFAULT_CALL_OPTIONS, { audio, video, iceServers, localElement, remoteElement, micId, micLabel, camId, camLabel, speakerId }, opts);\n        this._onMediaError = this._onMediaError.bind(this);\n        this._init();\n    }\n    get nodeId() {\n        return this._targetNodeId;\n    }\n    set nodeId(what) {\n        this._targetNodeId = what;\n    }\n    get localStream() {\n        return this.options.localStream;\n    }\n    get remoteStream() {\n        return this.options.remoteStream;\n    }\n    get memberChannel() {\n        return `conference-member.${this.id}`;\n    }\n    invite() {\n        this.direction = Direction.Outbound;\n        this.peer = new Peer(PeerType.Offer, this.options);\n        this._registerPeerEvents();\n    }\n    answer() {\n        this.direction = Direction.Inbound;\n        this.peer = new Peer(PeerType.Answer, this.options);\n        this._registerPeerEvents();\n    }\n    hangup(params = {}, execute = true) {\n        this.cause = params.cause || 'NORMAL_CLEARING';\n        this.causeCode = params.causeCode || 16;\n        this.setState(State.Hangup);\n        const _close = () => {\n            this.peer ? this.peer.instance.close() : null;\n            this.setState(State.Destroy);\n        };\n        if (execute) {\n            const bye = new Bye({ sessid: this.session.sessionid, dialogParams: this.options });\n            this._execute(bye)\n                .catch(error => logger.error('verto.bye failed!', error))\n                .then(_close.bind(this));\n        }\n        else {\n            _close();\n        }\n    }\n    transfer(destination) {\n        const msg = new Modify({ sessid: this.session.sessionid, action: 'transfer', destination, dialogParams: this.options });\n        this._execute(msg);\n    }\n    replace(replaceCallID) {\n        const msg = new Modify({ sessid: this.session.sessionid, action: 'replace', replaceCallID, dialogParams: this.options });\n        this._execute(msg);\n    }\n    hold() {\n        const msg = new Modify({ sessid: this.session.sessionid, action: 'hold', dialogParams: this.options });\n        return this._execute(msg)\n            .then(this._handleChangeHoldStateSuccess.bind(this))\n            .catch(this._handleChangeHoldStateError.bind(this));\n    }\n    unhold() {\n        const msg = new Modify({ sessid: this.session.sessionid, action: 'unhold', dialogParams: this.options });\n        return this._execute(msg)\n            .then(this._handleChangeHoldStateSuccess.bind(this))\n            .catch(this._handleChangeHoldStateError.bind(this));\n    }\n    toggleHold() {\n        const msg = new Modify({ sessid: this.session.sessionid, action: 'toggleHold', dialogParams: this.options });\n        return this._execute(msg)\n            .then(this._handleChangeHoldStateSuccess.bind(this))\n            .catch(this._handleChangeHoldStateError.bind(this));\n    }\n    dtmf(dtmf) {\n        const msg = new Info({ sessid: this.session.sessionid, dtmf, dialogParams: this.options });\n        this._execute(msg);\n    }\n    message(to, body) {\n        const msg = { from: this.session.options.login, to, body };\n        const info = new Info({ sessid: this.session.sessionid, msg, dialogParams: this.options });\n        this._execute(info);\n    }\n    muteAudio() {\n        disableAudioTracks(this.options.localStream);\n    }\n    unmuteAudio() {\n        enableAudioTracks(this.options.localStream);\n    }\n    toggleAudioMute() {\n        toggleAudioTracks(this.options.localStream);\n    }\n    setAudioInDevice(deviceId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { instance } = this.peer;\n            const sender = instance.getSenders().find(({ track: { kind } }) => kind === 'audio');\n            if (sender) {\n                const newStream = yield getUserMedia({ audio: { deviceId: { exact: deviceId } } });\n                const audioTrack = newStream.getAudioTracks()[0];\n                sender.replaceTrack(audioTrack);\n                this.options.micId = deviceId;\n                const { localStream } = this.options;\n                localStream.getAudioTracks().forEach(t => t.stop());\n                localStream.getVideoTracks().forEach(t => newStream.addTrack(t));\n                this.options.localStream = newStream;\n            }\n        });\n    }\n    muteVideo() {\n        disableVideoTracks(this.options.localStream);\n    }\n    unmuteVideo() {\n        enableVideoTracks(this.options.localStream);\n    }\n    toggleVideoMute() {\n        toggleVideoTracks(this.options.localStream);\n    }\n    setVideoDevice(deviceId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { instance } = this.peer;\n            const sender = instance.getSenders().find(({ track: { kind } }) => kind === 'video');\n            if (sender) {\n                const newStream = yield getUserMedia({ video: { deviceId: { exact: deviceId } } });\n                const videoTrack = newStream.getVideoTracks()[0];\n                sender.replaceTrack(videoTrack);\n                const { localElement, localStream } = this.options;\n                attachMediaStream(localElement, newStream);\n                this.options.camId = deviceId;\n                localStream.getAudioTracks().forEach(t => newStream.addTrack(t));\n                localStream.getVideoTracks().forEach(t => t.stop());\n                this.options.localStream = newStream;\n            }\n        });\n    }\n    deaf() {\n        disableAudioTracks(this.options.remoteStream);\n    }\n    undeaf() {\n        enableAudioTracks(this.options.remoteStream);\n    }\n    toggleDeaf() {\n        toggleAudioTracks(this.options.remoteStream);\n    }\n    setState(state) {\n        this._prevState = this._state;\n        this._state = state;\n        this.state = State[this._state].toLowerCase();\n        this.prevState = State[this._prevState].toLowerCase();\n        logger.info(`Call ${this.id} state change from ${this.prevState} to ${this.state}`);\n        this._dispatchNotification({ type: NOTIFICATION_TYPE.callUpdate, call: this });\n        switch (state) {\n            case State.Purge:\n                this.hangup({ cause: 'PURGE', causeCode: '01' }, false);\n                break;\n            case State.Active: {\n                setTimeout(() => {\n                    const { remoteElement, speakerId } = this.options;\n                    if (remoteElement && speakerId) {\n                        setMediaElementSinkId(remoteElement, speakerId);\n                    }\n                }, 0);\n                break;\n            }\n            case State.Destroy:\n                this._finalize();\n                break;\n        }\n    }\n    handleMessage(msg) {\n        const { method, params } = msg;\n        switch (method) {\n            case VertoMethod.Answer: {\n                this.gotAnswer = true;\n                if (this._state >= State.Active) {\n                    return;\n                }\n                if (this._state >= State.Early) {\n                    this.setState(State.Active);\n                }\n                if (!this.gotEarly) {\n                    this._onRemoteSdp(params.sdp);\n                }\n                break;\n            }\n            case VertoMethod.Media: {\n                if (this._state >= State.Early) {\n                    return;\n                }\n                this.gotEarly = true;\n                this._onRemoteSdp(params.sdp);\n                break;\n            }\n            case VertoMethod.Display:\n            case VertoMethod.Attach: {\n                const { display_name: displayName, display_number: displayNumber, display_direction } = params;\n                this.extension = displayNumber;\n                const displayDirection = display_direction === Direction.Inbound ? Direction.Outbound : Direction.Inbound;\n                const notification = { type: NOTIFICATION_TYPE[method], call: this, displayName, displayNumber, displayDirection };\n                if (!trigger(SwEvent.Notification, notification, this.id)) {\n                    trigger(SwEvent.Notification, notification, this.session.uuid);\n                }\n                break;\n            }\n            case VertoMethod.Info:\n            case VertoMethod.Event: {\n                const notification = Object.assign(Object.assign({}, params), { type: NOTIFICATION_TYPE.generic, call: this });\n                if (!trigger(SwEvent.Notification, notification, this.id)) {\n                    trigger(SwEvent.Notification, notification, this.session.uuid);\n                }\n                break;\n            }\n            case VertoMethod.Bye:\n                this.hangup(params, false);\n                break;\n        }\n    }\n    handleConferenceUpdate(packet, initialPvtData) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._checkConferenceSerno(packet.wireSerno) && packet.name !== initialPvtData.laName) {\n                logger.error('ConferenceUpdate invalid wireSerno or packet name:', packet);\n                return 'INVALID_PACKET';\n            }\n            const { action, data, hashKey: callId = String(this._lastSerno), arrIndex: index } = packet;\n            switch (action) {\n                case 'bootObj': {\n                    this._lastSerno = 0;\n                    const { chatID, chatChannel, infoChannel, modChannel, laName, conferenceMemberID, role } = initialPvtData;\n                    this._dispatchConferenceUpdate({ action: ConferenceAction.Join, conferenceName: laName, participantId: Number(conferenceMemberID), role });\n                    if (chatChannel) {\n                        yield this._subscribeConferenceChat(chatChannel);\n                    }\n                    if (infoChannel) {\n                        yield this._subscribeConferenceInfo(infoChannel);\n                    }\n                    if (modChannel && role === Role.Moderator) {\n                        yield this._subscribeConferenceModerator(modChannel);\n                    }\n                    const participants = [];\n                    for (const i in data) {\n                        participants.push(Object.assign({ callId: data[i][0], index: Number(i) }, mutateLiveArrayData(data[i][1])));\n                    }\n                    this._dispatchConferenceUpdate({ action: ConferenceAction.Bootstrap, participants });\n                    break;\n                }\n                case 'add': {\n                    this._dispatchConferenceUpdate(Object.assign({ action: ConferenceAction.Add, callId, index }, mutateLiveArrayData(data)));\n                    break;\n                }\n                case 'modify':\n                    this._dispatchConferenceUpdate(Object.assign({ action: ConferenceAction.Modify, callId, index }, mutateLiveArrayData(data)));\n                    break;\n                case 'del':\n                    this._dispatchConferenceUpdate(Object.assign({ action: ConferenceAction.Delete, callId, index }, mutateLiveArrayData(data)));\n                    break;\n                case 'clear':\n                    this._dispatchConferenceUpdate({ action: ConferenceAction.Clear });\n                    break;\n                default:\n                    this._dispatchConferenceUpdate({ action, data, callId, index });\n                    break;\n            }\n        });\n    }\n    _addChannel(channel) {\n        if (!this.channels.includes(channel)) {\n            this.channels.push(channel);\n        }\n        const protocol = this.session.relayProtocol;\n        if (this.session._existsSubscription(protocol, channel)) {\n            this.session.subscriptions[protocol][channel] = Object.assign(Object.assign({}, this.session.subscriptions[protocol][channel]), { callId: this.id });\n        }\n    }\n    _subscribeConferenceChat(channel) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const tmp = {\n                nodeId: this.nodeId,\n                channels: [channel],\n                handler: (params) => {\n                    const { direction, from: participantNumber, fromDisplay: participantName, message: messageText, type: messageType } = params.data;\n                    this._dispatchConferenceUpdate({ action: ConferenceAction.ChatMessage, direction, participantNumber, participantName, messageText, messageType, messageId: params.eventSerno });\n                }\n            };\n            const response = yield this.session.vertoSubscribe(tmp)\n                .catch(error => {\n                logger.error('ConfChat subscription error:', error);\n            });\n            if (checkSubscribeResponse(response, channel)) {\n                this._addChannel(channel);\n                Object.defineProperties(this, {\n                    sendChatMessage: {\n                        configurable: true,\n                        value: (message, type) => {\n                            this.session.vertoBroadcast({ nodeId: this.nodeId, channel, data: { action: 'send', message, type } });\n                        }\n                    }\n                });\n            }\n        });\n    }\n    _subscribeConferenceInfo(channel) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const tmp = {\n                nodeId: this.nodeId,\n                channels: [channel],\n                handler: (params) => {\n                    const { eventData } = params;\n                    switch (eventData.contentType) {\n                        case 'layout-info':\n                            eventData.callID = this.id;\n                            MCULayoutEventHandler(this.session, eventData);\n                            break;\n                        default:\n                            logger.error('Conference-Info unknown contentType', params);\n                    }\n                }\n            };\n            const response = yield this.session.vertoSubscribe(tmp)\n                .catch(error => {\n                logger.error('ConfInfo subscription error:', error);\n            });\n            if (checkSubscribeResponse(response, channel)) {\n                this._addChannel(channel);\n            }\n        });\n    }\n    _confControl(channel, params = {}) {\n        const data = Object.assign({ application: 'conf-control', callID: this.id, value: null }, params);\n        this.session.vertoBroadcast({ nodeId: this.nodeId, channel, data });\n    }\n    _subscribeConferenceModerator(channel) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const _modCommand = (command, memberID = null, value = null) => {\n                const id = parseInt(memberID) || null;\n                this._confControl(channel, { command, id, value });\n            };\n            const _videoRequired = () => {\n                const { video } = this.options;\n                if ((typeof video === 'boolean' && !video) || (typeof video === 'object' && objEmpty(video))) {\n                    throw `Conference ${this.id} has no video!`;\n                }\n            };\n            const tmp = {\n                nodeId: this.nodeId,\n                channels: [channel],\n                handler: (params) => {\n                    const { data } = params;\n                    switch (data['conf-command']) {\n                        case 'list-videoLayouts':\n                            if (data.responseData) {\n                                const tmp = JSON.stringify(data.responseData).replace(/IDS\"/g, 'Ids\"');\n                                this._dispatchConferenceUpdate({ action: ConferenceAction.LayoutList, layouts: JSON.parse(tmp) });\n                            }\n                            break;\n                        default:\n                            this._dispatchConferenceUpdate({ action: ConferenceAction.ModCmdResponse, command: data['conf-command'], response: data.response });\n                    }\n                }\n            };\n            const response = yield this.session.vertoSubscribe(tmp)\n                .catch(error => {\n                logger.error('ConfMod subscription error:', error);\n            });\n            if (checkSubscribeResponse(response, channel)) {\n                this.role = Role.Moderator;\n                this._addChannel(channel);\n                Object.defineProperties(this, {\n                    listVideoLayouts: {\n                        configurable: true,\n                        value: () => {\n                            _modCommand('list-videoLayouts');\n                        }\n                    },\n                    playMedia: {\n                        configurable: true,\n                        value: (file) => {\n                            _modCommand('play', null, file);\n                        }\n                    },\n                    stopMedia: {\n                        configurable: true,\n                        value: () => {\n                            _modCommand('stop', null, 'all');\n                        }\n                    },\n                    deaf: {\n                        configurable: true,\n                        value: (memberID) => {\n                            _modCommand('deaf', memberID);\n                        }\n                    },\n                    undeaf: {\n                        configurable: true,\n                        value: (memberID) => {\n                            _modCommand('undeaf', memberID);\n                        }\n                    },\n                    startRecord: {\n                        configurable: true,\n                        value: (file) => {\n                            _modCommand('recording', null, ['start', file]);\n                        }\n                    },\n                    stopRecord: {\n                        configurable: true,\n                        value: () => {\n                            _modCommand('recording', null, ['stop', 'all']);\n                        }\n                    },\n                    snapshot: {\n                        configurable: true,\n                        value: (file) => {\n                            _videoRequired();\n                            _modCommand('vid-write-png', null, file);\n                        }\n                    },\n                    setVideoLayout: {\n                        configurable: true,\n                        value: (layout, canvasID) => {\n                            _videoRequired();\n                            const value = canvasID ? [layout, canvasID] : layout;\n                            _modCommand('vid-layout', null, value);\n                        }\n                    },\n                    kick: {\n                        configurable: true,\n                        value: (memberID) => {\n                            _modCommand('kick', memberID);\n                        }\n                    },\n                    muteMic: {\n                        configurable: true,\n                        value: (memberID) => {\n                            _modCommand('tmute', memberID);\n                        }\n                    },\n                    muteVideo: {\n                        configurable: true,\n                        value: (memberID) => {\n                            _videoRequired();\n                            _modCommand('tvmute', memberID);\n                        }\n                    },\n                    presenter: {\n                        configurable: true,\n                        value: (memberID) => {\n                            _videoRequired();\n                            _modCommand('vid-res-id', memberID, 'presenter');\n                        }\n                    },\n                    videoFloor: {\n                        configurable: true,\n                        value: (memberID) => {\n                            _videoRequired();\n                            _modCommand('vid-floor', memberID, 'force');\n                        }\n                    },\n                    banner: {\n                        configurable: true,\n                        value: (memberID, text) => {\n                            _videoRequired();\n                            _modCommand('vid-banner', memberID, encodeURI(text));\n                        }\n                    },\n                    volumeDown: {\n                        configurable: true,\n                        value: (memberID) => {\n                            _modCommand('volume_out', memberID, 'down');\n                        }\n                    },\n                    volumeUp: {\n                        configurable: true,\n                        value: (memberID) => {\n                            _modCommand('volume_out', memberID, 'up');\n                        }\n                    },\n                    gainDown: {\n                        configurable: true,\n                        value: (memberID) => {\n                            _modCommand('volume_in', memberID, 'down');\n                        }\n                    },\n                    gainUp: {\n                        configurable: true,\n                        value: (memberID) => {\n                            _modCommand('volume_in', memberID, 'up');\n                        }\n                    },\n                    transfer: {\n                        configurable: true,\n                        value: (memberID, exten) => {\n                            _modCommand('transfer', memberID, exten);\n                        }\n                    }\n                });\n            }\n        });\n    }\n    _handleChangeHoldStateSuccess(response) {\n        response.holdState === 'active' ? this.setState(State.Active) : this.setState(State.Held);\n        return true;\n    }\n    _handleChangeHoldStateError(error) {\n        logger.error(`Failed to ${error.action} on call ${this.id}`);\n        return false;\n    }\n    _onRemoteSdp(remoteSdp) {\n        let sdp = sdpMediaOrderHack(remoteSdp, this.peer.instance.localDescription.sdp);\n        if (this.options.useStereo) {\n            sdp = sdpStereoHack(sdp);\n        }\n        const sessionDescr = sdpToJsonHack({ sdp, type: PeerType.Answer });\n        this.peer.instance.setRemoteDescription(sessionDescr)\n            .then(() => {\n            if (this.gotEarly) {\n                this.setState(State.Early);\n            }\n            if (this.gotAnswer) {\n                this.setState(State.Active);\n            }\n        })\n            .catch(error => {\n            logger.error('Call setRemoteDescription Error: ', error);\n            this.hangup();\n        });\n    }\n    _requestAnotherLocalDescription() {\n        if (isFunction(this.peer.onSdpReadyTwice)) {\n            trigger(SwEvent.Error, new Error('SDP without candidates for the second time!'), this.session.uuid);\n            return;\n        }\n        Object.defineProperty(this.peer, 'onSdpReadyTwice', { value: this._onIceSdp.bind(this) });\n        this._iceDone = false;\n        this.peer.startNegotiation();\n    }\n    _onIceSdp(data) {\n        if (this._iceTimeout) {\n            clearTimeout(this._iceTimeout);\n        }\n        this._iceTimeout = null;\n        this._iceDone = true;\n        const { sdp, type } = data;\n        if (sdp.indexOf('candidate') === -1) {\n            this._requestAnotherLocalDescription();\n            return;\n        }\n        let msg = null;\n        const tmpParams = { sessid: this.session.sessionid, sdp, dialogParams: this.options };\n        switch (type) {\n            case PeerType.Offer:\n                this.setState(State.Requesting);\n                msg = new Invite(tmpParams);\n                break;\n            case PeerType.Answer:\n                this.setState(State.Answering);\n                msg = this.options.attach === true ? new Attach(tmpParams) : new Answer(tmpParams);\n                break;\n            default:\n                logger.error(`${this.id} - Unknown local SDP type:`, data);\n                return this.hangup({}, false);\n        }\n        this._execute(msg)\n            .then(response => {\n            const { node_id = null } = response;\n            this._targetNodeId = node_id;\n            type === PeerType.Offer ? this.setState(State.Trying) : this.setState(State.Active);\n        })\n            .catch(error => {\n            logger.error(`${this.id} - Sending ${type} error:`, error);\n            this.hangup();\n        });\n    }\n    _registerPeerEvents() {\n        const { instance } = this.peer;\n        this._iceDone = false;\n        instance.onicecandidate = event => {\n            if (this._iceDone) {\n                return;\n            }\n            if (this._iceTimeout === null) {\n                this._iceTimeout = setTimeout(() => this._onIceSdp(instance.localDescription), 1000);\n            }\n            if (event.candidate) {\n                logger.info('IceCandidate:', event.candidate);\n            }\n            else {\n                this._onIceSdp(instance.localDescription);\n            }\n        };\n        instance.addEventListener('track', (event) => {\n            this.options.remoteStream = event.streams[0];\n            const { remoteElement, remoteStream, screenShare } = this.options;\n            if (screenShare === false) {\n                attachMediaStream(remoteElement, remoteStream);\n            }\n        });\n        instance.addEventListener('addstream', (event) => {\n            this.options.remoteStream = event.stream;\n        });\n    }\n    _onMediaError(error) {\n        this._dispatchNotification({ type: NOTIFICATION_TYPE.userMediaError, error });\n        this.hangup({}, false);\n    }\n    _dispatchConferenceUpdate(params) {\n        this._dispatchNotification(Object.assign({ type: NOTIFICATION_TYPE.conferenceUpdate, call: this }, params));\n    }\n    _dispatchNotification(notification) {\n        if (this.options.screenShare === true) {\n            return;\n        }\n        if (!trigger(SwEvent.Notification, notification, this.id, false)) {\n            trigger(SwEvent.Notification, notification, this.session.uuid);\n        }\n    }\n    _execute(msg) {\n        if (this.nodeId) {\n            msg.targetNodeId = this.nodeId;\n        }\n        return this.session.execute(msg);\n    }\n    _init() {\n        const { id, userVariables, remoteCallerNumber, onNotification } = this.options;\n        if (!id) {\n            this.options.id = uuidv4();\n        }\n        this.id = this.options.id;\n        if (!userVariables || objEmpty(userVariables)) {\n            this.options.userVariables = this.session.options.userVariables || {};\n        }\n        if (!remoteCallerNumber) {\n            this.options.remoteCallerNumber = this.options.destinationNumber;\n        }\n        this.session.calls[this.id] = this;\n        register(SwEvent.MediaError, this._onMediaError, this.id);\n        if (isFunction(onNotification)) {\n            register(SwEvent.Notification, onNotification.bind(this), this.id);\n        }\n        this.setState(State.New);\n        logger.info('New Call with Options:', this.options);\n    }\n    _finalize() {\n        const { remoteStream, localStream, remoteElement, localElement } = this.options;\n        stopStream(remoteStream);\n        stopStream(localStream);\n        if (this.options.screenShare !== true) {\n            detachMediaStream(remoteElement);\n            detachMediaStream(localElement);\n        }\n        deRegister(SwEvent.MediaError, null, this.id);\n        this.peer = null;\n        this.session.calls[this.id] = null;\n        delete this.session.calls[this.id];\n    }\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport logger from '../util/logger';\nimport BaseCall from './BaseCall';\nimport { getDisplayMedia, setMediaElementSinkId } from '../util/webrtc';\nexport default class Call extends BaseCall {\n    constructor() {\n        super(...arguments);\n        this._statsInterval = null;\n    }\n    hangup(params = {}, execute = true) {\n        if (this.screenShare instanceof Call) {\n            this.screenShare.hangup(params, execute);\n        }\n        super.hangup(params, execute);\n    }\n    startScreenShare(opts) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const displayStream = yield getDisplayMedia({ video: true });\n            displayStream.getTracks().forEach(t => {\n                t.addEventListener('ended', () => {\n                    if (this.screenShare) {\n                        this.screenShare.hangup();\n                    }\n                });\n            });\n            const { remoteCallerName, remoteCallerNumber, callerName, callerNumber } = this.options;\n            const options = Object.assign({ screenShare: true, localStream: displayStream, destinationNumber: `${this.extension}-screen`, remoteCallerName, remoteCallerNumber: `${remoteCallerNumber}-screen`, callerName: `${callerName} (Screen)`, callerNumber: `${callerNumber} (Screen)` }, opts);\n            this.screenShare = new Call(this.session, options);\n            this.screenShare.invite();\n            return this.screenShare;\n        });\n    }\n    stopScreenShare() {\n        if (this.screenShare instanceof Call) {\n            this.screenShare.hangup();\n        }\n    }\n    setAudioOutDevice(deviceId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.options.speakerId = deviceId;\n            const { remoteElement, speakerId } = this.options;\n            if (remoteElement && speakerId) {\n                return setMediaElementSinkId(remoteElement, speakerId);\n            }\n            return false;\n        });\n    }\n    _finalize() {\n        this._stats(false);\n        super._finalize();\n    }\n    _stats(what = true) {\n        if (what === false) {\n            return clearInterval(this._statsInterval);\n        }\n        logger.setLevel(2);\n        this._statsInterval = window.setInterval(() => __awaiter(this, void 0, void 0, function* () {\n            const stats = yield this.peer.instance.getStats(null);\n            let statsOutput = '';\n            const invalidReport = ['certificate', 'codec', 'peer-connection', 'stream', 'local-candidate', 'remote-candidate'];\n            const invalidStat = ['id', 'type', 'timestamp'];\n            stats.forEach(report => {\n                if (invalidReport.includes(report.type)) {\n                    return;\n                }\n                statsOutput += `\\n${report.type}\\n`;\n                Object.keys(report).forEach(statName => {\n                    if (!invalidStat.includes(statName)) {\n                        statsOutput += `\\t${statName}: ${report[statName]}\\n`;\n                    }\n                });\n            });\n            logger.info(statsOutput);\n        }), 2000);\n    }\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport logger from '../util/logger';\nimport Call from './Call';\nimport { checkSubscribeResponse } from './helpers';\nimport { Result } from '../messages/Verto';\nimport { SwEvent } from '../util/constants';\nimport { VertoMethod, NOTIFICATION_TYPE } from './constants';\nimport { trigger, deRegister } from '../services/Handler';\nimport { State, ConferenceAction } from './constants';\nimport { MCULayoutEventHandler } from './LayoutHandler';\nclass VertoHandler {\n    constructor(session) {\n        this.session = session;\n    }\n    _ack(id, method) {\n        const msg = new Result(id, method);\n        if (this.nodeId) {\n            msg.targetNodeId = this.nodeId;\n        }\n        this.session.execute(msg);\n    }\n    handleMessage(msg) {\n        const { session } = this;\n        const { id, method, params } = msg;\n        const { callID, eventChannel, eventType } = params;\n        const attach = method === VertoMethod.Attach;\n        if (eventType === 'channelPvtData') {\n            return this._handlePvtEvent(params.pvtData);\n        }\n        if (callID && session.calls.hasOwnProperty(callID)) {\n            if (attach) {\n                session.calls[callID].hangup({}, false);\n            }\n            else {\n                session.calls[callID].handleMessage(msg);\n                this._ack(id, method);\n                return;\n            }\n        }\n        const _buildCall = () => {\n            const call = new Call(session, {\n                id: callID,\n                remoteSdp: params.sdp,\n                destinationNumber: params.callee_id_number,\n                remoteCallerName: params.caller_id_name,\n                remoteCallerNumber: params.caller_id_number,\n                callerName: params.callee_id_name,\n                callerNumber: params.callee_id_number,\n                attach\n            });\n            call.nodeId = this.nodeId;\n            return call;\n        };\n        switch (method) {\n            case VertoMethod.Punt:\n                session.disconnect();\n                break;\n            case VertoMethod.Invite: {\n                const call = _buildCall();\n                call.setState(State.Ringing);\n                this._ack(id, method);\n                break;\n            }\n            case VertoMethod.Attach: {\n                const call = _buildCall();\n                if (this.session.autoRecoverCalls) {\n                    call.answer();\n                }\n                else {\n                    call.setState(State.Recovering);\n                }\n                call.handleMessage(msg);\n                break;\n            }\n            case VertoMethod.Event:\n            case 'webrtc.event':\n                if (!eventChannel) {\n                    logger.error('Verto received an unknown event:', params);\n                    return;\n                }\n                const protocol = session.relayProtocol;\n                const firstValue = eventChannel.split('.')[0];\n                if (session._existsSubscription(protocol, eventChannel)) {\n                    trigger(protocol, params, eventChannel);\n                }\n                else if (eventChannel === session.sessionid) {\n                    this._handleSessionEvent(params.eventData);\n                }\n                else if (session._existsSubscription(protocol, firstValue)) {\n                    trigger(protocol, params, firstValue);\n                }\n                else if (session.calls.hasOwnProperty(eventChannel)) {\n                    session.calls[eventChannel].handleMessage(msg);\n                }\n                else {\n                    trigger(SwEvent.Notification, params, session.uuid);\n                }\n                break;\n            case VertoMethod.Info:\n                params.type = NOTIFICATION_TYPE.generic;\n                trigger(SwEvent.Notification, params, session.uuid);\n                break;\n            case VertoMethod.ClientReady:\n                params.type = NOTIFICATION_TYPE.vertoClientReady;\n                trigger(SwEvent.Notification, params, session.uuid);\n                break;\n            default:\n                logger.warn('Verto message unknown method:', msg);\n        }\n    }\n    _retrieveCallId(packet, laChannel) {\n        const callIds = Object.keys(this.session.calls);\n        if (packet.action === 'bootObj') {\n            const me = packet.data.find((pr) => callIds.includes(pr[0]));\n            if (me instanceof Array) {\n                return me[0];\n            }\n        }\n        else {\n            return callIds.find((id) => this.session.calls[id].channels.includes(laChannel));\n        }\n    }\n    _handlePvtEvent(pvtData) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { session } = this;\n            const protocol = session.relayProtocol;\n            const { action, laChannel, laName, chatChannel, infoChannel, modChannel, conferenceMemberID, role, callID } = pvtData;\n            switch (action) {\n                case 'conference-liveArray-join': {\n                    const _liveArrayBootstrap = () => {\n                        session.vertoBroadcast({ nodeId: this.nodeId, channel: laChannel, data: { liveArray: { command: 'bootstrap', context: laChannel, name: laName } } });\n                    };\n                    const tmp = {\n                        nodeId: this.nodeId,\n                        channels: [laChannel],\n                        handler: ({ data: packet }) => {\n                            const id = callID || this._retrieveCallId(packet, laChannel);\n                            if (id && session.calls.hasOwnProperty(id)) {\n                                const call = session.calls[id];\n                                call._addChannel(laChannel);\n                                call.extension = laName;\n                                call.handleConferenceUpdate(packet, pvtData)\n                                    .then(error => {\n                                    if (error === 'INVALID_PACKET') {\n                                        _liveArrayBootstrap();\n                                    }\n                                });\n                            }\n                        }\n                    };\n                    const result = yield session.vertoSubscribe(tmp)\n                        .catch(error => {\n                        logger.error('liveArray subscription error:', error);\n                    });\n                    if (checkSubscribeResponse(result, laChannel)) {\n                        _liveArrayBootstrap();\n                    }\n                    break;\n                }\n                case 'conference-liveArray-part': {\n                    let call = null;\n                    if (laChannel && session._existsSubscription(protocol, laChannel)) {\n                        const { callId = null } = session.subscriptions[protocol][laChannel];\n                        call = session.calls[callId] || null;\n                        if (callId !== null) {\n                            const notification = { type: NOTIFICATION_TYPE.conferenceUpdate, action: ConferenceAction.Leave, conferenceName: laName, participantId: Number(conferenceMemberID), role };\n                            if (!trigger(SwEvent.Notification, notification, callId, false)) {\n                                trigger(SwEvent.Notification, notification, session.uuid);\n                            }\n                            if (call === null) {\n                                deRegister(SwEvent.Notification, null, callId);\n                            }\n                        }\n                    }\n                    const channels = [laChannel, chatChannel, infoChannel, modChannel];\n                    session.vertoUnsubscribe({ nodeId: this.nodeId, channels })\n                        .then(({ unsubscribedChannels = [] }) => {\n                        if (call) {\n                            call.channels = call.channels.filter(c => !unsubscribedChannels.includes(c));\n                        }\n                    })\n                        .catch(error => {\n                        logger.error('liveArray unsubscribe error:', error);\n                    });\n                    break;\n                }\n            }\n        });\n    }\n    _handleSessionEvent(eventData) {\n        switch (eventData.contentType) {\n            case 'layout-info':\n            case 'layer-info':\n                MCULayoutEventHandler(this.session, eventData);\n                break;\n            case 'logo-info': {\n                const notification = { type: NOTIFICATION_TYPE.conferenceUpdate, action: ConferenceAction.LogoInfo, logo: eventData.logoURL };\n                trigger(SwEvent.Notification, notification, this.session.uuid);\n                break;\n            }\n        }\n    }\n}\nexport default VertoHandler;\n","import logger from '../util/logger';\nimport VertoHandler from '../webrtc/VertoHandler';\nexport default (session, broadcastParams) => {\n    const { protocol, event, params } = broadcastParams;\n    const { event_type, node_id } = params;\n    if (protocol !== session.relayProtocol) {\n        return logger.error('Session protocol mismatch.');\n    }\n    switch (event) {\n        case 'queuing.relay.events':\n            if (event_type === 'webrtc.message') {\n                const handler = new VertoHandler(session);\n                handler.nodeId = node_id;\n                handler.handleMessage(params.params);\n            }\n            else {\n                session.calling.notificationHandler(params);\n            }\n            break;\n        case 'queuing.relay.tasks':\n            session.tasking.notificationHandler(params);\n            break;\n        case 'queuing.relay.messaging':\n            session.messaging.notificationHandler(params);\n            break;\n        default:\n            return logger.error(`Unknown notification type: ${event_type}`);\n    }\n};\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { v4 as uuidv4 } from 'uuid';\nimport logger from './util/logger';\nimport Connection from './services/Connection';\nimport Setup from './services/Setup';\nimport { deRegister, register, trigger, deRegisterAll } from './services/Handler';\nimport BroadcastHandler from './services/BroadcastHandler';\nimport { ADD, REMOVE, SwEvent, BladeMethod } from './util/constants';\nimport { NOTIFICATION_TYPE } from './webrtc/constants';\nimport { Subscription, Connect, Reauthenticate, Ping } from './messages/Blade';\nimport { isFunction, randomInt } from './util/helpers';\nimport { sessionStorage } from './util/storage/';\nconst KEEPALIVE_INTERVAL = 10 * 1000;\nexport default class BaseSession {\n    constructor(options) {\n        this.options = options;\n        this.uuid = uuidv4();\n        this.sessionid = '';\n        this.subscriptions = {};\n        this.expiresAt = 0;\n        this.signature = null;\n        this.relayProtocol = null;\n        this.contexts = [];\n        this.timeoutErrorCode = -32000;\n        this.connection = null;\n        this._jwtAuth = false;\n        this._doKeepAlive = false;\n        this._autoReconnect = true;\n        this._idle = false;\n        this._executeQueue = [];\n        if (!this.validateOptions()) {\n            throw new Error('Invalid init options');\n        }\n        this._onSocketOpen = this._onSocketOpen.bind(this);\n        this._onSocketCloseOrError = this._onSocketCloseOrError.bind(this);\n        this._onSocketMessage = this._onSocketMessage.bind(this);\n        this._handleLoginError = this._handleLoginError.bind(this);\n        this._checkTokenExpiration = this._checkTokenExpiration.bind(this);\n        this._attachListeners();\n        this.connection = new Connection(this);\n    }\n    get __logger() {\n        return logger;\n    }\n    get connected() {\n        return this.connection && this.connection.connected;\n    }\n    get expired() {\n        return this.expiresAt && this.expiresAt <= (Date.now() / 1000);\n    }\n    get reconnectDelay() {\n        return randomInt(6, 2) * 1000;\n    }\n    execute(msg) {\n        if (this._idle) {\n            return new Promise(resolve => this._executeQueue.push({ resolve, msg }));\n        }\n        if (!this.connected) {\n            return new Promise(resolve => {\n                this._executeQueue.push({ resolve, msg });\n                this.connect();\n            });\n        }\n        return this.connection.send(msg)\n            .catch(error => {\n            if (error.code && error.code === this.timeoutErrorCode) {\n                this._closeConnection();\n            }\n            throw error;\n        });\n    }\n    executeRaw(text) {\n        if (this._idle) {\n            this._executeQueue.push({ msg: text });\n            return;\n        }\n        this.connection.sendRawText(text);\n    }\n    validateOptions() {\n        const { project = false, token = false } = this.options;\n        return Boolean(project && token);\n    }\n    broadcast(params) { }\n    subscribe({ protocol, channels, handler }) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const bs = new Subscription({ command: ADD, protocol, channels });\n            const result = yield this.execute(bs);\n            const { failed_channels = [], subscribe_channels = [] } = result;\n            if (failed_channels.length) {\n                failed_channels.forEach((channel) => this._removeSubscription(protocol, channel));\n            }\n            subscribe_channels.forEach((channel) => this._addSubscription(protocol, handler, channel));\n            return result;\n        });\n    }\n    unsubscribe({ protocol, channels, handler }) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const bs = new Subscription({ command: REMOVE, protocol, channels });\n            return this.execute(bs);\n        });\n    }\n    disconnect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            clearTimeout(this._reconnectTimeout);\n            this.subscriptions = {};\n            this._autoReconnect = false;\n            this.relayProtocol = null;\n            this._closeConnection();\n            yield sessionStorage.removeItem(this.signature);\n            this._executeQueue = [];\n            this._detachListeners();\n        });\n    }\n    on(eventName, callback) {\n        register(eventName, callback, this.uuid);\n        return this;\n    }\n    off(eventName, callback) {\n        deRegister(eventName, callback, this.uuid);\n        return this;\n    }\n    refreshToken(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.options.token = token;\n            try {\n                if (this.expired) {\n                    yield this.connect();\n                }\n                else {\n                    const br = new Reauthenticate(this.options.project, token, this.sessionid);\n                    const response = yield this.execute(br);\n                    const { authorization: { expires_at = null } = {} } = response;\n                    this.expiresAt = +expires_at || 0;\n                }\n            }\n            catch (error) {\n                logger.error('refreshToken error:', error);\n                trigger(SwEvent.Error, error, this.uuid, false);\n            }\n        });\n    }\n    connect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.connection) {\n                this.connection = new Connection(this);\n            }\n            this._attachListeners();\n            if (!this.connection.isAlive) {\n                this.connection.connect();\n            }\n        });\n    }\n    _handleLoginError(error) {\n        trigger(SwEvent.Error, error, this.uuid);\n    }\n    _onSocketOpen() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._idle = false;\n            const tokenKey = this._jwtAuth ? 'jwt_token' : 'token';\n            const { project, token } = this.options;\n            const bc = new Connect({ project, [tokenKey]: token }, this.sessionid);\n            const response = yield this.execute(bc).catch(this._handleLoginError);\n            if (response) {\n                this._autoReconnect = true;\n                const { sessionid, nodeid, master_nodeid, authorization: { expires_at = null, signature = null } = {} } = response;\n                this.expiresAt = +expires_at || 0;\n                this.signature = signature;\n                this.relayProtocol = yield Setup(this);\n                this._checkTokenExpiration();\n                this.sessionid = sessionid;\n                this.nodeid = nodeid;\n                this.master_nodeid = master_nodeid;\n                this._emptyExecuteQueues();\n                this._pong = null;\n                this._keepAlive();\n                trigger(SwEvent.Ready, this, this.uuid);\n                logger.info('Session Ready!');\n            }\n        });\n    }\n    _onSocketCloseOrError(event) {\n        logger.error(`Socket ${event.type} ${event.message}`);\n        if (this.relayProtocol) {\n            deRegisterAll(this.relayProtocol);\n        }\n        for (const sub in this.subscriptions) {\n            deRegisterAll(sub);\n        }\n        this.subscriptions = {};\n        this.contexts = [];\n        if (this.expired) {\n            this._idle = true;\n            this._autoReconnect = false;\n            this.expiresAt = 0;\n        }\n        if (this._autoReconnect) {\n            this._reconnectTimeout = setTimeout(() => this.connect(), this.reconnectDelay);\n        }\n    }\n    _onSocketMessage(response) {\n        const { method, params } = response;\n        switch (method) {\n            case BladeMethod.Broadcast:\n                BroadcastHandler(this, params);\n                break;\n            case BladeMethod.Disconnect:\n                this._idle = true;\n                break;\n        }\n    }\n    _removeSubscription(protocol, channel) {\n        if (!this._existsSubscription(protocol, channel)) {\n            return;\n        }\n        if (channel) {\n            delete this.subscriptions[protocol][channel];\n            deRegister(protocol, null, channel);\n        }\n        else {\n            delete this.subscriptions[protocol];\n            deRegisterAll(protocol);\n        }\n    }\n    _addSubscription(protocol, handler = null, channel) {\n        if (this._existsSubscription(protocol, channel)) {\n            return;\n        }\n        if (!this._existsSubscription(protocol)) {\n            this.subscriptions[protocol] = {};\n        }\n        this.subscriptions[protocol][channel] = {};\n        if (isFunction(handler)) {\n            register(protocol, handler, channel);\n        }\n    }\n    _existsSubscription(protocol, channel) {\n        if (this.subscriptions.hasOwnProperty(protocol)) {\n            if (!channel || (channel && this.subscriptions[protocol].hasOwnProperty(channel))) {\n                return true;\n            }\n        }\n        return false;\n    }\n    _attachListeners() {\n        this._detachListeners();\n        this.on(SwEvent.SocketOpen, this._onSocketOpen);\n        this.on(SwEvent.SocketClose, this._onSocketCloseOrError);\n        this.on(SwEvent.SocketError, this._onSocketCloseOrError);\n        this.on(SwEvent.SocketMessage, this._onSocketMessage);\n    }\n    _detachListeners() {\n        this.off(SwEvent.SocketOpen, this._onSocketOpen);\n        this.off(SwEvent.SocketClose, this._onSocketCloseOrError);\n        this.off(SwEvent.SocketError, this._onSocketCloseOrError);\n        this.off(SwEvent.SocketMessage, this._onSocketMessage);\n    }\n    _emptyExecuteQueues() {\n        this._executeQueue.forEach(({ resolve, msg }) => {\n            if (typeof msg === 'string') {\n                this.executeRaw(msg);\n            }\n            else {\n                resolve(this.execute(msg));\n            }\n        });\n    }\n    _closeConnection() {\n        this._idle = true;\n        clearTimeout(this._keepAliveTimeout);\n        if (this.connection) {\n            this.connection.close();\n        }\n    }\n    _checkTokenExpiration() {\n        if (!this.expiresAt) {\n            return;\n        }\n        const diff = this.expiresAt - (Date.now() / 1000);\n        if (diff <= 60) {\n            logger.warn('Your JWT is going to expire. You should refresh it to keep the session live.');\n            trigger(SwEvent.Notification, { type: NOTIFICATION_TYPE.refreshToken, session: this }, this.uuid, false);\n        }\n        if (!this.expired) {\n            setTimeout(this._checkTokenExpiration, 30 * 1000);\n        }\n    }\n    _keepAlive() {\n        if (this._doKeepAlive !== true) {\n            return;\n        }\n        if (this._pong === false) {\n            return this._closeConnection();\n        }\n        this._pong = false;\n        this.execute(new Ping())\n            .then(() => this._pong = true)\n            .catch(() => this._pong = false);\n        this._keepAliveTimeout = setTimeout(() => this._keepAlive(), KEEPALIVE_INTERVAL);\n    }\n    static on(eventName, callback) {\n        register(eventName, callback);\n    }\n    static off(eventName) {\n        deRegister(eventName);\n    }\n    static uuid() {\n        return uuidv4();\n    }\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport logger from './util/logger';\nimport BaseSession from './BaseSession';\nimport { registerOnce, trigger } from './services/Handler';\nimport { SwEvent, SESSION_ID } from './util/constants';\nimport { State, DeviceType } from './webrtc/constants';\nimport { getDevices, scanResolutions, removeUnsupportedConstraints, checkDeviceIdConstraints, destructSubscribeResponse, getUserMedia, assureDeviceId } from './webrtc/helpers';\nimport { findElementByType } from './util/helpers';\nimport { Unsubscribe, Subscribe, Broadcast } from './messages/Verto';\nimport { localStorage } from './util/storage/';\nimport { stopStream } from './util/webrtc';\nexport default class BrowserSession extends BaseSession {\n    constructor() {\n        super(...arguments);\n        this.calls = {};\n        this.autoRecoverCalls = true;\n        this._iceServers = [];\n        this._localElement = null;\n        this._remoteElement = null;\n        this._jwtAuth = true;\n        this._devices = {};\n        this._audioConstraints = true;\n        this._videoConstraints = false;\n        this._speaker = null;\n    }\n    get reconnectDelay() {\n        return 1000;\n    }\n    connect() {\n        const _super = Object.create(null, {\n            connect: { get: () => super.connect }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            this.sessionid = yield localStorage.getItem(SESSION_ID);\n            _super.connect.call(this);\n        });\n    }\n    checkPermissions(audio = true, video = true) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const stream = yield getUserMedia({ audio, video });\n                stopStream(stream);\n                return true;\n            }\n            catch (_a) {\n                return false;\n            }\n        });\n    }\n    logout() {\n        this.disconnect();\n    }\n    disconnect() {\n        const _super = Object.create(null, {\n            disconnect: { get: () => super.disconnect }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            Object.keys(this.calls).forEach(k => this.calls[k].setState(State.Purge));\n            this.calls = {};\n            yield _super.disconnect.call(this);\n        });\n    }\n    speedTest(bytes) {\n        return new Promise((resolve, reject) => {\n            registerOnce(SwEvent.SpeedTest, speedTestResult => {\n                const { upDur, downDur } = speedTestResult;\n                const upKps = upDur ? (((bytes * 8) / (upDur / 1000)) / 1024) : 0;\n                const downKps = downDur ? (((bytes * 8) / (downDur / 1000)) / 1024) : 0;\n                resolve({ upDur, downDur, upKps: upKps.toFixed(0), downKps: downKps.toFixed(0) });\n            }, this.uuid);\n            bytes = Number(bytes);\n            if (!bytes) {\n                return reject(`Invalid parameter 'bytes': ${bytes}`);\n            }\n            this.executeRaw(`#SPU ${bytes}`);\n            let loops = bytes / 1024;\n            if (bytes % 1024) {\n                loops++;\n            }\n            const dots = '.'.repeat(1024);\n            for (let i = 0; i < loops; i++) {\n                this.executeRaw(`#SPB ${dots}`);\n            }\n            this.executeRaw('#SPE');\n        });\n    }\n    getDevices() {\n        return getDevices().catch(error => {\n            trigger(SwEvent.MediaError, error, this.uuid);\n            return [];\n        });\n    }\n    getVideoDevices() {\n        return getDevices(DeviceType.Video).catch(error => {\n            trigger(SwEvent.MediaError, error, this.uuid);\n            return [];\n        });\n    }\n    getAudioInDevices() {\n        return getDevices(DeviceType.AudioIn).catch(error => {\n            trigger(SwEvent.MediaError, error, this.uuid);\n            return [];\n        });\n    }\n    getAudioOutDevices() {\n        return getDevices(DeviceType.AudioOut).catch(error => {\n            trigger(SwEvent.MediaError, error, this.uuid);\n            return [];\n        });\n    }\n    validateDeviceId(id, label, kind) {\n        return assureDeviceId(id, label, kind);\n    }\n    refreshDevices() {\n        return __awaiter(this, void 0, void 0, function* () {\n            logger.warn('This method has been deprecated. Use getDevices() instead.');\n            const cache = {};\n            ['videoinput', 'audioinput', 'audiooutput'].map((kind) => {\n                cache[kind] = {};\n                Object.defineProperty(cache[kind], 'toArray', {\n                    value: function () {\n                        return Object.keys(this).map(k => this[k]);\n                    }\n                });\n            });\n            const devices = yield this.getDevices();\n            devices.forEach((t) => {\n                if (cache.hasOwnProperty(t.kind)) {\n                    cache[t.kind][t.deviceId] = t;\n                }\n            });\n            this._devices = cache;\n            return this.devices;\n        });\n    }\n    get devices() {\n        return this._devices || {};\n    }\n    getDeviceResolutions(deviceId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                return yield scanResolutions(deviceId);\n            }\n            catch (error) {\n                throw error;\n            }\n        });\n    }\n    get videoDevices() {\n        logger.warn('This property has been deprecated. Use getVideoDevices() instead.');\n        return this._devices.videoinput || {};\n    }\n    get audioInDevices() {\n        logger.warn('This property has been deprecated. Use getAudioInDevices() instead.');\n        return this._devices.audioinput || {};\n    }\n    get audioOutDevices() {\n        logger.warn('This property has been deprecated. Use getAudioOutDevices() instead.');\n        return this._devices.audiooutput || {};\n    }\n    get mediaConstraints() {\n        return { audio: this._audioConstraints, video: this._videoConstraints };\n    }\n    setAudioSettings(settings) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { micId, micLabel } = settings, constraints = __rest(settings, [\"micId\", \"micLabel\"]);\n            removeUnsupportedConstraints(constraints);\n            this._audioConstraints = yield checkDeviceIdConstraints(micId, micLabel, 'audioinput', constraints);\n            this.micId = micId;\n            this.micLabel = micLabel;\n            return this._audioConstraints;\n        });\n    }\n    disableMicrophone() {\n        this._audioConstraints = false;\n    }\n    enableMicrophone() {\n        this._audioConstraints = true;\n    }\n    setVideoSettings(settings) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { camId, camLabel } = settings, constraints = __rest(settings, [\"camId\", \"camLabel\"]);\n            removeUnsupportedConstraints(constraints);\n            this._videoConstraints = yield checkDeviceIdConstraints(camId, camLabel, 'videoinput', constraints);\n            this.camId = camId;\n            this.camLabel = camLabel;\n            return this._videoConstraints;\n        });\n    }\n    disableWebcam() {\n        this._videoConstraints = false;\n    }\n    enableWebcam() {\n        this._videoConstraints = true;\n    }\n    set iceServers(servers) {\n        if (typeof servers === 'boolean') {\n            this._iceServers = servers ? [{ urls: ['stun:stun.l.google.com:19302'] }] : [];\n        }\n        else {\n            this._iceServers = servers;\n        }\n    }\n    get iceServers() {\n        return this._iceServers;\n    }\n    set speaker(deviceId) {\n        this._speaker = deviceId;\n    }\n    get speaker() {\n        return this._speaker;\n    }\n    set localElement(tag) {\n        this._localElement = findElementByType(tag);\n    }\n    get localElement() {\n        return this._localElement;\n    }\n    set remoteElement(tag) {\n        this._remoteElement = findElementByType(tag);\n    }\n    get remoteElement() {\n        return this._remoteElement;\n    }\n    vertoBroadcast({ nodeId, channel: eventChannel = '', data }) {\n        if (!eventChannel) {\n            throw new Error('Invalid channel for broadcast: ' + eventChannel);\n        }\n        const msg = new Broadcast({ sessid: this.sessionid, eventChannel, data });\n        if (nodeId) {\n            msg.targetNodeId = nodeId;\n        }\n        this.execute(msg).catch(error => error);\n    }\n    vertoSubscribe({ nodeId, channels: eventChannel = [], handler }) {\n        return __awaiter(this, void 0, void 0, function* () {\n            eventChannel = eventChannel.filter(channel => channel && !this._existsSubscription(this.relayProtocol, channel));\n            if (!eventChannel.length) {\n                return {};\n            }\n            const msg = new Subscribe({ sessid: this.sessionid, eventChannel });\n            if (nodeId) {\n                msg.targetNodeId = nodeId;\n            }\n            const response = yield this.execute(msg);\n            const { unauthorized = [], subscribed = [] } = destructSubscribeResponse(response);\n            if (unauthorized.length) {\n                unauthorized.forEach(channel => this._removeSubscription(this.relayProtocol, channel));\n            }\n            subscribed.forEach(channel => this._addSubscription(this.relayProtocol, handler, channel));\n            return response;\n        });\n    }\n    vertoUnsubscribe({ nodeId, channels: eventChannel = [] }) {\n        return __awaiter(this, void 0, void 0, function* () {\n            eventChannel = eventChannel.filter(channel => channel && this._existsSubscription(this.relayProtocol, channel));\n            if (!eventChannel.length) {\n                return {};\n            }\n            const msg = new Unsubscribe({ sessid: this.sessionid, eventChannel });\n            if (nodeId) {\n                msg.targetNodeId = nodeId;\n            }\n            const response = yield this.execute(msg);\n            const { unsubscribed = [], notSubscribed = [] } = destructSubscribeResponse(response);\n            unsubscribed.forEach(channel => this._removeSubscription(this.relayProtocol, channel));\n            notSubscribed.forEach(channel => this._removeSubscription(this.relayProtocol, channel));\n            return response;\n        });\n    }\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport BrowserSession from '../../common/src/BrowserSession';\nimport { Execute } from '../../common/src/messages/Blade';\nimport BaseRequest from '../../common/src/messages/verto/BaseRequest';\nimport Call from '../../common/src/webrtc/Call';\nexport default class SignalWire extends BrowserSession {\n    execute(message) {\n        let msg = message;\n        if (message instanceof BaseRequest) {\n            const params = { message: message.request };\n            if (message.targetNodeId) {\n                params.node_id = message.targetNodeId;\n            }\n            msg = new Execute({ protocol: this.relayProtocol, method: 'message', params });\n        }\n        return super.execute(msg);\n    }\n    newCall(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { destinationNumber = null } = options;\n            if (!destinationNumber) {\n                throw new TypeError('destinationNumber is required');\n            }\n            const call = new Call(this, options);\n            call.invite();\n            return call;\n        });\n    }\n}\n","import Relay from './src/SignalWire';\nimport Verto from './src/Verto';\nimport { setAgentName } from '../common/src/messages/blade/Connect';\nimport CantinaAuth from '../common/src/webrtc/CantinaAuth';\nexport const VERSION = '1.2.8';\nsetAgentName(`JavaScript SDK/${VERSION}`);\nexport { Relay, Verto, CantinaAuth };\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar un$Join = uncurryThis([].join);\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar STRICT_METHOD = arrayMethodIsStrict('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.es/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {\n  join: function join(separator) {\n    return un$Join(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $includes = require('../internals/array-includes').includes;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.includes` method\n// https://tc39.es/ecma262/#sec-array.prototype.includes\n$({ target: 'Array', proto: true }, {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('includes');\n"],"sourceRoot":""}